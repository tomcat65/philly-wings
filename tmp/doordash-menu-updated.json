<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Philly Wings Express - DoorDash Menu</title>
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iI0ZGMzMzMyIvPgo8L3N2Zz4K" type="image/svg+xml">
    <style>
    
    /* Reset and Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #2D2D2D;
      background-color: #FAFAFA;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    img {
      max-width: 100%;
      height: auto;
      display: block;
    }

    button {
      font-family: inherit;
      cursor: pointer;
      border: none;
      outline: none;
    }
  
    
    /* Header Styles */
    .restaurant-header {
      background: linear-gradient(135deg, #FF3333, #FF6B6B);
      color: white;
      padding: 2rem 1rem;
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }

    /* Dual Background Logo System */
    .restaurant-header::before,
    .restaurant-header::after {
      content: '';
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 180px;
      height: 180px;
      background-size: contain;
      background-repeat: no-repeat;
      opacity: 0.08;
      mix-blend-mode: overlay;
      z-index: 1;
      pointer-events: none;
    }

    .restaurant-header::before {
      left: 5%;
      background-image: url('https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Fboneless-wings-package_800x800.webp?alt=media');
      background-position: left center;
    }

    .restaurant-header::after {
      right: 5%;
      background-image: url('https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Fclassic-wings-package_800x800.webp?alt=media');
      background-position: right center;
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      position: relative;
      z-index: 2;
    }

    .restaurant-name {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .restaurant-description {
      font-size: 1.1rem;
      opacity: 0.9;
      margin-bottom: 1rem;
    }

    .restaurant-meta {
      display: flex;
      justify-content: center;
      gap: 1rem;
      flex-wrap: wrap;
      font-size: 0.9rem;
    }

    .hours, .delivery-info {
      background: rgba(255,255,255,0.1);
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      backdrop-filter: blur(10px);
    }
  
    
    /* Navigation Styles */
    .menu-navigation {
      background: white;
      border-bottom: 1px solid #E0E0E0;
      position: static;
    }

    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      position: relative;
      padding: 1rem;
    }

    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      flex-direction: column;
      justify-content: center;
      width: 30px;
      height: 30px;
      cursor: pointer;
      padding: 0;
    }

    .hamburger-line {
      width: 25px;
      height: 3px;
      background-color: #666;
      margin: 3px 0;
      transition: 0.3s;
      border-radius: 2px;
    }

    .mobile-menu-toggle.active .hamburger-line:nth-child(1) {
      transform: rotate(-45deg) translate(-5px, 6px);
    }

    .mobile-menu-toggle.active .hamburger-line:nth-child(2) {
      opacity: 0;
    }

    .mobile-menu-toggle.active .hamburger-line:nth-child(3) {
      transform: rotate(45deg) translate(-5px, -6px);
    }

    .nav-items {
      display: flex;
      gap: 2rem;
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .nav-items::-webkit-scrollbar {
      display: none;
    }

    .nav-item {
      white-space: nowrap;
      color: #666;
      text-decoration: none;
      font-weight: 600;
      padding: 0.5rem 1rem;
      border-radius: 25px;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .nav-item:hover, .nav-item.active {
      color: #FF3333;
      background: #FF333310;
      border-color: #FF3333;
    }
  
    
    /* Menu Section Styles */
    .menu-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    .menu-section {
      margin-bottom: 3rem;
    }

    .section-title {
      font-size: 2rem;
      font-weight: 700;
      color: #1a1a1a;
      margin-bottom: 1.5rem;
      position: relative;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: -0.5rem;
      left: 0;
      width: 60px;
      height: 3px;
      background: #FF3333;
      border-radius: 2px;
    }

    /* Combo Cards */
    .combo-cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .combo-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .combo-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
    }

    .combo-image-wrapper {
      position: relative;
      height: 200px;
      overflow: hidden;
    }

    .combo-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .combo-card:hover .combo-image {
      transform: scale(1.05);
    }

    .combo-badge {
      position: absolute;
      top: 12px;
      left: 12px;
      background: #ff6b35;
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .savings-badge {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #00b887;
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: bold;
    }

    .combo-details {
      padding: 20px;
    }

    .combo-name {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 8px;
      color: #1a1a1a;
    }

    .combo-description {
      color: #666;
      font-size: 14px;
      margin-bottom: 16px;
      line-height: 1.4;
    }

    .combo-includes {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 16px;
    }

    .include-item {
      background: #f8f9fa;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      color: #666;
    }

    .combo-pricing {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .combo-price {
      font-size: 24px;
      font-weight: bold;
      color: #1a1a1a;
    }

    .price-label {
      font-size: 12px;
      color: #666;
    }

    .order-now-btn {
      width: 100%;
      background: #ff6b35;
      color: white;
      border: none;
      padding: 12px 16px;
      border-radius: 8px;
      font-weight: bold;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .order-now-btn:hover {
      background: #e55a2b;
    }

    /* Enhanced Wings Section */
    .wings-categories-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin: 24px 0;
    }

    @media (max-width: 768px) {
      .wings-categories-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }
    }

    .wing-category-card {
      background: white;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }

    .wing-category-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
    }

    .wing-category-image-wrapper {
      position: relative;
      width: 100%;
      height: 200px;
      overflow: hidden;
    }

    .wing-category-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .wing-category-card:hover .wing-category-image {
      transform: scale(1.05);
    }

    .wing-category-badge {
      position: absolute;
      top: 16px;
      left: 16px;
      background: #FF3333;
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .value-badge {
      position: absolute;
      top: 16px;
      right: 16px;
      background: #00b887;
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
    }

    .authenticity-badge, .tradition-badge {
      position: absolute;
      top: 16px;
      right: 16px;
      background: #ff6b35;
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
    }

    .wing-category-details {
      padding: 20px;
    }

    .wing-category-name {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 8px;
      color: #1a1a1a;
    }

    .wing-category-description {
      color: #666;
      font-size: 14px;
      margin-bottom: 16px;
      line-height: 1.4;
    }

    .wing-category-pricing {
      margin-bottom: 16px;
    }

    .price-main {
      font-size: 20px;
      font-weight: bold;
      color: #FF3333;
      margin-bottom: 4px;
    }

    .price-comparison {
      font-size: 12px;
      color: #00b887;
      font-weight: 600;
    }

    .order-wing-category-btn {
      width: 100%;
      background: #FF3333;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .order-wing-category-btn:hover {
      background: #E02929;
    }

    /* Sides Section Professional Design */
    .sides-categories-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 24px 0;
    }

    .side-category-card {
      background: white;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }

    .side-category-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
    }

    .side-category-image-wrapper {
      position: relative;
      width: 100%;
      height: 180px;
      overflow: hidden;
    }

    .side-category-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .side-category-card:hover .side-category-image {
      transform: scale(1.05);
    }

    .side-category-badge {
      position: absolute;
      top: 16px;
      right: 16px;
      background: #ff6b35;
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .side-category-details {
      padding: 20px;
    }

    .side-category-name {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 8px;
      color: #1a1a1a;
    }

    .side-category-description {
      font-size: 14px;
      color: #666;
      margin-bottom: 12px;
      line-height: 1.4;
    }

    .side-sizes-info {
      margin-bottom: 16px;
    }

    .sizes-label {
      font-size: 13px;
      color: #888;
      font-style: italic;
    }

    .side-category-pricing {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .order-side-category-btn {
      width: 100%;
      background: #ff6b35;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .order-side-category-btn:hover {
      background: #e55a2b;
    }

    /* Dips Section Professional Design */
    .dips-categories-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin: 24px 0;
    }

    .dip-category-card {
      background: white;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }

    .dip-category-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
    }

    .dip-category-image-wrapper {
      position: relative;
      width: 100%;
      height: 180px;
      overflow: hidden;
    }

    .dip-category-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .dip-category-card:hover .dip-category-image {
      transform: scale(1.05);
    }

    .dip-category-badge {
      position: absolute;
      top: 16px;
      right: 16px;
      background: #ff6b35;
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .dip-category-details {
      padding: 20px;
    }

    .dip-category-name {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 8px;
      color: #1a1a1a;
    }

    .dip-category-description {
      font-size: 14px;
      color: #666;
      margin-bottom: 16px;
      line-height: 1.4;
    }

    .dip-category-pricing {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .order-dip-category-btn {
      width: 100%;
      background: #ff6b35;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .order-dip-category-btn:hover {
      background: #e55a2b;
    }

    /* Beverages Section Professional Design */
    .beverages-cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      margin: 24px 0;
    }

    .beverage-card {
      background: white;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }

    .beverage-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
    }

    .beverage-card.featured {
      border: 2px solid #ff6b35;
    }

    .beverage-image-wrapper {
      position: relative;
      width: 100%;
      height: 280px;
      overflow: hidden;
      background: linear-gradient(135deg, #f8f9fa, #e9ecef);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .beverage-card .beverage-image {
      width: 220px !important;
      height: 220px !important;
      max-width: 220px !important;
      max-height: 220px !important;
      object-fit: contain;
      transition: transform 0.3s ease;
    }

    .beverage-card:hover .beverage-image {
      transform: scale(1.05);
    }

    .beverage-badge {
      position: absolute;
      top: 16px;
      right: 16px;
      background: #28a745;
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .beverage-details {
      padding: 20px;
    }

    .beverage-name {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 8px;
      color: #1a1a1a;
    }

    .beverage-description {
      font-size: 14px;
      color: #666;
      margin-bottom: 16px;
      line-height: 1.4;
    }

    .beverage-pricing {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .beverage-btn {
      width: 100%;
      background: #28a745;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .beverage-btn:hover {
      background: #218838;
    }

    /* Sauce Section Professional Design */
    .sauce-category-section {
      margin-bottom: 40px;
    }

    .sauce-category-title {
      font-size: 22px;
      font-weight: bold;
      color: #1a1a1a;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .sauce-category-description {
      font-size: 16px;
      color: #666;
      margin-bottom: 24px;
      line-height: 1.5;
    }

    .sauces-cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
      margin-bottom: 32px;
    }

    .sauce-card {
      background: white;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }

    .sauce-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
    }

    .sauce-image-wrapper {
      position: relative;
      width: 100%;
      height: 200px;
      overflow: hidden;
      background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    }

    .sauce-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .sauce-card:hover .sauce-image {
      transform: scale(1.05);
    }

    .sauce-badge {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #28a745;
      color: white;
      padding: 6px 10px;
      border-radius: 16px;
      font-size: 11px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .sauce-content {
      padding: 20px;
    }

    .sauce-name {
      font-size: 18px;
      font-weight: bold;
      color: #1a1a1a;
      margin-bottom: 8px;
    }

    .sauce-description {
      font-size: 14px;
      color: #666;
      line-height: 1.4;
      margin-bottom: 12px;
    }

    .sauce-heat-level {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      font-weight: bold;
    }

    .heat-indicators {
      font-size: 14px;
    }

    .heat-text {
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Other Items */
    .beverages-grid, .dips-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .beverage-item, .dip-item {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
      text-align: center;
    }

    .beverage-item:hover, .dip-item:hover {
      transform: translateY(-2px);
    }

    .beverage-image, .dip-image {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin: 0 auto 1rem;
    }

    .beverage-name, .dip-name {
      font-size: 1.2rem;
      font-weight: 700;
      color: #1a1a1a;
      margin-bottom: 0.5rem;
    }

    .dip-description {
      color: #666;
      font-size: 0.9rem;
      margin-bottom: 0.5rem;
    }

    .beverage-price {
      font-size: 1.3rem;
      font-weight: 700;
      color: #FF3333;
    }

    .dip-size {
      color: #999;
      font-size: 0.8rem;
    }
  
    
    /* Wing Modal Styles */
    .wing-modal,
    .sides-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .modal-backdrop {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      backdrop-filter: blur(4px);
    }

    .modal-content {
      background: white;
      border-radius: 16px;
      width: 100%;
      max-width: 600px;
      max-height: 90vh;
      overflow: hidden;
      position: relative;
      z-index: 1001;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
    }

    .modal-header {
      padding: 1.5rem;
      border-bottom: 1px solid #E0E0E0;
      position: relative;
    }

    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #666;
      cursor: pointer;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .modal-close:hover {
      background: #f0f0f0;
      color: #333;
    }

    .modal-progress {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1rem;
    }

    .progress-step {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #f0f0f0;
      color: #666;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      transition: all 0.3s ease;
    }

    .progress-step.active {
      background: #FF3333;
      color: white;
    }

    .progress-step.completed {
      background: #FFE66D;
      color: #333;
    }

    .modal-body {
      padding: 1.5rem;
      max-height: 60vh;
      overflow-y: auto;
      flex: 1;
    }

    .modal-step {
      display: none;
    }

    .modal-step.active {
      display: block;
    }

    .modal-footer {
      padding: 1.5rem;
      border-top: 1px solid #E0E0E0;
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
    }

    #modalBackBtn, #modalNextBtn, #modalAddToCartBtn,
    #beverageModalBackBtn, #beverageModalNextBtn, #beverageModalAddToCartBtn {
      padding: 0.75rem 1.5rem;
      border-radius: 25px;
      font-weight: 600;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
    }

    #modalBackBtn, #beverageModalBackBtn {
      background: #f0f0f0;
      color: #666;
    }

    #modalNextBtn, #modalAddToCartBtn,
    #beverageModalNextBtn, #beverageModalAddToCartBtn {
      background: #FF3333;
      color: white;
    }

    #modalBackBtn:hover, #beverageModalBackBtn:hover {
      background: #e0e0e0;
    }

    #modalNextBtn:hover, #modalAddToCartBtn:hover,
    #beverageModalNextBtn:hover, #beverageModalAddToCartBtn:hover {
      background: #E02929;
    }

    #modalNextBtn:disabled, #modalAddToCartBtn:disabled,
    #beverageModalNextBtn:disabled, #beverageModalAddToCartBtn:disabled {
      background: #ccc;
      color: #888;
      cursor: not-allowed;
      opacity: 0.6;
    }

    #modalNextBtn:disabled:hover, #modalAddToCartBtn:disabled:hover,
    #beverageModalNextBtn:disabled:hover, #beverageModalAddToCartBtn:disabled:hover {
      background: #ccc;
    }

    .wing-variants-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .wing-variant-card {
      background: #f8f9fa;
      border: 2px solid transparent;
      border-radius: 12px;
      padding: 1rem;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .wing-variant-card:hover {
      border-color: #FF3333;
      transform: translateY(-2px);
    }

    .wing-variant-card.selected {
      border-color: #FF3333;
      background: #FF333310;
    }

    /* Beverage Modal Styles */
    .beverage-size-options, .beverage-flavor-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .beverage-size-option, .beverage-flavor-option {
      background: #f8f9fa;
      border: 2px solid transparent;
      border-radius: 12px;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .beverage-size-option:hover, .beverage-flavor-option:hover {
      border-color: #FF3333;
      transform: translateY(-2px);
    }

    .beverage-size-option.selected, .beverage-flavor-option.selected {
      border-color: #FF3333;
      background: #FF333310;
    }

    .size-content, .flavor-content {
      flex: 1;
      text-align: left;
    }

    .size-name, .flavor-name {
      font-size: 16px;
      font-weight: bold;
      color: #1a1a1a;
      margin-bottom: 4px;
    }

    .size-description, .flavor-description {
      font-size: 14px;
      color: #666;
      margin-bottom: 4px;
    }

    .size-price {
      font-size: 14px;
      font-weight: bold;
      color: #FF3333;
    }

    .size-selector, .flavor-selector {
      width: 20px;
      height: 20px;
      border: 2px solid #ddd;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      color: #FF3333;
    }

    .selected .size-selector, .selected .flavor-selector {
      border-color: #FF3333;
      background: #FF3333;
      color: white;
    }

    .beverage-order-summary {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 1.5rem;
    }

    .summary-header h4 {
      margin: 0 0 1rem 0;
      color: #1a1a1a;
      font-size: 18px;
    }

    .summary-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
    }

    .summary-item.total {
      border-top: 1px solid #ddd;
      margin-top: 8px;
      padding-top: 12px;
      font-weight: bold;
      font-size: 16px;
    }

    .item-label {
      color: #666;
    }

    .item-value {
      color: #1a1a1a;
      font-weight: 500;
    }

    .summary-divider {
      height: 1px;
      background: #ddd;
      margin: 8px 0;
    }

    .variant-count {
      font-size: 1.5rem;
      font-weight: 700;
      color: #1a1a1a;
      margin-bottom: 0.5rem;
    }

    .variant-type {
      color: #666;
      margin-bottom: 0.25rem;
    }

    .variant-sauces {
      color: #FF3333;
      font-size: 0.9rem;
      margin-bottom: 0.5rem;
    }

    .variant-price {
      font-size: 1.3rem;
      font-weight: 700;
      color: #FF3333;
    }
  
    
    /* Responsive Styles */
    @media (max-width: 768px) {
      .restaurant-name {
        font-size: 2rem;
      }

      .restaurant-meta {
        flex-direction: column;
        align-items: center;
      }

      /* Adjust background logos for mobile */
      .restaurant-header::before,
      .restaurant-header::after {
        width: 120px;
        height: 120px;
        opacity: 0.05;
      }

      .restaurant-header::before {
        left: 2%;
      }

      .restaurant-header::after {
        right: 2%;
      }

      .mobile-menu-toggle {
        display: flex;
      }

      .nav-items {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        flex-direction: column;
        gap: 0;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        border-radius: 0 0 12px 12px;
        padding: 1rem 0;
        margin: 0 1rem;
      }

      .nav-items.active {
        display: flex;
      }

      .nav-item {
        padding: 1rem 1.5rem;
        border-radius: 0;
        border: none;
        border-bottom: 1px solid #f0f0f0;
      }

      .nav-item:last-child {
        border-bottom: none;
      }

      .menu-content {
        padding: 1rem;
      }

      .wings-categories {
        grid-template-columns: 1fr;
      }

      .combo-cards-grid {
        grid-template-columns: 1fr;
      }

      .sides-categories-grid, .dips-categories-grid, .beverages-cards-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }

      .beverages-grid, .sauces-cards-grid, .dips-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      }

      .modal-content {
        margin: 1rem;
        max-height: calc(100vh - 2rem);
      }

      .wing-variants-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      .restaurant-name {
        font-size: 1.5rem;
      }

      .section-title {
        font-size: 1.5rem;
      }

      .combo-cards-grid,
      .sides-categories-grid,
      .dips-categories-grid,
      .beverages-cards-grid,
      .beverages-grid,
      .sauces-cards-grid,
      .dips-grid {
        grid-template-columns: 1fr;
      }

      .modal-footer {
        flex-direction: column;
      }

      #modalBackBtn, #modalNextBtn, #modalAddToCartBtn {
        width: 100%;
      }
    }
  
  </style>
</head>
<body>
    
    <!-- Header Section -->
    <header class="restaurant-header">
        <div class="header-content">
            <div class="restaurant-info">
                <h1 class="restaurant-name">Philly Wings Express</h1>
                <p class="restaurant-description">Authentic Philadelphia Wings & More</p>
                <div class="restaurant-meta">
                    <span class="hours">10:30am - 07:15pm</span>
                    <span class="delivery-info">• Delivery Available</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation Menu -->
    <nav class="menu-navigation">
        <div class="nav-container">
            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()" aria-label="Toggle Menu">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            <div class="nav-items" id="navItems">
                <a href="#combos" class="nav-item" onclick="closeMobileMenu()">Combos</a>
                <a href="#wings" class="nav-item" onclick="closeMobileMenu()">Wings</a>
                <a href="#sides" class="nav-item" onclick="closeMobileMenu()">Sides</a>
                <a href="#dips" class="nav-item" onclick="closeMobileMenu()">Dips</a>
                <a href="#beverages" class="nav-item" onclick="closeMobileMenu()">Beverages</a>
                <a href="#sauces" class="nav-item" onclick="closeMobileMenu()">Sauces</a>
            </div>
        </div>
    </nav>

    <!-- Menu Sections -->
    <main class="menu-content">
        
    <section id="combos" class="menu-section">
      <div class="section-header">
        <h2 class="section-title">🔥 COMBO DEALS</h2>
        <p class="section-description">Save up to 17% • Complete meals ready in 20-30 mins</p>
      </div>
      <div class="combo-cards-grid">
        
      <div class="combo-card featured">
        <div class="combo-image-wrapper">
          <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fsampler-platter.png?alt=media"
               alt="Sampler Platter"
               class="combo-image"
               loading="lazy">
          <div class="combo-badge">COMBO DEAL</div>
          <div class="savings-badge">Save 15%</div>
        </div>
        <div class="combo-details">
          <h3 class="combo-name">Sampler Platter</h3>
          <p class="combo-description">6 wings (1 sauce), 4 mozzarella sticks (1 marinara), regular fries</p>
          <div class="combo-includes">
            <span class="include-item">🍗 Wings</span><span class="include-item">🍟 Fries</span><span class="include-item">🧀 Mozz Sticks</span><span class="include-item">🌶️ Sauces</span>
          </div>
          <div class="combo-pricing">
            <div class="price-main">$18.89</div>
            <div class="price-label">Order on DoorDash</div>
          </div>
          <button class="order-now-btn">ORDER NOW →</button>
        </div>
      </div>
      <div class="combo-card featured">
        <div class="combo-image-wrapper">
          <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fmvp-meal-combo.png?alt=media"
               alt="MVP Meal"
               class="combo-image"
               loading="lazy">
          <div class="combo-badge">COMBO DEAL</div>
          <div class="savings-badge">Save 15%</div>
        </div>
        <div class="combo-details">
          <h3 class="combo-name">MVP Meal</h3>
          <p class="combo-description">12 wings (2 sauces), regular fries, 4 mozzarella sticks (1 marinara), 4 dips</p>
          <div class="combo-includes">
            <span class="include-item">🍗 Wings</span><span class="include-item">🍟 Fries</span><span class="include-item">🧀 Mozz Sticks</span><span class="include-item">🌶️ Sauces</span>
          </div>
          <div class="combo-pricing">
            <div class="price-main">$25.64</div>
            <div class="price-label">Order on DoorDash</div>
          </div>
          <button class="order-now-btn">ORDER NOW →</button>
        </div>
      </div>
      <div class="combo-card featured">
        <div class="combo-image-wrapper">
          <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ftailgater-combo-boneless_800x800.webp?alt=media"
               alt="The Tailgater"
               class="combo-image"
               loading="lazy">
          <div class="combo-badge">COMBO DEAL</div>
          <div class="savings-badge">Save 15%</div>
        </div>
        <div class="combo-details">
          <h3 class="combo-name">The Tailgater</h3>
          <p class="combo-description">24 wings (4 sauces), 8 mozzarella sticks (2 marinara), 1 large fries, 8 dips</p>
          <div class="combo-includes">
            <span class="include-item">🍗 Wings</span><span class="include-item">🍟 Fries</span><span class="include-item">🧀 Mozz Sticks</span><span class="include-item">🌶️ Sauces</span>
          </div>
          <div class="combo-pricing">
            <div class="price-main">$44.54</div>
            <div class="price-label">Order on DoorDash</div>
          </div>
          <button class="order-now-btn">ORDER NOW →</button>
        </div>
      </div>
      <div class="combo-card featured">
        <div class="combo-image-wrapper">
          <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fgame-day-30-wings.png?alt=media"
               alt="Game Day 30"
               class="combo-image"
               loading="lazy">
          <div class="combo-badge">COMBO DEAL</div>
          <div class="savings-badge">Save 15%</div>
        </div>
        <div class="combo-details">
          <h3 class="combo-name">Game Day 30</h3>
          <p class="combo-description">30 wings (5 sauces), 2 large fries, 8 mozzarella sticks (2 marinara), 10 dips</p>
          <div class="combo-includes">
            <span class="include-item">🍗 Wings</span><span class="include-item">🍟 Fries</span><span class="include-item">🧀 Mozz Sticks</span><span class="include-item">🌶️ Sauces</span>
          </div>
          <div class="combo-pricing">
            <div class="price-main">$58.04</div>
            <div class="price-label">Order on DoorDash</div>
          </div>
          <button class="order-now-btn">ORDER NOW →</button>
        </div>
      </div>
      <div class="combo-card featured">
        <div class="combo-image-wrapper">
          <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fparty-pack-50-wings.png?alt=media"
               alt="Party Pack 50"
               class="combo-image"
               loading="lazy">
          <div class="combo-badge">COMBO DEAL</div>
          <div class="savings-badge">Save 15%</div>
        </div>
        <div class="combo-details">
          <h3 class="combo-name">Party Pack 50</h3>
          <p class="combo-description">50 wings (8 sauces), 3 large fries, 16 mozzarella sticks (4 marinara), 18 dips</p>
          <div class="combo-includes">
            <span class="include-item">🍗 Wings</span><span class="include-item">🍟 Fries</span><span class="include-item">🧀 Mozz Sticks</span><span class="include-item">🌶️ Sauces</span>
          </div>
          <div class="combo-pricing">
            <div class="price-main">$94.49</div>
            <div class="price-label">Order on DoorDash</div>
          </div>
          <button class="order-now-btn">ORDER NOW →</button>
        </div>
      </div>
      </div>
    </section>
  
        
    <section id="wings" class="menu-section">
        <div class="section-header">
            <h2 class="section-title">🔥 WINGS</h2>
            <p class="section-description">Every wing brined overnight, hand-tossed in signature sauces</p>
        </div>

        <div class="wings-categories-grid">
            
    <div class="wing-category-card enhanced" data-wing-type="boneless">
        <div class="wing-category-image-wrapper">
            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fmenu%2Fphilly-classic-hot.jpg?alt=media"
                 alt="Boneless Wings"
                 class="wing-category-image"
                 loading="lazy">
            <div class="wing-category-badge">ALL WHITE MEAT</div>
            <div class="value-badge">💰 22% CHEAPER</div>
        </div>
        <div class="wing-category-details">
            <h3 class="wing-category-name">Boneless Wings</h3>
            <p class="wing-category-description">All White Chicken, Juicy and Lightly Breaded</p>
            <div class="wing-category-pricing">
                <div class="price-main">Starting at $9.44</div>
                <div class="price-comparison">22% cheaper than bone-in</div>
            </div>
            <button class="order-wing-category-btn interactive" onclick="openBonelessWingModal()">
                VIEW OPTIONS →
            </button>
        </div>
    </div>
  
            
    <div class="wing-category-card enhanced" data-wing-type="bone-in">
        <div class="wing-category-image-wrapper">
            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Fbroad-pattison-burn_800x800.webp?alt=media"
                 alt="Classic Bone-In Wings"
                 class="wing-category-image"
                 loading="lazy">
            <div class="wing-category-badge">AUTHENTIC</div>
            <div class="tradition-badge">🔥 ORIGINAL</div>
        </div>
        <div class="wing-category-details">
            <h3 class="wing-category-name">Classic (Bone-In)</h3>
            <p class="wing-category-description">The Real Buffalo Wings, Real Food (not from Buffalo!)</p>
            <div class="wing-category-pricing">
                <div class="price-main">Starting at $12.14</div>
            </div>
            <button class="order-wing-category-btn interactive" onclick="openBoneInWingModal()">
                VIEW OPTIONS →
            </button>
        </div>
    </div>
  
        </div>
    </section>
  
        
    <section id="sides" class="menu-section">
        <div class="section-header">
            <h2 class="section-title">🍟 Sides</h2>
            <p class="section-description">Perfect complements to your wings • Fresh cut fries and mozzarella sticks</p>
        </div>

        <div class="sides-categories-grid">
            <div class="side-category-card">
                <div class="side-category-image-wrapper">
                    <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ffries_800x800.webp?alt=media"
                         alt="Fries"
                         class="side-category-image"
                         loading="lazy">
                    <div class="side-category-badge">FRESH CUT</div>
                </div>
                <div class="side-category-details">
                    <h3 class="side-category-name">Fries</h3>
                    <p class="side-category-description">Fresh cut fries • Available in Regular and Large sizes</p>
                    <div class="side-sizes-info">
                        <span class="sizes-label">Sizes: Regular & Large</span>
                    </div>
                    <div class="side-category-pricing">
                        <div class="price-main">Starting at $3.71</div>
                        <div class="price-label">Choose Size</div>
                    </div>
                    <button class="order-side-category-btn" onclick="openFriesModal()">VIEW OPTIONS →</button>
                </div>
            </div>
            <div class="side-category-card">
                <div class="side-category-image-wrapper">
                    <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Floaded-fries_800x800.webp?alt=media"
                         alt="Loaded Fries"
                         class="side-category-image"
                         loading="lazy">
                    <div class="side-category-badge">🔥 LOADED</div>
                </div>
                <div class="side-category-details">
                    <h3 class="side-category-name">Loaded Fries</h3>
                    <p class="side-category-description">Large fries topped with cheese sauce and bacon • Only available in Large size</p>
                    <div class="side-sizes-info">
                        <span class="sizes-label">Size: Large Only</span>
                    </div>
                    <div class="side-category-pricing">
                        <div class="price-main">Starting at $8.99</div>
                        <div class="price-label">Large Size</div>
                    </div>
                    <button class="order-side-category-btn" onclick="openLoadedFriesModal()">VIEW OPTIONS →</button>
                </div>
            </div>
            <div class="side-category-card">
                <div class="side-category-image-wrapper">
                    <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Fmozzarella-sticks_800x800.webp?alt=media"
                         alt="Mozzarella Sticks"
                         class="side-category-image"
                         loading="lazy">
                    <div class="side-category-badge">GOLDEN FRIED</div>
                </div>
                <div class="side-category-details">
                    <h3 class="side-category-name">Mozzarella Sticks</h3>
                    <p class="side-category-description">Golden fried mozzarella sticks with marinara sauce • Choose your quantity</p>
                    <div class="side-sizes-info">
                        <span class="sizes-label">4, 8, 12, or 16 pieces</span>
                    </div>
                    <div class="side-category-pricing">
                        <div class="price-main">Starting at $9.44</div>
                        <div class="price-label">Choose Quantity</div>
                    </div>
                    <button class="order-side-category-btn" onclick="openMozzarellaModal()">VIEW OPTIONS →</button>
                </div>
            </div>
        </div>
    </section>
  
        
    <section id="dips" class="menu-section">
        <div class="section-header">
            <h2 class="section-title">🥄 Dips</h2>
            <p class="section-description">Extra flavor for your wings and sides • 1.5 oz cups</p>
        </div>
        <div class="dips-categories-grid">
            
                <div class="dip-category-card">
                    <div class="dip-category-image-wrapper">
                        <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Franch-dip.png?alt=media"
                             alt="Ranch"
                             class="dip-category-image"
                             loading="lazy">
                        <div class="dip-category-badge">CLASSIC</div>
                    </div>
                    <div class="dip-category-details">
                        <h3 class="dip-category-name">Ranch</h3>
                        <p class="dip-category-description">Cool & creamy ranch dip • Perfect with wings and vegetables</p>
                        <div class="dip-category-pricing">
                            <div class="price-main">$0.75</div>
                            <div class="price-label">Add to Order</div>
                        </div>
                        <button class="order-dip-category-btn">ADD DIP</button>
                    </div>
                </div>
            
                <div class="dip-category-card">
                    <div class="dip-category-image-wrapper">
                        <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fhoney-mustard.png?alt=media"
                             alt="Honey Mustard"
                             class="dip-category-image"
                             loading="lazy">
                        <div class="dip-category-badge">SWEET & TANGY</div>
                    </div>
                    <div class="dip-category-details">
                        <h3 class="dip-category-name">Honey Mustard</h3>
                        <p class="dip-category-description">Sweet & tangy honey mustard • Great for dipping wings and sides</p>
                        <div class="dip-category-pricing">
                            <div class="price-main">$0.75</div>
                            <div class="price-label">Add to Order</div>
                        </div>
                        <button class="order-dip-category-btn">ADD DIP</button>
                    </div>
                </div>
            
                <div class="dip-category-card">
                    <div class="dip-category-image-wrapper">
                        <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fblue-cheese.png?alt=media"
                             alt="Blue Cheese"
                             class="dip-category-image"
                             loading="lazy">
                        <div class="dip-category-badge">CHUNKY</div>
                    </div>
                    <div class="dip-category-details">
                        <h3 class="dip-category-name">Blue Cheese</h3>
                        <p class="dip-category-description">Classic chunky blue cheese • Traditional wing dip</p>
                        <div class="dip-category-pricing">
                            <div class="price-main">$0.75</div>
                            <div class="price-label">Add to Order</div>
                        </div>
                        <button class="order-dip-category-btn">ADD DIP</button>
                    </div>
                </div>
            
                <div class="dip-category-card">
                    <div class="dip-category-image-wrapper">
                        <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fcheese-sauce.png?alt=media"
                             alt="Cheese Sauce"
                             class="dip-category-image"
                             loading="lazy">
                        <div class="dip-category-badge">WARM & MELTY</div>
                    </div>
                    <div class="dip-category-details">
                        <h3 class="dip-category-name">Cheese Sauce</h3>
                        <p class="dip-category-description">Warm & melty cheese sauce • Perfect for loaded fries and sides</p>
                        <div class="dip-category-pricing">
                            <div class="price-main">$0.75</div>
                            <div class="price-label">Add to Order</div>
                        </div>
                        <button class="order-dip-category-btn">ADD DIP</button>
                    </div>
                </div>
            
        </div>
    </section>
  
        
    <section id="beverages" class="menu-section">
        <div class="section-header">
            <h2 class="section-title">🥤 Drinks</h2>
            <p class="section-description">Beverages</p>
        </div>

        <div class="beverages-cards-grid">
            
                <div class="beverage-card featured" onclick="openBeverageModal(window.beverageGroups[0])">
                    <div class="beverage-image-wrapper">
                        <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ffountain-drinks_200x200.webp?alt=media"
                             alt="Fountain Drinks"
                             class="beverage-image"
                             loading="lazy">
                        <div class="beverage-badge">CHOOSE SIZE</div>
                    </div>
                    <div class="beverage-details">
                        <h3 class="beverage-name">Fountain Drinks</h3>
                        <p class="beverage-description">8 Flavors: Coca-Cola, Diet Coke, Coke Zero, Sprite, Fanta Orange, Dr Pepper, Barq's Root Beer, Hi-C Fruit Punch</p>
                        <div class="beverage-pricing">
                            <div class="price-main">$3.36</div>
                            <div class="price-label">Starting at</div>
                        </div>
                        <button class="beverage-btn">
                            VIEW OPTIONS →
                        </button>
                    </div>
                </div>
              
                <div class="beverage-card" onclick="openBeverageModal(window.beverageGroups[1])">
                    <div class="beverage-image-wrapper">
                        <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ficed-tea_200x200.webp?alt=media"
                             alt="Fresh Brewed Tea"
                             class="beverage-image"
                             loading="lazy">
                        <div class="beverage-badge">FRESH DAILY</div>
                    </div>
                    <div class="beverage-details">
                        <h3 class="beverage-name">Fresh Brewed Tea</h3>
                        <p class="beverage-description">Freshly brewed daily • Sweet or unsweetened • Perfect refreshment</p>
                        <div class="beverage-pricing">
                            <div class="price-main">$3.36</div>
                            <div class="price-label">Starting at</div>
                        </div>
                        <button class="beverage-btn">
                            VIEW OPTIONS →
                        </button>
                    </div>
                </div>
              
                <div class="beverage-card" onclick="openBeverageModal(window.beverageGroups[2])">
                    <div class="beverage-image-wrapper">
                        <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Fwater-bottle_200x200.webp?alt=media"
                             alt="Bottled Water"
                             class="beverage-image"
                             loading="lazy">
                        <div class="beverage-badge">PURE</div>
                    </div>
                    <div class="beverage-details">
                        <h3 class="beverage-name">Bottled Water</h3>
                        <p class="beverage-description">Pure refreshment • 16.9 fl oz bottle</p>
                        <div class="beverage-pricing">
                            <div class="price-main">$3.09</div>
                            <div class="price-label">Add to order</div>
                        </div>
                        <button class="beverage-btn">
                            ADD TO ORDER
                        </button>
                    </div>
                </div>
              
        </div>
    </section>
  
        
    <section id="sauces" class="menu-section">
        <div class="section-header">
            <h2 class="section-title">🌶️ Signature Wing Sauces</h2>
            <p class="section-description">From mild to blazing - all house-made with premium ingredients</p>
        </div>

        
        <div class="sauce-category-section">
            <h3 class="sauce-category-title">🥄 Dry Rubs</h3>
            <p class="sauce-category-description">Crispy wings tossed in our signature spice blends</p>
            <div class="sauces-cards-grid">
                
                    <div class="sauce-card" onclick="openSauceModal('classic-lemon-pepper', {&quot;id&quot;:&quot;classic-lemon-pepper&quot;,&quot;name&quot;:&quot;Classic Lemon Pepper&quot;,&quot;category&quot;:&quot;dry-rub&quot;,&quot;description&quot;:&quot;Classic lemon pepper - zesty citrus, cracked black pepper&quot;,&quot;imageUrl&quot;:&quot;https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Flemon-pepper-dry-rub.png?alt=media&quot;,&quot;altText&quot;:&quot;Classic lemon pepper dry rub on crispy wings&quot;,&quot;heatLevel&quot;:1,&quot;badges&quot;:[],&quot;active&quot;:true,&quot;featured&quot;:false,&quot;sortOrder&quot;:1,&quot;allergens&quot;:[],&quot;isDryRub&quot;:true,&quot;containsDairy&quot;:false,&quot;containsGluten&quot;:false,&quot;vegetarian&quot;:true,&quot;platformNames&quot;:{&quot;doordash&quot;:&quot;Classic Lemon Pepper&quot;,&quot;ubereats&quot;:&quot;Classic Lemon Pepper&quot;,&quot;grubhub&quot;:&quot;Classic Lemon Pepper&quot;},&quot;platformAvailability&quot;:[&quot;doordash&quot;,&quot;ubereats&quot;,&quot;grubhub&quot;],&quot;schemaVersion&quot;:1,&quot;contentVersion&quot;:1,&quot;updatedAt&quot;:1737072000000})">
                        <div class="sauce-image-wrapper">
                            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Flemon-pepper-dry-rub.png?alt=media"
                                 alt="Classic Lemon Pepper"
                                 class="sauce-image"
                                 loading="lazy">
                            <div class="sauce-badge">DRY RUB</div>
                        </div>
                        <div class="sauce-content">
                            <h3 class="sauce-name">Classic Lemon Pepper</h3>
                            <p class="sauce-description">Classic lemon pepper - zesty citrus, cracked black pepper</p>
                            
      <div class="sauce-heat-level" style="color: #00b887;">
        <span class="heat-indicators">🌶️</span>
        <span class="heat-text">MILD</span>
      </div>
    
                        </div>
                    </div>
                
                    <div class="sauce-card" onclick="openSauceModal('northeast-hot-lemon', {&quot;id&quot;:&quot;northeast-hot-lemon&quot;,&quot;name&quot;:&quot;Northeast Hot Lemon&quot;,&quot;category&quot;:&quot;dry-rub&quot;,&quot;description&quot;:&quot;Spicy lemon pepper with cayenne kick&quot;,&quot;imageUrl&quot;:&quot;https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fnortheast-hot-lemon.png?alt=media&quot;,&quot;altText&quot;:&quot;Northeast hot lemon pepper dry rub with cayenne&quot;,&quot;heatLevel&quot;:2,&quot;badges&quot;:[],&quot;active&quot;:true,&quot;featured&quot;:false,&quot;sortOrder&quot;:2,&quot;allergens&quot;:[],&quot;isDryRub&quot;:true,&quot;containsDairy&quot;:false,&quot;containsGluten&quot;:false,&quot;vegetarian&quot;:true,&quot;platformNames&quot;:{&quot;doordash&quot;:&quot;Northeast Hot Lemon&quot;,&quot;ubereats&quot;:&quot;Hot Lemon Pepper&quot;,&quot;grubhub&quot;:&quot;Spicy Lemon Pepper&quot;},&quot;platformAvailability&quot;:[&quot;doordash&quot;,&quot;ubereats&quot;,&quot;grubhub&quot;],&quot;schemaVersion&quot;:1,&quot;contentVersion&quot;:1,&quot;updatedAt&quot;:1737072000000})">
                        <div class="sauce-image-wrapper">
                            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fnortheast-hot-lemon.png?alt=media"
                                 alt="Northeast Hot Lemon"
                                 class="sauce-image"
                                 loading="lazy">
                            <div class="sauce-badge">DRY RUB</div>
                        </div>
                        <div class="sauce-content">
                            <h3 class="sauce-name">Northeast Hot Lemon</h3>
                            <p class="sauce-description">Spicy lemon pepper with cayenne kick</p>
                            
      <div class="sauce-heat-level" style="color: #ff9500;">
        <span class="heat-indicators">🌶️🌶️</span>
        <span class="heat-text">MEDIUM</span>
      </div>
    
                        </div>
                    </div>
                
                    <div class="sauce-card" onclick="openSauceModal('frankford-cajun', {&quot;id&quot;:&quot;frankford-cajun&quot;,&quot;name&quot;:&quot;Frankford Cajun&quot;,&quot;category&quot;:&quot;dry-rub&quot;,&quot;description&quot;:&quot;Bold Cajun blend - paprika, garlic, herbs&quot;,&quot;imageUrl&quot;:&quot;https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fcajun-dry-rub.png?alt=media&quot;,&quot;altText&quot;:&quot;Frankford Cajun spice blend dry rub&quot;,&quot;heatLevel&quot;:2,&quot;badges&quot;:[],&quot;active&quot;:true,&quot;featured&quot;:false,&quot;sortOrder&quot;:3,&quot;allergens&quot;:[],&quot;isDryRub&quot;:true,&quot;containsDairy&quot;:false,&quot;containsGluten&quot;:false,&quot;vegetarian&quot;:true,&quot;platformNames&quot;:{&quot;doordash&quot;:&quot;Frankford Cajun&quot;,&quot;ubereats&quot;:&quot;Cajun Spice&quot;,&quot;grubhub&quot;:&quot;Cajun Dry Rub&quot;},&quot;platformAvailability&quot;:[&quot;doordash&quot;,&quot;ubereats&quot;,&quot;grubhub&quot;],&quot;schemaVersion&quot;:1,&quot;contentVersion&quot;:1,&quot;updatedAt&quot;:1737072000000})">
                        <div class="sauce-image-wrapper">
                            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fcajun-dry-rub.png?alt=media"
                                 alt="Frankford Cajun"
                                 class="sauce-image"
                                 loading="lazy">
                            <div class="sauce-badge">DRY RUB</div>
                        </div>
                        <div class="sauce-content">
                            <h3 class="sauce-name">Frankford Cajun</h3>
                            <p class="sauce-description">Bold Cajun blend - paprika, garlic, herbs</p>
                            
      <div class="sauce-heat-level" style="color: #ff9500;">
        <span class="heat-indicators">🌶️🌶️</span>
        <span class="heat-text">MEDIUM</span>
      </div>
    
                        </div>
                    </div>
                
                    <div class="sauce-card" onclick="openSauceModal('garlic-parmesan', {&quot;id&quot;:&quot;garlic-parmesan&quot;,&quot;name&quot;:&quot;Garlic Parmesan&quot;,&quot;category&quot;:&quot;dry-rub&quot;,&quot;description&quot;:&quot;Creamy garlic butter with aged parmesan&quot;,&quot;altText&quot;:&quot;Garlic parmesan dry rub with butter and cheese&quot;,&quot;heatLevel&quot;:0,&quot;badges&quot;:[],&quot;active&quot;:true,&quot;featured&quot;:false,&quot;sortOrder&quot;:4,&quot;allergens&quot;:[&quot;dairy&quot;],&quot;isDryRub&quot;:true,&quot;containsDairy&quot;:true,&quot;containsGluten&quot;:false,&quot;vegetarian&quot;:true,&quot;platformNames&quot;:{&quot;doordash&quot;:&quot;Garlic Parmesan&quot;,&quot;ubereats&quot;:&quot;Garlic Parm&quot;,&quot;grubhub&quot;:&quot;Garlic Parmesan&quot;},&quot;platformAvailability&quot;:[&quot;doordash&quot;,&quot;ubereats&quot;,&quot;grubhub&quot;],&quot;schemaVersion&quot;:1,&quot;contentVersion&quot;:1,&quot;updatedAt&quot;:1737072000000,&quot;imageUrl&quot;:&quot;https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fgarlic-parmesan-dry-rub.png?alt=media&quot;})">
                        <div class="sauce-image-wrapper">
                            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fgarlic-parmesan-dry-rub.png?alt=media"
                                 alt="Garlic Parmesan"
                                 class="sauce-image"
                                 loading="lazy">
                            <div class="sauce-badge">DRY RUB</div>
                        </div>
                        <div class="sauce-content">
                            <h3 class="sauce-name">Garlic Parmesan</h3>
                            <p class="sauce-description">Creamy garlic butter with aged parmesan</p>
                            
      <div class="sauce-heat-level" style="color: #00b887;">
        <span class="heat-indicators">🌶️</span>
        <span class="heat-text">MILD</span>
      </div>
    
                        </div>
                    </div>
                
            </div>
        </div>
        

        
        <div class="sauce-category-section">
            <h3 class="sauce-category-title">🍯 Wing Sauces</h3>
            <p class="sauce-category-description">Rich, flavorful sauces that coat every wing perfectly</p>
            <div class="sauces-cards-grid">
                
                    <div class="sauce-card" onclick="openSauceModal('sweet-teriyaki', {&quot;id&quot;:&quot;sweet-teriyaki&quot;,&quot;name&quot;:&quot;Sweet Teriyaki&quot;,&quot;category&quot;:&quot;signature-sauce&quot;,&quot;description&quot;:&quot;Teriyaki glaze - soy, ginger, sesame&quot;,&quot;altText&quot;:&quot;Sweet teriyaki glazed wings&quot;,&quot;heatLevel&quot;:0,&quot;badges&quot;:[],&quot;active&quot;:true,&quot;featured&quot;:false,&quot;sortOrder&quot;:5,&quot;allergens&quot;:[&quot;soy&quot;,&quot;sesame&quot;],&quot;isDryRub&quot;:false,&quot;containsDairy&quot;:false,&quot;containsGluten&quot;:false,&quot;vegetarian&quot;:true,&quot;platformNames&quot;:{&quot;doordash&quot;:&quot;Sweet Teriyaki&quot;,&quot;ubereats&quot;:&quot;Teriyaki&quot;,&quot;grubhub&quot;:&quot;Sweet Teriyaki Glaze&quot;},&quot;platformAvailability&quot;:[&quot;doordash&quot;,&quot;ubereats&quot;,&quot;grubhub&quot;],&quot;schemaVersion&quot;:1,&quot;contentVersion&quot;:1,&quot;updatedAt&quot;:1737072000000,&quot;imageUrl&quot;:&quot;https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fteriyaki-sauced.png?alt=media&quot;})">
                        <div class="sauce-image-wrapper">
                            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fteriyaki-sauced.png?alt=media"
                                 alt="Sweet Teriyaki"
                                 class="sauce-image"
                                 loading="lazy">
                            
                        </div>
                        <div class="sauce-content">
                            <h3 class="sauce-name">Sweet Teriyaki</h3>
                            <p class="sauce-description">Teriyaki glaze - soy, ginger, sesame</p>
                            
      <div class="sauce-heat-level" style="color: #00b887;">
        <span class="heat-indicators">🌶️</span>
        <span class="heat-text">MILD</span>
      </div>
    
                        </div>
                    </div>
                
                    <div class="sauce-card" onclick="openSauceModal('tailgate-bbq', {&quot;id&quot;:&quot;tailgate-bbq&quot;,&quot;name&quot;:&quot;Tailgate BBQ&quot;,&quot;category&quot;:&quot;signature-sauce&quot;,&quot;description&quot;:&quot;Classic BBQ - sweet, tangy, smoky&quot;,&quot;altText&quot;:&quot;Tailgate BBQ sauce wings&quot;,&quot;heatLevel&quot;:0,&quot;badges&quot;:[],&quot;active&quot;:true,&quot;featured&quot;:false,&quot;sortOrder&quot;:6,&quot;allergens&quot;:[],&quot;isDryRub&quot;:false,&quot;containsDairy&quot;:false,&quot;containsGluten&quot;:false,&quot;vegetarian&quot;:true,&quot;platformNames&quot;:{&quot;doordash&quot;:&quot;Tailgate BBQ&quot;,&quot;ubereats&quot;:&quot;BBQ&quot;,&quot;grubhub&quot;:&quot;Classic BBQ&quot;},&quot;platformAvailability&quot;:[&quot;doordash&quot;,&quot;ubereats&quot;,&quot;grubhub&quot;],&quot;schemaVersion&quot;:1,&quot;contentVersion&quot;:1,&quot;updatedAt&quot;:1737072000000,&quot;imageUrl&quot;:&quot;https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fbbq-sauced.png?alt=media&quot;})">
                        <div class="sauce-image-wrapper">
                            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fbbq-sauced.png?alt=media"
                                 alt="Tailgate BBQ"
                                 class="sauce-image"
                                 loading="lazy">
                            
                        </div>
                        <div class="sauce-content">
                            <h3 class="sauce-name">Tailgate BBQ</h3>
                            <p class="sauce-description">Classic BBQ - sweet, tangy, smoky</p>
                            
      <div class="sauce-heat-level" style="color: #00b887;">
        <span class="heat-indicators">🌶️</span>
        <span class="heat-text">MILD</span>
      </div>
    
                        </div>
                    </div>
                
                    <div class="sauce-card" onclick="openSauceModal('mild-buffalo', {&quot;id&quot;:&quot;mild-buffalo&quot;,&quot;name&quot;:&quot;Mild Buffalo&quot;,&quot;category&quot;:&quot;signature-sauce&quot;,&quot;description&quot;:&quot;Mild buffalo - all flavor, easy heat&quot;,&quot;altText&quot;:&quot;Mild buffalo sauce wings&quot;,&quot;heatLevel&quot;:1,&quot;badges&quot;:[],&quot;active&quot;:true,&quot;featured&quot;:false,&quot;sortOrder&quot;:7,&quot;allergens&quot;:[&quot;dairy&quot;],&quot;isDryRub&quot;:false,&quot;containsDairy&quot;:true,&quot;containsGluten&quot;:false,&quot;vegetarian&quot;:true,&quot;platformNames&quot;:{&quot;doordash&quot;:&quot;Mild Buffalo&quot;,&quot;ubereats&quot;:&quot;Buffalo Mild&quot;,&quot;grubhub&quot;:&quot;Mild Buffalo&quot;},&quot;platformAvailability&quot;:[&quot;doordash&quot;,&quot;ubereats&quot;,&quot;grubhub&quot;],&quot;schemaVersion&quot;:1,&quot;contentVersion&quot;:1,&quot;updatedAt&quot;:1737072000000,&quot;imageUrl&quot;:&quot;https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fbuffalo-sauced.png?alt=media&quot;})">
                        <div class="sauce-image-wrapper">
                            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fbuffalo-sauced.png?alt=media"
                                 alt="Mild Buffalo"
                                 class="sauce-image"
                                 loading="lazy">
                            
                        </div>
                        <div class="sauce-content">
                            <h3 class="sauce-name">Mild Buffalo</h3>
                            <p class="sauce-description">Mild buffalo - all flavor, easy heat</p>
                            
      <div class="sauce-heat-level" style="color: #00b887;">
        <span class="heat-indicators">🌶️</span>
        <span class="heat-text">MILD</span>
      </div>
    
                        </div>
                    </div>
                
                    <div class="sauce-card" onclick="openSauceModal('philly-classic-hot', {&quot;id&quot;:&quot;philly-classic-hot&quot;,&quot;name&quot;:&quot;Philly Classic Hot&quot;,&quot;category&quot;:&quot;signature-sauce&quot;,&quot;description&quot;:&quot;Traditional hot buffalo - the perfect heat&quot;,&quot;imageUrl&quot;:&quot;https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fmenu%2Fphilly-classic-hot.jpg?alt=media&quot;,&quot;altText&quot;:&quot;Philly classic hot buffalo sauce wings&quot;,&quot;heatLevel&quot;:3,&quot;badges&quot;:[],&quot;active&quot;:true,&quot;featured&quot;:false,&quot;sortOrder&quot;:8,&quot;allergens&quot;:[&quot;dairy&quot;],&quot;isDryRub&quot;:false,&quot;containsDairy&quot;:true,&quot;containsGluten&quot;:false,&quot;vegetarian&quot;:true,&quot;platformNames&quot;:{&quot;doordash&quot;:&quot;Philly Classic Hot&quot;,&quot;ubereats&quot;:&quot;Classic Hot Buffalo&quot;,&quot;grubhub&quot;:&quot;Hot Buffalo&quot;},&quot;platformAvailability&quot;:[&quot;doordash&quot;,&quot;ubereats&quot;,&quot;grubhub&quot;],&quot;schemaVersion&quot;:1,&quot;contentVersion&quot;:1,&quot;updatedAt&quot;:1737072000000})">
                        <div class="sauce-image-wrapper">
                            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fmenu%2Fphilly-classic-hot.jpg?alt=media"
                                 alt="Philly Classic Hot"
                                 class="sauce-image"
                                 loading="lazy">
                            
                        </div>
                        <div class="sauce-content">
                            <h3 class="sauce-name">Philly Classic Hot</h3>
                            <p class="sauce-description">Traditional hot buffalo - the perfect heat</p>
                            
      <div class="sauce-heat-level" style="color: #ff6600;">
        <span class="heat-indicators">🌶️🌶️🌶️</span>
        <span class="heat-text">HOT</span>
      </div>
    
                        </div>
                    </div>
                
                    <div class="sauce-card" onclick="openSauceModal('broad-pattison-burn', {&quot;id&quot;:&quot;broad-pattison-burn&quot;,&quot;name&quot;:&quot;Broad & Pattison Burn&quot;,&quot;category&quot;:&quot;signature-sauce&quot;,&quot;description&quot;:&quot;Nashville-style hot - cayenne, brown sugar&quot;,&quot;altText&quot;:&quot;Broad & Pattison Burn Nashville hot wings&quot;,&quot;heatLevel&quot;:4,&quot;badges&quot;:[],&quot;active&quot;:true,&quot;featured&quot;:false,&quot;sortOrder&quot;:9,&quot;allergens&quot;:[],&quot;isDryRub&quot;:false,&quot;containsDairy&quot;:false,&quot;containsGluten&quot;:false,&quot;vegetarian&quot;:true,&quot;platformNames&quot;:{&quot;doordash&quot;:&quot;Broad & Pattison Burn&quot;,&quot;ubereats&quot;:&quot;Nashville Hot&quot;,&quot;grubhub&quot;:&quot;Extra Hot Nashville&quot;},&quot;platformAvailability&quot;:[&quot;doordash&quot;,&quot;ubereats&quot;,&quot;grubhub&quot;],&quot;schemaVersion&quot;:1,&quot;contentVersion&quot;:1,&quot;updatedAt&quot;:1737072000000,&quot;imageUrl&quot;:&quot;https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Fbroad-pattison-burn_800x800.webp?alt=media&quot;})">
                        <div class="sauce-image-wrapper">
                            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Fbroad-pattison-burn_800x800.webp?alt=media"
                                 alt="Broad & Pattison Burn"
                                 class="sauce-image"
                                 loading="lazy">
                            
                        </div>
                        <div class="sauce-content">
                            <h3 class="sauce-name">Broad & Pattison Burn</h3>
                            <p class="sauce-description">Nashville-style hot - cayenne, brown sugar</p>
                            
      <div class="sauce-heat-level" style="color: #ff3333;">
        <span class="heat-indicators">🌶️🌶️🌶️🌶️</span>
        <span class="heat-text">EXTRA HOT</span>
      </div>
    
                        </div>
                    </div>
                
                    <div class="sauce-card" onclick="openSauceModal('grittys-revenge', {&quot;id&quot;:&quot;grittys-revenge&quot;,&quot;name&quot;:&quot;Gritty's Revenge&quot;,&quot;category&quot;:&quot;signature-sauce&quot;,&quot;description&quot;:&quot;Scorpion pepper sauce - NOT for rookies!&quot;,&quot;imageUrl&quot;:&quot;https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fgrittys-revenge.png?alt=media&quot;,&quot;altText&quot;:&quot;Gritty's Revenge scorpion pepper extreme heat wings&quot;,&quot;heatLevel&quot;:5,&quot;badges&quot;:[&quot;NOT for rookies!&quot;],&quot;active&quot;:true,&quot;featured&quot;:true,&quot;sortOrder&quot;:10,&quot;allergens&quot;:[],&quot;isDryRub&quot;:false,&quot;containsDairy&quot;:false,&quot;containsGluten&quot;:false,&quot;vegetarian&quot;:true,&quot;platformNames&quot;:{&quot;doordash&quot;:&quot;Gritty's Revenge&quot;,&quot;ubereats&quot;:&quot;Scorpion Sauce&quot;,&quot;grubhub&quot;:&quot;Extreme Heat&quot;},&quot;platformAvailability&quot;:[&quot;doordash&quot;,&quot;ubereats&quot;,&quot;grubhub&quot;],&quot;schemaVersion&quot;:1,&quot;contentVersion&quot;:1,&quot;updatedAt&quot;:1737072000000})">
                        <div class="sauce-image-wrapper">
                            <img src="https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fgrittys-revenge.png?alt=media"
                                 alt="Gritty's Revenge"
                                 class="sauce-image"
                                 loading="lazy">
                            
                        </div>
                        <div class="sauce-content">
                            <h3 class="sauce-name">Gritty's Revenge</h3>
                            <p class="sauce-description">Scorpion pepper sauce - NOT for rookies!</p>
                            
      <div class="sauce-heat-level" style="color: #ff3333;">
        <span class="heat-indicators">🌶️🌶️🌶️🌶️🌶️</span>
        <span class="heat-text">BLAZING</span>
      </div>
    
                        </div>
                    </div>
                
            </div>
        </div>
        
    </section>
  
    </main>

    <!-- Wing Modal -->
    <div id="wingModal" class="wing-modal" style="display: none;">
        <div class="modal-backdrop" onclick="closeWingModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-close" onclick="closeWingModal()">&times;</button>
                <div class="modal-progress">
                    <div class="progress-step active" data-step="1">1</div>
                    <div class="progress-step" data-step="2">2</div>
                    <div class="progress-step" data-step="3">3</div>
                    <div class="progress-step" data-step="4">4</div>
                    <div class="progress-step" data-step="5">5</div>
                    <div class="progress-step" data-step="6">6</div>
                </div>
            </div>
            <div class="modal-body">
                <div id="modalStep1" class="modal-step active">
                    <h3>Choose Your Wing Size</h3>
                    <div id="wingVariants" class="wing-variants-grid"></div>
                </div>
                <div id="modalStep2" class="modal-step">
                    <h3>Choose Your Sauces</h3>
                    <div id="sauceOptions" class="sauce-options-grid"></div>
                </div>
                <div id="modalStep3" class="modal-step">
                    <h3 id="step3Title">Choose Included Dips</h3>
                    <div id="includedDipOptions" class="included-dip-options"></div>
                </div>
                <div id="modalStep4" class="modal-step">
                    <h3 id="step4Title">Wing Style</h3>
                    <div id="wingStyleOptions" class="wing-style-options"></div>
                </div>
                <div id="modalStep5" class="modal-step">
                    <h3 id="step5Title">Extra Dips</h3>
                    <div id="extraDipOptions" class="extra-dip-options"></div>
                </div>
                <div id="modalStep6" class="modal-step">
                    <h3 id="step6Title">Order Summary</h3>
                    <div id="orderSummary" class="order-summary"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="modalBackBtn" onclick="navigateModalStep(-1)" style="display: none;">← Back</button>
                <button id="modalNextBtn" onclick="navigateModalStep(1)">Next →</button>
                <button id="modalAddToCartBtn" onclick="addWingOrderToCart()" style="display: none;">Add to Cart</button>
            </div>
        </div>
    </div>

    <!-- Sides Ordering Modal (Shared) -->
    <div id="sidesModal" class="sides-modal" style="display: none;">
        <div class="modal-backdrop" onclick="closeSidesModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-close" onclick="closeSidesModal()">&times;</button>
                <h2 id="sideModalTitle" class="modal-title">Choose Your Side</h2>
                <div class="modal-progress" id="sideModalProgress"></div>
            </div>
            <div class="modal-body">
                <div id="sideModalVariants" class="modal-step active">
                    <h3 id="sideVariantsTitle" class="modal-step-title">Choose Your Side</h3>
                    <div id="sideOptions" class="side-options-grid"></div>
                </div>
                <div id="sideModalCustomization" class="modal-step">
                    <h3 id="sideCustomizationTitle" class="modal-step-title">Customize</h3>
                    <div id="sideCustomizationContent"></div>
                </div>
                <div id="sideModalDips" class="modal-step">
                    <h3 id="sideDipsTitle" class="modal-step-title">Extra Dipping Sauces</h3>
                    <div id="sideExtraDips" class="extra-dips-grid"></div>
                </div>
                <div id="sideModalSummary" class="modal-step">
                    <h3 id="sideSummaryTitle" class="modal-step-title">Order Summary</h3>
                    <div id="sideOrderSummary" class="order-summary"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="sideModalBackBtn" onclick="navigateSideModalStep(-1)" style="display: none;">← Back</button>
                <button id="sideModalNextBtn" onclick="navigateSideModalStep(1)">Next →</button>
                <button id="sideModalAddToCartBtn" onclick="addSideOrderToCart()" style="display: none;">Add to Cart</button>
            </div>
        </div>
    </div>

    <!-- Beverage Ordering Modal -->
    <div id="beverageModal" class="wing-modal" style="display: none;">
        <div class="modal-backdrop" onclick="closeBeverageModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-close" onclick="closeBeverageModal()">&times;</button>
                <h2 id="beverageModalTitle" class="modal-title">Choose Your Beverage</h2>
                <div class="modal-progress">
                    <div class="progress-step active" data-step="1">Size</div>
                    <div class="progress-step" data-step="2">Flavor</div>
                    <div class="progress-step" data-step="3">Summary</div>
                </div>
            </div>
            <div class="modal-body">
                <div id="beverageModalStep1" class="modal-step active">
                    <h3 id="beverageStep1Title">Choose Your Size</h3>
                    <div id="beverageSizeOptions" class="beverage-size-options"></div>
                </div>
                <div id="beverageModalStep2" class="modal-step">
                    <h3 id="beverageStep2Title">Choose Your Flavor</h3>
                    <div id="beverageFlavorOptions" class="beverage-flavor-options"></div>
                </div>
                <div id="beverageModalStep3" class="modal-step">
                    <h3>Order Summary</h3>
                    <div id="beverageOrderSummary" class="order-summary"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="beverageModalBackBtn" onclick="navigateBeverageModalStep(-1)" style="display: none;">← Back</button>
                <button id="beverageModalNextBtn" onclick="navigateBeverageModalStep(1)">Next →</button>
                <button id="beverageModalAddToCartBtn" onclick="addBeverageOrderToCart()" style="display: none;">Add to Cart</button>
            </div>
        </div>
    </div>
  
    <script>
    // ==============================================
    // PHILLY WINGS EXPRESS - DOORDASH JAVASCRIPT
    // Modular Architecture - Generated at 2025-10-02T00:09:28.810Z
    // ==============================================

    
    // ==============================================
    // GLOBAL VARIABLES AND STRATEGIC MENU DATA
    // ==============================================

    // Real Firestore sauce data (integrated from server-side)
    let firestoreSauces = [{"id":"mild-buffalo","name":"Mild Buffalo","category":"signature-sauce","description":"Mild buffalo - all flavor, easy heat","altText":"Mild buffalo sauce wings","heatLevel":1,"badges":[],"active":true,"featured":false,"sortOrder":7,"allergens":["dairy"],"isDryRub":false,"containsDairy":true,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Mild Buffalo","ubereats":"Buffalo Mild","grubhub":"Mild Buffalo"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000,"imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fbuffalo-sauced.png?alt=media"},{"id":"classic-lemon-pepper","name":"Classic Lemon Pepper","category":"dry-rub","description":"Classic lemon pepper - zesty citrus, cracked black pepper","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Flemon-pepper-dry-rub.png?alt=media","altText":"Classic lemon pepper dry rub on crispy wings","heatLevel":1,"badges":[],"active":true,"featured":false,"sortOrder":1,"allergens":[],"isDryRub":true,"containsDairy":false,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Classic Lemon Pepper","ubereats":"Classic Lemon Pepper","grubhub":"Classic Lemon Pepper"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000},{"id":"philly-classic-hot","name":"Philly Classic Hot","category":"signature-sauce","description":"Traditional hot buffalo - the perfect heat","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fmenu%2Fphilly-classic-hot.jpg?alt=media","altText":"Philly classic hot buffalo sauce wings","heatLevel":3,"badges":[],"active":true,"featured":false,"sortOrder":8,"allergens":["dairy"],"isDryRub":false,"containsDairy":true,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Philly Classic Hot","ubereats":"Classic Hot Buffalo","grubhub":"Hot Buffalo"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000},{"id":"sweet-teriyaki","name":"Sweet Teriyaki","category":"signature-sauce","description":"Teriyaki glaze - soy, ginger, sesame","altText":"Sweet teriyaki glazed wings","heatLevel":0,"badges":[],"active":true,"featured":false,"sortOrder":5,"allergens":["soy","sesame"],"isDryRub":false,"containsDairy":false,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Sweet Teriyaki","ubereats":"Teriyaki","grubhub":"Sweet Teriyaki Glaze"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000,"imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fteriyaki-sauced.png?alt=media"},{"id":"tailgate-bbq","name":"Tailgate BBQ","category":"signature-sauce","description":"Classic BBQ - sweet, tangy, smoky","altText":"Tailgate BBQ sauce wings","heatLevel":0,"badges":[],"active":true,"featured":false,"sortOrder":6,"allergens":[],"isDryRub":false,"containsDairy":false,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Tailgate BBQ","ubereats":"BBQ","grubhub":"Classic BBQ"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000,"imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fbbq-sauced.png?alt=media"},{"id":"northeast-hot-lemon","name":"Northeast Hot Lemon","category":"dry-rub","description":"Spicy lemon pepper with cayenne kick","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fnortheast-hot-lemon.png?alt=media","altText":"Northeast hot lemon pepper dry rub with cayenne","heatLevel":2,"badges":[],"active":true,"featured":false,"sortOrder":2,"allergens":[],"isDryRub":true,"containsDairy":false,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Northeast Hot Lemon","ubereats":"Hot Lemon Pepper","grubhub":"Spicy Lemon Pepper"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000},{"id":"honey-mustard","name":"Honey Mustard","category":"dipping-sauce","description":"Sweet & tangy","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fhoney-mustard.png?alt=media","altText":"Honey mustard dipping sauce","heatLevel":0,"badges":[],"active":true,"featured":false,"sortOrder":12,"allergens":[],"isDryRub":false,"containsDairy":false,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Honey Mustard","ubereats":"Honey Mustard","grubhub":"Honey Mustard"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000},{"id":"broad-pattison-burn","name":"Broad & Pattison Burn","category":"signature-sauce","description":"Nashville-style hot - cayenne, brown sugar","altText":"Broad & Pattison Burn Nashville hot wings","heatLevel":4,"badges":[],"active":true,"featured":false,"sortOrder":9,"allergens":[],"isDryRub":false,"containsDairy":false,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Broad & Pattison Burn","ubereats":"Nashville Hot","grubhub":"Extra Hot Nashville"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000,"imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Fbroad-pattison-burn_800x800.webp?alt=media"},{"id":"blue-cheese","name":"Blue Cheese","category":"dipping-sauce","description":"Classic chunky","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fblue-cheese.png?alt=media","altText":"Blue cheese dipping sauce","heatLevel":0,"badges":[],"active":true,"featured":false,"sortOrder":13,"allergens":["dairy"],"isDryRub":false,"containsDairy":true,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Blue Cheese","ubereats":"Chunky Blue Cheese","grubhub":"Blue Cheese"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000},{"id":"cheese-sauce","name":"Cheese Sauce","category":"dipping-sauce","description":"Warm & melty","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fcheese-sauce.png?alt=media","altText":"Warm cheese dipping sauce","heatLevel":0,"badges":[],"active":true,"featured":false,"sortOrder":14,"allergens":["dairy"],"isDryRub":false,"containsDairy":true,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Cheese Sauce","ubereats":"Nacho Cheese","grubhub":"Cheese Dip"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000},{"id":"grittys-revenge","name":"Gritty's Revenge","category":"signature-sauce","description":"Scorpion pepper sauce - NOT for rookies!","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fgrittys-revenge.png?alt=media","altText":"Gritty's Revenge scorpion pepper extreme heat wings","heatLevel":5,"badges":["NOT for rookies!"],"active":true,"featured":true,"sortOrder":10,"allergens":[],"isDryRub":false,"containsDairy":false,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Gritty's Revenge","ubereats":"Scorpion Sauce","grubhub":"Extreme Heat"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000},{"id":"frankford-cajun","name":"Frankford Cajun","category":"dry-rub","description":"Bold Cajun blend - paprika, garlic, herbs","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fcajun-dry-rub.png?alt=media","altText":"Frankford Cajun spice blend dry rub","heatLevel":2,"badges":[],"active":true,"featured":false,"sortOrder":3,"allergens":[],"isDryRub":true,"containsDairy":false,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Frankford Cajun","ubereats":"Cajun Spice","grubhub":"Cajun Dry Rub"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000},{"id":"ranch","name":"Ranch","category":"dipping-sauce","description":"Cool & creamy","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Franch-dip.png?alt=media","altText":"Ranch dipping sauce","heatLevel":0,"badges":[],"active":true,"featured":false,"sortOrder":11,"allergens":["dairy","egg"],"isDryRub":false,"containsDairy":true,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Ranch","ubereats":"Ranch Dip","grubhub":"Ranch"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000},{"id":"garlic-parmesan","name":"Garlic Parmesan","category":"dry-rub","description":"Creamy garlic butter with aged parmesan","altText":"Garlic parmesan dry rub with butter and cheese","heatLevel":0,"badges":[],"active":true,"featured":false,"sortOrder":4,"allergens":["dairy"],"isDryRub":true,"containsDairy":true,"containsGluten":false,"vegetarian":true,"platformNames":{"doordash":"Garlic Parmesan","ubereats":"Garlic Parm","grubhub":"Garlic Parmesan"},"platformAvailability":["doordash","ubereats","grubhub"],"schemaVersion":1,"contentVersion":1,"updatedAt":1737072000000,"imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fgarlic-parmesan-dry-rub.png?alt=media"}];

    // Strategic menu data (populated with real Firestore data)
    let strategicMenu = {
      wings: {"active":true,"baseItem":true,"category":"wings","createdAt":{"_seconds":1737208800,"_nanoseconds":0},"description":"Fresh, never frozen wings double-fried to crispy perfection","id":"wings","images":{"hero":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fwings-hero.jpg?alt=media"},"modifierGroups":["sauce_choice","wing_style","extra_sauces"],"name":"Wings","basePrice":5.99,"sortOrder":3,"variants":[{"id":"wings_6_bonein","name":"6 Wings (Bone-In)","count":6,"type":"bone-in","basePrice":8.99,"platformPricing":{"doordash":12.14,"ubereats":12.14,"grubhub":10.92},"includedSauces":1,"description":"6 fresh bone-in wings with 1 included sauce","portionDetails":{"count":6,"includes":["1 sauce of choice"]},"platformPrice":12.14},{"id":"wings_6_boneless","name":"6 Wings (Boneless)","count":6,"type":"boneless","basePrice":6.99,"platformPricing":{"doordash":9.44,"ubereats":9.44,"grubhub":8.49},"includedSauces":1,"description":"6 fresh boneless wings with 1 included sauce","portionDetails":{"count":6,"includes":["1 sauce of choice"]},"platformPrice":9.44},{"id":"wings_12_bonein","name":"12 Wings (Bone-In)","count":12,"type":"bone-in","basePrice":14.99,"platformPricing":{"doordash":20.24,"ubereats":20.24,"grubhub":18.22},"includedSauces":2,"description":"12 fresh bone-in wings with 2 included sauces","portionDetails":{"count":12,"includes":["2 sauces of choice"]},"platformPrice":20.24},{"id":"wings_12_boneless","name":"12 Wings (Boneless)","count":12,"type":"boneless","basePrice":11.99,"platformPricing":{"doordash":16.19,"ubereats":16.19,"grubhub":14.57},"includedSauces":2,"description":"12 fresh boneless wings with 2 included sauces","portionDetails":{"count":12,"includes":["2 sauces of choice"]},"platformPrice":16.19},{"id":"wings_24_bonein","name":"24 Wings (Bone-In)","count":24,"type":"bone-in","basePrice":25.99,"platformPricing":{"doordash":35.09,"ubereats":35.09,"grubhub":31.58},"includedSauces":4,"description":"24 fresh bone-in wings with 4 included sauces","portionDetails":{"count":24,"includes":["4 sauces of choice"]},"platformPrice":35.09},{"id":"wings_24_boneless","name":"24 Wings (Boneless)","count":24,"type":"boneless","basePrice":20.99,"platformPricing":{"doordash":28.34,"ubereats":28.34,"grubhub":25.5},"includedSauces":4,"description":"24 fresh boneless wings with 4 included sauces","portionDetails":{"count":24,"includes":["4 sauces of choice"]},"platformPrice":28.34},{"id":"wings_30_bonein","name":"30 Wings (Bone-In)","count":30,"type":"bone-in","basePrice":32.99,"platformPricing":{"doordash":44.54,"ubereats":44.54,"grubhub":40.08},"includedSauces":5,"description":"30 fresh bone-in wings with 5 included sauces","portionDetails":{"count":30,"includes":["5 sauces of choice"]},"platformPrice":44.54},{"id":"wings_30_boneless","name":"30 Wings (Boneless)","count":30,"type":"boneless","basePrice":25.99,"platformPricing":{"doordash":35.09,"ubereats":35.09,"grubhub":31.58},"includedSauces":5,"description":"30 fresh boneless wings with 5 included sauces","portionDetails":{"count":30,"includes":["5 sauces of choice"]},"platformPrice":35.09},{"id":"wings_50_bonein","name":"50 Wings (Bone-In)","count":50,"type":"bone-in","basePrice":49.99,"platformPricing":{"doordash":67.49,"ubereats":67.49,"grubhub":60.74},"includedSauces":8,"description":"50 fresh bone-in wings with 8 included sauces","portionDetails":{"count":50,"includes":["8 sauces of choice"]},"platformPrice":67.49},{"id":"wings_50_boneless","name":"50 Wings (Boneless)","count":50,"type":"boneless","basePrice":39.99,"platformPricing":{"doordash":53.99,"ubereats":53.99,"grubhub":48.59},"includedSauces":8,"description":"50 fresh boneless wings with 8 included sauces","portionDetails":{"count":50,"includes":["8 sauces of choice"]},"platformPrice":53.99}],"updatedAt":{"_seconds":1758564900,"_nanoseconds":0}},
      fries: {"id":"fries","name":"Fries","category":"sides","description":"Golden crispy fries","baseItem":true,"active":true,"sortOrder":2,"images":{"hero":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Ffries-loaded.jpg?alt=media"},"createdAt":{"_seconds":1758326400,"_nanoseconds":0},"basePrice":3.99,"updatedAt":{"_seconds":1758565500,"_nanoseconds":0},"variants":[{"description":"Golden crispy fries","size":"regular","name":"French Fries","platformPricing":{"doordash":3.71,"ubereats":3.71,"grubhub":3.44},"basePrice":2.75,"id":"fries_regular"},{"basePrice":5.49,"name":"Cheese Fries","platformPricing":{"doordash":7.41,"ubereats":7.41,"grubhub":7.28},"id":"fries_cheese","size":"regular","description":"Golden fries topped with melted cheese"},{"description":"Golden fries with bacon and cheese","basePrice":5.75,"id":"fries_bacon_cheese","platformPricing":{"grubhub":7.19,"doordash":7.76,"ubereats":7.76},"name":"Bacon Cheese Fries","size":"regular"}]},
      mozzarella: {"id":"mozzarella_sticks","name":"Mozzarella Sticks","category":"sides","description":"Crispy golden mozzarella sticks with marinara sauce","baseItem":true,"active":true,"sortOrder":3,"allergens":["dairy","gluten"],"images":{"hero":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fmozzarella-sticks.jpg?alt=media"},"createdAt":{"_seconds":1758326400,"_nanoseconds":0},"platformPricing":{"doordash":9.44,"ubereats":9.44,"grubhub":8.49},"variants":[{"id":"mozzarella_4","name":"4 Mozzarella Sticks","count":4,"basePrice":6.99,"platformPricing":{"doordash":9.44,"ubereats":9.44,"grubhub":8.49},"description":"4 golden mozzarella sticks with marinara sauce"},{"id":"mozzarella_8","name":"8 Mozzarella Sticks","count":8,"basePrice":11.99,"platformPricing":{"doordash":16.19,"ubereats":16.19,"grubhub":14.57},"description":"8 golden mozzarella sticks with marinara sauce"},{"id":"mozzarella_12","name":"12 Mozzarella Sticks","count":12,"basePrice":16.99,"platformPricing":{"doordash":22.94,"ubereats":22.94,"grubhub":20.64},"description":"12 golden mozzarella sticks with marinara sauce"},{"id":"mozzarella_16","name":"16 Mozzarella Sticks","count":16,"basePrice":21.99,"platformPricing":{"doordash":29.69,"ubereats":29.69,"grubhub":26.72},"description":"16 golden mozzarella sticks with marinara sauce"}],"basePrice":6.99,"updatedAt":{"_seconds":1758565500,"_nanoseconds":0}},
      drinks: {"id":"drinks","name":"Drinks","category":"drinks","description":"Beverages","baseItem":true,"active":true,"sortOrder":4,"images":{"hero":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fwater-bottle.jpg?alt=media"},"createdAt":{"_seconds":1758326400,"_nanoseconds":0},"basePrice":1.49,"variants":[{"id":"fountain_20oz","name":"Fountain Drink 20oz","size":"20oz","basePrice":2.49,"image":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ffountain-drinks_200x200.webp?alt=media","platformPrice":3.36,"platformPricing":{"doordash":3.36}},{"id":"fountain_32oz","name":"Fountain Drink 32oz","size":"32oz","basePrice":3.49,"image":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ffountain-drinks_200x200.webp?alt=media","platformPrice":4.71,"platformPricing":{"doordash":4.71}},{"id":"sweet_tea_20oz","name":"Sweet Tea 20oz","size":"20oz","basePrice":2.49,"image":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ficed-tea_200x200.webp?alt=media","platformPrice":3.36,"platformPricing":{"doordash":3.36}},{"id":"sweet_tea_32oz","name":"Sweet Tea 32oz","size":"32oz","basePrice":3.49,"image":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ficed-tea_200x200.webp?alt=media","platformPrice":4.71,"platformPricing":{"doordash":4.71}},{"id":"unsweetened_tea_20oz","name":"Unsweetened Tea 20oz","size":"20oz","basePrice":2.49,"image":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ficed-tea_200x200.webp?alt=media","platformPrice":3.36,"platformPricing":{"doordash":3.36}},{"id":"unsweetened_tea_32oz","name":"Unsweetened Tea 32oz","size":"32oz","basePrice":3.49,"image":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ficed-tea_200x200.webp?alt=media","platformPrice":4.71,"platformPricing":{"doordash":4.71}},{"id":"bottled_water","name":"Bottled Water","size":"16.9oz","basePrice":2.29,"image":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Fwater-bottle_200x200.webp?alt=media","platformPrice":3.09,"platformPricing":{"doordash":3.09}}],"updatedAt":{"_seconds":1758674400,"_nanoseconds":0}},
      sauces: firestoreSauces,
      dips: [],
      sides: [],
      beverages: []
    };

    // Beverage groups for modal interaction
    window.beverageGroups = [{"id":"fountain-drinks","name":"Fountain Drinks","description":"8 Flavors: Coca-Cola, Diet Coke, Coke Zero, Sprite, Fanta Orange, Dr Pepper, Barq's Root Beer, Hi-C Fruit Punch","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ffountain-drinks_200x200.webp?alt=media","badge":"CHOOSE SIZE","featured":true,"sizes":[{"id":"fountain_20oz","name":"20oz","label":"20oz","description":"Fountain drink 20oz","platformPrice":3.36,"basePrice":2.49},{"id":"fountain_32oz","name":"32oz","label":"32oz","description":"Fountain drink 32oz","platformPrice":4.71,"basePrice":3.49}],"flavors":[{"id":"coca_cola","name":"Coca-Cola"},{"id":"diet_coke","name":"Diet Coke"},{"id":"coke_zero","name":"Coke Zero"},{"id":"sprite","name":"Sprite"},{"id":"fanta_orange","name":"Fanta Orange"},{"id":"dr_pepper","name":"Dr Pepper"},{"id":"barqs_root_beer","name":"Barq's Root Beer"},{"id":"hic_fruit_punch","name":"Hi-C Fruit Punch"}],"type":"fountain"},{"id":"iced-tea","name":"Fresh Brewed Tea","description":"Freshly brewed daily • Sweet or unsweetened • Perfect refreshment","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Ficed-tea_200x200.webp?alt=media","badge":"FRESH DAILY","sizes":[{"id":"sweet_tea_20oz","name":"Sweet Tea 20oz","label":"20oz","description":"Sweet Tea 20oz","platformPrice":3.36,"basePrice":2.49},{"id":"sweet_tea_32oz","name":"Sweet Tea 32oz","label":"32oz","description":"Sweet Tea 32oz","platformPrice":4.71,"basePrice":3.49},{"id":"unsweetened_tea_20oz","name":"Unsweetened Tea 20oz","label":"20oz","description":"Unsweetened Tea 20oz","platformPrice":3.36,"basePrice":2.49},{"id":"unsweetened_tea_32oz","name":"Unsweetened Tea 32oz","label":"32oz","description":"Unsweetened Tea 32oz","platformPrice":4.71,"basePrice":3.49},{"id":"unsweetened_tea_20oz","name":"Unsweetened Tea 20oz","label":"20oz","description":"Unsweetened Tea 20oz","platformPrice":3.36,"basePrice":2.49},{"id":"unsweetened_tea_32oz","name":"Unsweetened Tea 32oz","label":"32oz","description":"Unsweetened Tea 32oz","platformPrice":4.71,"basePrice":3.49}],"flavors":[{"id":"sweet","name":"Sweet Tea"},{"id":"unsweetened","name":"Unsweetened Tea"}],"type":"tea"},{"id":"bottled_water","name":"Bottled Water","description":"Pure refreshment • 16.9 fl oz bottle","imageUrl":"https://firebasestorage.googleapis.com/v0/b/philly-wings.firebasestorage.app/o/images%2Fresized%2Fwater-bottle_200x200.webp?alt=media","badge":"PURE","sizes":[{"id":"bottled_water","name":"Bottled Water","label":"Standard","description":"Pure refreshment • 16.9 fl oz bottle","platformPrice":3.09,"basePrice":2.29}],"flavors":[],"type":"bottle"}];

    console.log('Global variables initialized with Firestore data');
  

    // ==============================================
    // SHARED UTILITIES MODULE
    // ==============================================
    
    // Mobile Menu Functions
    function toggleMobileMenu() {
      const mobileNav = document.getElementById('mobileNav');
      if (mobileNav) {
        mobileNav.classList.toggle('show');
      }
    }

    function closeMobileMenu() {
      const mobileNav = document.getElementById('mobileNav');
      if (mobileNav) {
        mobileNav.classList.remove('show');
      }
    }

    // Close mobile menu when clicking outside
    document.addEventListener('click', function(event) {
      const mobileNav = document.getElementById('mobileNav');
      const hamburger = document.querySelector('.hamburger-menu');

      if (mobileNav && !mobileNav.contains(event.target) && !hamburger.contains(event.target)) {
        closeMobileMenu();
      }
    });

    // Sauce Modal (individual sauce details)
    window.openSauceModal = function(sauceId, sauceData) {
      console.log('Opening sauce modal for:', sauceId, sauceData);

      // TODO: Implement individual sauce detail modal
      alert('Sauce details for: ' + (sauceData.name || sauceId));
    };

    window.closeSauceModal = function() {
      const modal = document.getElementById('sauceModal');
      if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
      }
    };

    // Navigation and Smooth Scrolling Functions
    function scrollToSection(sectionId) {
      const element = document.getElementById(sectionId);
      if (element) {
        element.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });

        // Close mobile menu if open
        closeMobileMenu();
      }
    }

    // Utility Functions
    function formatPrice(price) {
      return typeof price === 'number' ? price.toFixed(2) : '0.00';
    }

    function generateId() {
      return Math.random().toString(36).substr(2, 9);
    }

    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // Initialize smooth scrolling for navigation links
    document.addEventListener('DOMContentLoaded', function() {
      // Add click handlers for navigation links
      document.querySelectorAll('a[href^="#"]').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const targetId = this.getAttribute('href').slice(1);
          scrollToSection(targetId);
        });
      });
    });

    // Global modal utilities
    function closeAllModals() {
      const modals = ['wingsModal', 'sidesModal', 'beverageModal', 'sauceModal'];
      modals.forEach(modalId => {
        const modal = document.getElementById(modalId);
        if (modal) {
          modal.style.display = 'none';
        }
      });
      document.body.style.overflow = 'auto';
    }

    // Close modals on ESC key
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        closeAllModals();
      }
    });

    // Global click outside modal handler
    document.addEventListener('click', function(event) {
      if (event.target.classList.contains('modal')) {
        closeAllModals();
      }
    });
  

    // ==============================================
    // SIDES MODAL MODULE (Modular Architecture)
    // ==============================================
    
    (function(){
      const DEFAULT_DIPS = [{"id":"honey-mustard","name":"Honey Mustard","price":0.75,"description":"Sweet & tangy"},{"id":"blue-cheese","name":"Blue Cheese","price":0.75,"description":"Classic chunky"},{"id":"cheese-sauce","name":"Cheese Sauce","price":0.75,"description":"Warm & melty"},{"id":"ranch","name":"Ranch","price":0.75,"description":"Cool & creamy"}];
      const STEP_CONTAINER_IDS = {
        variants: 'sideModalVariants',
        customization: 'sideModalCustomization',
        dips: 'sideModalDips',
        summary: 'sideModalSummary'
      };

      const STEP_DEFAULT_LABELS = {
        variants: 'Options',
        customization: 'Customize',
        dips: 'Dips',
        summary: 'Summary'
      };

      const STEP_DEFAULT_TITLES = {
        variants: 'Choose Your Side',
        customization: 'Customize Your Order',
        dips: 'Extra Dipping Sauces',
        summary: 'Order Summary'
      };

      const state = {
        config: null,
        steps: [],
        stepIndex: 0,
        quantities: {},
        dips: {},
        customization: {}
      };

      function formatCurrency(value) {
        const number = Number(value);
        if (Number.isNaN(number)) return '0.00';
        return number.toFixed(2);
      }

      function getVariantPrice(variant) {
        if (typeof variant.platformPrice === 'number') return variant.platformPrice;
        if (typeof variant.price === 'number') return variant.price;
        if (typeof variant.basePrice === 'number') return variant.basePrice;
        const parsed = parseFloat(variant.platformPrice || variant.price || variant.basePrice);
        return Number.isNaN(parsed) ? 0 : parsed;
      }

      function ensureCustomizationDefaults(config) {
        if (!config.customization || !config.customization.enabled) return;
        const key = config.customization.stateKey || 'customOption';
        const defaultId = config.customization.defaultOption || (config.customization.options && config.customization.options[0]?.id);
        if (defaultId && !state.customization[key]) {
          state.customization[key] = defaultId;
        }
      }

      function buildStepDefinitions(config) {
        const order = Array.isArray(config.stepOrder) && config.stepOrder.length ? config.stepOrder : ['variants', 'dips', 'summary'];
        const steps = [];
        order.forEach((key) => {
          if (key === 'variants') {
            steps.push({ key: 'variants', label: config.stepLabels?.variants || STEP_DEFAULT_LABELS.variants, title: config.stepTitles?.variants || STEP_DEFAULT_TITLES.variants, requiresSelection: true });
          }
          if (key === 'customization' && config.customization && config.customization.enabled) {
            steps.push({ key: 'customization', label: config.stepLabels?.customization || STEP_DEFAULT_LABELS.customization, title: config.stepTitles?.customization || STEP_DEFAULT_TITLES.customization, requiresCustomization: config.customization.required !== false });
          }
          if (key === 'dips' && config.dipsEnabled !== false) {
            steps.push({ key: 'dips', label: config.stepLabels?.dips || STEP_DEFAULT_LABELS.dips, title: config.stepTitles?.dips || STEP_DEFAULT_TITLES.dips });
          }
          if (key === 'summary') {
            steps.push({ key: 'summary', label: config.stepLabels?.summary || STEP_DEFAULT_LABELS.summary, title: config.stepTitles?.summary || STEP_DEFAULT_TITLES.summary });
          }
        });
        // Ensure we always have a summary step.
        if (!steps.some(step => step.key === 'summary')) {
          steps.push({ key: 'summary', label: config.stepLabels?.summary || STEP_DEFAULT_LABELS.summary, title: config.stepTitles?.summary || STEP_DEFAULT_TITLES.summary });
        }
        return steps;
      }

      function getStepContainer(stepKey) {
        const containerId = STEP_CONTAINER_IDS[stepKey];
        if (!containerId) return null;
        return document.getElementById(containerId) || null;
      }

      function hideAllStepContainers() {
        Object.values(STEP_CONTAINER_IDS).forEach((id) => {
          const container = document.getElementById(id);
          if (container) {
            container.classList.remove('active');
          }
        });
      }

      function configureProgress(steps) {
        const progressEl = document.getElementById('sideModalProgress');
        if (!progressEl) return;
        progressEl.style.cssText = 'display: flex; justify-content: center; gap: 1rem; margin-top: 1rem;';
        progressEl.innerHTML = steps.map((step, index) => {
          return '<div class="progress-step' + (index === 0 ? ' active' : '') + '" data-step="' + (index + 1) + '" style="' +
            'width: 40px; ' +
            'height: 40px; ' +
            'border-radius: 50%; ' +
            'background: ' + (index === 0 ? '#FF3333' : '#f0f0f0') + '; ' +
            'color: ' + (index === 0 ? 'white' : '#666') + '; ' +
            'display: flex; ' +
            'align-items: center; ' +
            'justify-content: center; ' +
            'font-weight: 700; ' +
            'font-size: 12px; ' +
            'transition: all 0.3s ease; ' +
            'position: relative; ' +
            'z-index: 1;' +
          '">' + step.label + '</div>';
        }).join('');
      }

      function updateProgress() {
        const progressEl = document.getElementById('sideModalProgress');
        if (!progressEl) return;
        const steps = progressEl.querySelectorAll('.progress-step');
        steps.forEach((el, index) => {
          el.classList.remove('active', 'completed');
          if (index < state.stepIndex) {
            el.classList.add('completed');
            el.style.background = '#FFE66D';
            el.style.color = '#333';
          } else if (index === state.stepIndex) {
            el.classList.add('active');
            el.style.background = '#FF3333';
            el.style.color = 'white';
          } else {
            el.style.background = '#f0f0f0';
            el.style.color = '#666';
          }
        });
      }

      function setModalHeaderTitles() {
        const titleEl = document.getElementById('sideModalTitle');
        if (titleEl && state.config) {
          titleEl.textContent = state.config.modalTitle || 'Choose Your Side';
        }
        const currentStep = state.steps[state.stepIndex];
        if (!currentStep) return;
        const titleId = {
          variants: 'sideVariantsTitle',
          customization: 'sideCustomizationTitle',
          dips: 'sideDipsTitle',
          summary: 'sideSummaryTitle'
        }[currentStep.key];
        if (titleId) {
          const el = document.getElementById(titleId);
          if (el) {
            el.textContent = currentStep.title || STEP_DEFAULT_TITLES[currentStep.key] || 'Step';
          }
        }
      }

      function renderVariantsStep(container) {
        if (!container || !state.config) return;
        const variants = state.config.variants || [];
        if (!variants.length) {
          container.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666; font-size: 16px;"><p>No sides available at the moment.</p></div>';
          return;
        }

        container.innerHTML = variants.map(variant => {
          const quantity = state.quantities[variant.id] || 0;
          const subtitle = variant.subtitle || variant.description || '';
          const price = formatCurrency(getVariantPrice(variant));

          return '<div class="enhanced-side-card' + (quantity > 0 ? ' selected' : '') + '" onclick="updateSideQuantity(\'' + variant.id + '\', 1)" style="' +
            'background: ' + (quantity > 0 ? 'linear-gradient(135deg, #fff5f2 0%, #ffede8 100%)' : 'white') + '; ' +
            'border: 2px solid ' + (quantity > 0 ? '#ff6b35' : '#e0e0e0') + '; ' +
            'border-radius: 16px; ' +
            'padding: 1.5rem; ' +
            'margin-bottom: 1rem; ' +
            'cursor: pointer; ' +
            'transition: all 0.3s ease; ' +
            'box-shadow: ' + (quantity > 0 ? '0 8px 25px rgba(255, 107, 53, 0.15)' : '0 2px 10px rgba(0,0,0,0.1)') + '; ' +
            'transform: ' + (quantity > 0 ? 'translateY(-2px)' : 'none') + '; ' +
            'position: relative; ' +
            'overflow: hidden;' +
          '">' +
            '<div style="position: relative; z-index: 2;">' +
              '<div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.75rem;">' +
                '<div style="flex: 1;">' +
                  '<h4 style="margin: 0 0 0.5rem 0; font-size: 1.1rem; font-weight: 600; color: #1a1a1a; line-height: 1.3;">' + (variant.name || 'Side Option') + '</h4>' +
                  (subtitle ? '<p style="margin: 0; color: #666; font-size: 14px; line-height: 1.4;">' + subtitle + '</p>' : '') +
                '</div>' +
                '<div style="margin-left: 1rem; text-align: right;">' +
                  '<div style="font-size: 1.25rem; font-weight: 700; color: #ff6b35; margin-bottom: 0.5rem;">$' + price + '</div>' +
                '</div>' +
              '</div>' +
              '<div style="display: flex; justify-content: space-between; align-items: center;">' +
                '<div style="font-size: 13px; color: #888; font-weight: 500;">Click to add • Tap again to increase</div>' +
                '<div class="enhanced-quantity-controls" style="display: flex; align-items: center; gap: 12px; background: ' + (quantity > 0 ? '#fff' : '#f8f9fa') + '; border-radius: 25px; padding: 8px 16px; border: 1px solid ' + (quantity > 0 ? '#ff6b35' : '#dee2e6') + ';">' +
                  '<button class="enhanced-quantity-btn" onclick="event.stopPropagation(); updateSideQuantity(\'' + variant.id + '\', -1)" ' +
                    'style="width: 32px; height: 32px; border: none; background: ' + (quantity === 0 ? '#f1f3f4' : '#ff6b35') + '; color: ' + (quantity === 0 ? '#9aa0a6' : 'white') + '; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: bold; cursor: ' + (quantity === 0 ? 'not-allowed' : 'pointer') + '; transition: all 0.2s ease; opacity: ' + (quantity === 0 ? '0.5' : '1') + ';" ' +
                    (quantity === 0 ? 'disabled' : '') + '>−</button>' +
                  '<span class="enhanced-quantity-display" id="qty_' + variant.id + '" style="min-width: 24px; text-align: center; font-size: 16px; font-weight: 600; color: #1a1a1a;">' + quantity + '</span>' +
                  '<button class="enhanced-quantity-btn" onclick="event.stopPropagation(); updateSideQuantity(\'' + variant.id + '\', 1)" ' +
                    'style="width: 32px; height: 32px; border: none; background: #ff6b35; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: bold; cursor: pointer; transition: all 0.2s ease;">+</button>' +
                '</div>' +
              '</div>' +
            '</div>' +
            (quantity > 0 ? '<div style="position: absolute; top: 12px; right: 12px; width: 24px; height: 24px; background: #ff6b35; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 3;"><svg width="14" height="10" viewBox="0 0 14 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 5L5 9L13 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>' : '') +
          '</div>';
        }).join('');
      }

      function renderCustomizationStep(container) {
        if (!container || !state.config || !state.config.customization || !state.config.customization.enabled) {
          if (container) container.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666; font-size: 16px;"><p>No customization available.</p></div>';
          return;
        }
        const customization = state.config.customization;
        const key = customization.stateKey || 'customOption';
        const options = customization.options || [];
        if (!options.length) {
          container.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666; font-size: 16px;"><p>No customization options configured.</p></div>';
          return;
        }
        const selectedId = state.customization[key];
        container.innerHTML = options.map(option => {
          const isSelected = option.id === selectedId;
          return '<div class="enhanced-customization-option" onclick="setSideCustomizationOption(\'' + option.id + '\')" style="' +
            'display: flex; ' +
            'align-items: center; ' +
            'justify-content: space-between; ' +
            'padding: 1.5rem; ' +
            'border: 2px solid ' + (isSelected ? '#ff6b35' : '#e0e0e0') + '; ' +
            'border-radius: 16px; ' +
            'margin-bottom: 1rem; ' +
            'background: ' + (isSelected ? 'linear-gradient(135deg, #fff5f2 0%, #ffede8 100%)' : 'white') + '; ' +
            'cursor: pointer; ' +
            'transition: all 0.3s ease; ' +
            'box-shadow: ' + (isSelected ? '0 8px 25px rgba(255, 107, 53, 0.15)' : '0 2px 10px rgba(0,0,0,0.1)') + '; ' +
            'transform: ' + (isSelected ? 'translateY(-2px)' : 'none') + '; ' +
            'position: relative; ' +
            'overflow: hidden;' +
          '">' +
            '<div style="flex: 1; position: relative; z-index: 2;">' +
              '<div style="font-weight: 600; color: #1a1a1a; font-size: 1.1rem; margin-bottom: 0.5rem;">' + option.label + '</div>' +
              (option.description ? '<div style="color: #666; font-size: 14px; line-height: 1.4;">' + option.description + '</div>' : '') +
            '</div>' +
            '<div style="margin-left: 1rem; position: relative; z-index: 2;">' +
              '<div style="width: 28px; height: 28px; border-radius: 50%; border: 2px solid ' + (isSelected ? '#ff6b35' : '#ccc') + '; display: flex; align-items: center; justify-content: center; background: ' + (isSelected ? '#ff6b35' : 'white') + '; transition: all 0.3s ease;">' +
                (isSelected ? '<svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 6L5.5 10.5L15 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>' : '') +
              '</div>' +
            '</div>' +
            (isSelected ? '<div style="position: absolute; top: 12px; right: 12px; background: #ff6b35; color: white; padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Selected</div>' : '') +
          '</div>';
        }).join('');
      }

      function renderDipsStep(container) {
        if (!container || !state.config) return;
        const dips = state.config.dipsEnabled === false ? [] : (state.config.dips || DEFAULT_DIPS);
        if (!dips.length) {
          container.innerHTML = '<p style="text-align:center; color:#666;">No extra dips available.</p>';
          return;
        }

        container.innerHTML =
          '<div style="margin-bottom: 20px; font-size: 14px; color: #666; text-align: center;">Select extra dipping sauces (optional) - $' + formatCurrency(dips[0]?.price || 0.75) + ' each</div>' +
          '<div style="margin-bottom: 16px; text-align: center;">' +
            '<button onclick="skipSideDips()" style="padding: 10px 20px; background: #f8f9fa; border: 2px solid #dee2e6; color: #6c757d; border-radius: 8px; cursor: pointer; font-size: 14px;">Skip Dips (None)</button>' +
          '</div>' +
          dips.map(dip => {
            const quantity = state.dips[dip.id] || 0;
            return '<div class="side-dip-option" style="display: flex; align-items: center; justify-content: space-between; padding: 15px; border: 2px solid ' + (quantity > 0 ? '#ff6b35' : '#e0e0e0') + '; border-radius: 12px; margin-bottom: 12px; background: ' + (quantity > 0 ? '#fff5f2' : 'white') + ';">' +
              '<div style="flex: 1;">' +
                '<h5 style="margin: 0 0 4px 0; color: #1a1a1a; font-size: 16px;">' + dip.name + '</h5>' +
                '<p style="margin: 0; color: #666; font-size: 14px;">' + (dip.description || '') + (dip.price ? ' - $' + formatCurrency(dip.price) + ' each' : '') + '</p>' +
              '</div>' +
              '<div style="display: flex; align-items: center; gap: 12px;">' +
                '<button onclick="adjustSideDipQuantity(\'' + dip.id + '\', -1)" style="width: 36px; height: 36px; border: 2px solid ' + (quantity === 0 ? '#ccc' : '#ff6b35') + '; background: white; color: ' + (quantity === 0 ? '#ccc' : '#ff6b35') + '; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: bold; cursor: ' + (quantity === 0 ? 'not-allowed' : 'pointer') + '; opacity: ' + (quantity === 0 ? '0.3' : '1') + ';" ' + (quantity === 0 ? 'disabled' : '') + '>−</button>' +
                '<span style="min-width: 24px; text-align: center; font-size: 18px; font-weight: bold; color: #1a1a1a;">' + quantity + '</span>' +
                '<button onclick="adjustSideDipQuantity(\'' + dip.id + '\', 1)" style="width: 36px; height: 36px; border: 2px solid #ff6b35; background: #ff6b35; color: white; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: bold; cursor: pointer;">+</button>' +
              '</div>' +
            '</div>';
          }).join('');
      }

      function renderSummaryStep(container) {
        if (!container || !state.config) return;
        const payload = buildOrderPayload();

        if (!payload.items.length) {
          container.innerHTML = '<div style="text-align: center; padding: 3rem; color: #666; font-size: 16px;"><p>No items selected yet.</p><p style="font-size: 14px; margin-top: 1rem;">Go back to select your items.</p></div>';
          return;
        }

        const itemHtml = payload.items.map(item =>
          '<div style="' +
            'display: flex; ' +
            'justify-content: space-between; ' +
            'align-items: center; ' +
            'padding: 12px 0; ' +
            'border-bottom: 1px solid #f0f0f0; ' +
            'font-size: 16px;' +
          '">' +
            '<div style="flex: 1;">' +
              '<div style="font-weight: 600; color: #1a1a1a; margin-bottom: 2px;">' + item.name + '</div>' +
              '<div style="font-size: 14px; color: #666;">Qty: ' + item.quantity + '</div>' +
            '</div>' +
            '<div style="font-weight: 700; color: #ff6b35; font-size: 18px;">$' + formatCurrency(item.total) + '</div>' +
          '</div>'
        ).join('');

        const dipHtml = payload.dips.length ?
          '<div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid #f0f0f0;">' +
            '<div style="display: flex; align-items: center; margin-bottom: 1rem;">' +
              '<div style="width: 4px; height: 20px; background: #ff6b35; border-radius: 2px; margin-right: 12px;"></div>' +
              '<h4 style="margin: 0; font-weight: 600; font-size: 16px; color: #1a1a1a;">Extra Dipping Sauces</h4>' +
            '</div>' +
            payload.dips.map(dip =>
              '<div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; font-size: 15px;">' +
                '<span style="color: #555;">' + dip.name + ' × ' + dip.quantity + '</span>' +
                '<span style="font-weight: 600; color: #ff6b35;">$' + formatCurrency(dip.total) + '</span>' +
              '</div>'
            ).join('') +
          '</div>' :
          '<div style="margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-radius: 8px; text-align: center;">' +
            '<div style="font-size: 14px; color: #666; font-style: italic;">No extra dipping sauces selected</div>' +
          '</div>';

        let customizationHtml = '';
        if (payload.customization.length) {
          customizationHtml = '<div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid #f0f0f0;">' +
            '<div style="display: flex; align-items: center; margin-bottom: 1rem;">' +
              '<div style="width: 4px; height: 20px; background: #28a745; border-radius: 2px; margin-right: 12px;"></div>' +
              '<h4 style="margin: 0; font-weight: 600; font-size: 16px; color: #1a1a1a;">Customization</h4>' +
            '</div>' +
            payload.customization.map(entry =>
              '<div style="padding: 8px 16px; background: #e8f5e8; border-radius: 8px; margin-bottom: 8px; font-size: 14px; color: #2d5a3d; font-weight: 500;">' +
                entry.label +
              '</div>'
            ).join('') +
          '</div>';
        }

        container.innerHTML =
          '<div style="' +
            'background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); ' +
            'border: 2px solid #e9ecef; ' +
            'border-radius: 16px; ' +
            'padding: 1.5rem; ' +
            'box-shadow: 0 4px 20px rgba(0,0,0,0.08);' +
          '">' +
            '<div style="text-align: center; margin-bottom: 1.5rem;">' +
              '<h3 style="margin: 0 0 0.5rem 0; font-size: 20px; font-weight: 700; color: #1a1a1a;">' + (state.config.summaryHeading || 'Order Summary') + '</h3>' +
              '<div style="width: 60px; height: 3px; background: linear-gradient(90deg, #ff6b35 0%, #ffa726 100%); border-radius: 2px; margin: 0 auto;"></div>' +
            '</div>' +
            '<div style="margin-bottom: 1rem;">' + itemHtml + '</div>' +
            dipHtml +
            customizationHtml +
            '<div style="' +
              'margin-top: 2rem; ' +
              'padding: 1.5rem; ' +
              'background: linear-gradient(135deg, #ff6b35 0%, #ff8f65 100%); ' +
              'border-radius: 12px; ' +
              'box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);' +
            '">' +
              '<div style="display: flex; justify-content: space-between; align-items: center;">' +
                '<span style="font-size: 20px; font-weight: 600; color: white;">Total</span>' +
                '<span style="font-size: 24px; font-weight: 800; color: white;">$' + formatCurrency(payload.total) + '</span>' +
              '</div>' +
            '</div>' +
          '</div>' +
          '<div style="display: flex; gap: 1rem; margin-top: 1.5rem;">' +
            '<button onclick="continueShopping()" style="' +
              'flex: 1; ' +
              'padding: 1rem 1.5rem; ' +
              'background: white; ' +
              'border: 2px solid #e9ecef; ' +
              'color: #6c757d; ' +
              'border-radius: 12px; ' +
              'cursor: pointer; ' +
              'font-size: 16px; ' +
              'font-weight: 600; ' +
              'transition: all 0.3s ease;' +
            '" onmouseover="this.style.background=\'#f8f9fa\'; this.style.borderColor=\'#dee2e6\'" onmouseout="this.style.background=\'white\'; this.style.borderColor=\'#e9ecef\'">← Continue Shopping</button>' +
            '<button onclick="finishSideOrder()" style="' +
              'flex: 2; ' +
              'padding: 1rem 1.5rem; ' +
              'background: linear-gradient(135deg, #28a745 0%, #34ce57 100%); ' +
              'border: 2px solid #28a745; ' +
              'color: white; ' +
              'border-radius: 12px; ' +
              'cursor: pointer; ' +
              'font-size: 16px; ' +
              'font-weight: 700; ' +
              'transition: all 0.3s ease; ' +
              'box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);' +
            '" onmouseover="this.style.transform=\'translateY(-2px)\'; this.style.boxShadow=\'0 6px 20px rgba(40, 167, 69, 0.4)\'" onmouseout="this.style.transform=\'none\'; this.style.boxShadow=\'0 4px 15px rgba(40, 167, 69, 0.3)\'">Add to Cart 🛒</button>' +
          '</div>';
      }

      function buildOrderPayload() {
        const variants = state.config?.variants || [];
        const items = Object.keys(state.quantities).map((variantId) => {
          const quantity = state.quantities[variantId];
          const variant = variants.find(v => v.id === variantId);
          if (!variant || quantity <= 0) return null;
          const unitPrice = getVariantPrice(variant);
          return {
            id: variant.id,
            name: variant.name || 'Side Option',
            quantity,
            unitPrice,
            total: unitPrice * quantity
          };
        }).filter(Boolean);

        const dipSelections = Object.keys(state.dips).map(dipId => {
          const dipData = (state.config?.dips || DEFAULT_DIPS).find(d => d.id === dipId);
          const quantity = state.dips[dipId];
          if (!dipData || quantity <= 0) return null;
          const price = typeof dipData.price === 'number' ? dipData.price : 0.75;
          return {
            id: dipData.id,
            name: dipData.name,
            quantity,
            unitPrice: price,
            total: price * quantity
          };
        }).filter(Boolean);

        const customizationEntries = [];
        if (state.config?.customization && state.config.customization.enabled) {
          const key = state.config.customization.stateKey || 'customOption';
          const selectedId = state.customization[key];
          const option = state.config.customization.options?.find(opt => opt.id === selectedId);
          if (option) {
            customizationEntries.push({ key, value: selectedId, label: option.summaryLabel || option.label });
          }
        }

        const subtotal = items.reduce((sum, item) => sum + item.total, 0) + dipSelections.reduce((sum, dip) => sum + dip.total, 0);

        return {
          sideKey: state.config?.sideKey || 'side',
          title: state.config?.modalTitle || 'Side',
          items,
          dips: dipSelections,
          customization: customizationEntries,
          total: subtotal
        };
      }

      function returnToInitialState() {
        state.steps = [];
        state.stepIndex = 0;
        state.quantities = {};
        state.dips = {};
        state.customization = {};
      }

      function updateButtons() {
        const backBtn = document.getElementById('sideModalBackBtn');
        const nextBtn = document.getElementById('sideModalNextBtn');
        const addBtn = document.getElementById('sideModalAddToCartBtn');
        if (backBtn) backBtn.style.display = state.stepIndex > 0 ? 'block' : 'none';

        const isFinalStep = state.stepIndex === state.steps.length - 1;
        if (nextBtn) nextBtn.style.display = isFinalStep ? 'none' : 'block';
        if (addBtn) addBtn.style.display = isFinalStep ? 'block' : 'none';

        if (nextBtn) {
          nextBtn.disabled = !canAdvance();
        }
      }

      function canAdvance() {
        const currentStep = state.steps[state.stepIndex];
        if (!currentStep) return true;
        if (currentStep.key === 'variants' && totalSelectedQuantity() === 0) return false;
        if (currentStep.key === 'customization' && currentStep.requiresCustomization) {
          const key = state.config?.customization?.stateKey || 'customOption';
          return Boolean(state.customization[key]);
        }
        return true;
      }

      function totalSelectedQuantity() {
        return Object.values(state.quantities).reduce((sum, qty) => sum + qty, 0);
      }

      function renderCurrentStep() {
        hideAllStepContainers();
        const currentStep = state.steps[state.stepIndex];
        if (!currentStep) return;
        const container = getStepContainer(currentStep.key);
        if (!container) return;
        container.classList.add('active');
        setModalHeaderTitles();
        updateProgress();
        switch (currentStep.key) {
          case 'variants':
            renderVariantsStep(document.getElementById('sideOptions'));
            break;
          case 'customization':
            renderCustomizationStep(document.getElementById('sideCustomizationContent'));
            break;
          case 'dips':
            renderDipsStep(document.getElementById('sideExtraDips'));
            break;
          case 'summary':
            renderSummaryStep(document.getElementById('sideOrderSummary'));
            break;
        }
        updateButtons();
      }

      window.openSidesModal = function(config) {
        try {
          if (!config || !Array.isArray(config.variants)) {
            console.error('openSidesModal requires a config with a variants array');
            return;
          }

          returnToInitialState();
          state.config = Object.assign({
            modalTitle: 'Choose Your Side',
            stepOrder: ['variants', 'dips', 'summary'],
            dipsEnabled: true,
            dips: DEFAULT_DIPS.slice()
          }, config);

          if (!Array.isArray(state.config.dips) || !state.config.dips.length) {
            state.config.dips = DEFAULT_DIPS.slice();
          }

          state.steps = buildStepDefinitions(state.config);
          ensureCustomizationDefaults(state.config);

          configureProgress(state.steps);
          const modal = document.getElementById('sidesModal');
          if (!modal) {
            console.error('sidesModal element not found in DOM');
            return;
          }
          modal.style.display = 'flex';
          document.body.style.overflow = 'hidden';

          renderCurrentStep();
        } catch (error) {
          console.error('openSidesModal failed', error);
        }
      };

      window.openSideModal = window.openSidesModal;

      window.closeSidesModal = function() {
        const modal = document.getElementById('sidesModal');
        if (modal) {
          modal.style.display = 'none';
        }
        document.body.style.overflow = 'auto';
      };

      window.navigateSideModalStep = function(direction) {
        if (!state.steps.length) return;
        if (direction > 0 && !canAdvance()) {
          alert('Please complete this step before continuing.');
          return;
        }

        state.stepIndex += direction;
        if (state.stepIndex < 0) state.stepIndex = 0;
        if (state.stepIndex > state.steps.length - 1) state.stepIndex = state.steps.length - 1;

        renderCurrentStep();
      };

      window.updateSideQuantity = function(variantId, delta) {
        const currentQuantity = state.quantities[variantId] || 0;
        const nextQuantity = Math.max(0, currentQuantity + delta);
        if (nextQuantity === 0) {
          delete state.quantities[variantId];
        } else {
          state.quantities[variantId] = nextQuantity;
        }
        if (state.steps[state.stepIndex]?.key === 'variants') {
          renderVariantsStep(document.getElementById('sideOptions'));
        }
        updateButtons();
      };

      window.adjustSideDipQuantity = function(dipId, delta) {
        const current = state.dips[dipId] || 0;
        const next = Math.max(0, Math.min(10, current + delta));
        if (next === 0) {
          delete state.dips[dipId];
        } else {
          state.dips[dipId] = next;
        }
        renderDipsStep(document.getElementById('sideExtraDips'));
      };

      window.skipSideDips = function() {
        state.dips = {};
        const nextStep = state.steps[state.stepIndex + 1];
        if (nextStep && nextStep.key === 'summary') {
          state.stepIndex += 1;
          renderCurrentStep();
        } else {
          renderDipsStep(document.getElementById('sideExtraDips'));
        }
      };

      window.setSideCustomizationOption = function(optionId) {
        if (!state.config || !state.config.customization) return;
        const key = state.config.customization.stateKey || 'customOption';
        state.customization[key] = optionId;
        renderCustomizationStep(document.getElementById('sideCustomizationContent'));
        updateButtons();
      };

      window.addSideOrderToCart = function() {
        const payload = buildOrderPayload();
        if (!payload.items.length) {
          alert('Please select at least one side before adding to cart.');
          return;
        }
        const submitHandlerName = state.config?.onSubmit;
        if (submitHandlerName && typeof window[submitHandlerName] === 'function') {
          try {
            window[submitHandlerName](payload);
          } catch (error) {
            console.error('Side modal submit handler failed', error);
          }
        } else {
          console.log('Side order payload:', payload);
          alert('Side added to cart! (Demo)');
        }
        closeSidesModal();
      };

      window.continueShopping = function() {
        closeSidesModal();
      };

      window.finishSideOrder = function() {
        addSideOrderToCart();
      };
    })();
  

    
    (function(){
      const FALLBACK_VARIANTS = [{"description":"Golden crispy fries","size":"regular","name":"French Fries","platformPricing":{"doordash":3.71,"ubereats":3.71,"grubhub":3.44},"basePrice":2.75,"id":"fries_regular"},{"basePrice":5.49,"name":"Cheese Fries","platformPricing":{"doordash":7.41,"ubereats":7.41,"grubhub":7.28},"id":"fries_cheese","size":"regular","description":"Golden fries topped with melted cheese"},{"description":"Golden fries with bacon and cheese","basePrice":5.75,"id":"fries_bacon_cheese","platformPricing":{"grubhub":7.19,"doordash":7.76,"ubereats":7.76},"name":"Bacon Cheese Fries","size":"regular"}];
      const DOORDASH_MULTIPLIER = 1.35;

      function toNumber(value, fallback = 0) {
        const parsed = parseFloat(value);
        return Number.isNaN(parsed) ? fallback : parsed;
      }

      function derivePlatformPrice(variant) {
        if (typeof variant.platformPrice === 'number') return variant.platformPrice;
        if (typeof variant.platformPrice === 'string') {
          const parsed = parseFloat(variant.platformPrice);
          if (!Number.isNaN(parsed)) return parsed;
        }
        if (typeof variant.basePrice === 'number') return Number((variant.basePrice * DOORDASH_MULTIPLIER).toFixed(2));
        if (typeof variant.price === 'number') return Number((variant.price * DOORDASH_MULTIPLIER).toFixed(2));
        const parsed = toNumber(variant.basePrice || variant.price, 0);
        return Number((parsed * DOORDASH_MULTIPLIER).toFixed(2));
      }

      function normaliseVariants(rawVariants) {
        if (!Array.isArray(rawVariants)) return [];
        return rawVariants.map((variant, index) => {
          const platformPrice = derivePlatformPrice(variant);
          const subtitle = variant.description || variant.size || '';
          const variantId = variant.id || (variant.name ? variant.name.toLowerCase().replace(/[^a-z0-9]+/g, '-') : 'fries-' + (index + 1));
          return {
            id: variantId,
            name: variant.name || variant.size || 'Fries',
            subtitle,
            platformPrice,
            description: variant.description || ''
          };
        });
      }

      function buildFriesVariants() {
        const firestoreVariants = (strategicMenu.fries && Array.isArray(strategicMenu.fries.variants)) ? strategicMenu.fries.variants : FALLBACK_VARIANTS;
        return normaliseVariants(firestoreVariants);
      }

      window.openFriesModal = function() {
        if (typeof window.openSidesModal !== 'function') {
          console.error('Shared sides modal not loaded.');
          return;
        }

        const variants = buildFriesVariants();
        if (!variants.length) {
          alert('Fries are currently unavailable. Please check back soon.');
          return;
        }

        window.openSidesModal({
          sideKey: 'fries',
          modalTitle: 'Choose Your Fries',
          stepOrder: ['variants', 'dips', 'summary'],
          stepLabels: {
            variants: 'Size',
            dips: 'Dips',
            summary: 'Summary'
          },
          stepTitles: {
            variants: 'Select Your Size',
            dips: 'Extra Dipping Sauces',
            summary: 'Fries Summary'
          },
          summaryHeading: 'Fries Summary',
          variants
        });
      };
    })();
  

    
    (function(){
      const FALLBACK_VARIANTS = [{"basePrice":5.49,"name":"Cheese Fries","platformPricing":{"doordash":7.41,"ubereats":7.41,"grubhub":7.28},"id":"fries_cheese","size":"regular","description":"Golden fries topped with melted cheese"},{"description":"Golden fries with bacon and cheese","basePrice":5.75,"id":"fries_bacon_cheese","platformPricing":{"grubhub":7.19,"doordash":7.76,"ubereats":7.76},"name":"Bacon Cheese Fries","size":"regular"}];
      const CUSTOMIZATION_OPTIONS = [{"id":"on_top","label":"On Top","description":"Cheese sauce and bacon served over the fries for maximum flavor."},{"id":"on_side","label":"On the Side","description":"Toppings served separately to keep fries crisp."}];
      const DOORDASH_MULTIPLIER = 1.35;

      function toNumber(value, fallback = 0) {
        const parsed = parseFloat(value);
        return Number.isNaN(parsed) ? fallback : parsed;
      }

      function derivePlatformPrice(variant) {
        if (typeof variant.platformPrice === 'number') return variant.platformPrice;
        if (typeof variant.platformPrice === 'string') {
          const parsed = parseFloat(variant.platformPrice);
          if (!Number.isNaN(parsed)) return parsed;
        }
        if (typeof variant.basePrice === 'number') return Number((variant.basePrice * DOORDASH_MULTIPLIER).toFixed(2));
        if (typeof variant.price === 'number') return Number((variant.price * DOORDASH_MULTIPLIER).toFixed(2));
        const parsed = toNumber(variant.basePrice || variant.price, 0);
        return Number((parsed * DOORDASH_MULTIPLIER).toFixed(2));
      }

      function normaliseLoadedVariants(rawVariants) {
        if (!Array.isArray(rawVariants)) return [];
        return rawVariants.map((variant, index) => {
          const platformPrice = derivePlatformPrice(variant);
          const variantId = variant.id || (variant.name ? variant.name.toLowerCase().replace(/[^a-z0-9]+/g, '-') : 'loaded-fries-' + (index + 1));
          return {
            id: variantId,
            name: variant.name || 'Loaded Fries',
            subtitle: variant.description || 'Loaded with cheese sauce and toppings',
            platformPrice,
            description: variant.description || ''
          };
        });
      }

      function buildLoadedVariants() {
        const firestoreVariants = (strategicMenu.fries && Array.isArray(strategicMenu.fries.variants))
          ? strategicMenu.fries.variants.filter(variant =>
              /cheese|bacon/i.test(variant.name || '') && !/^french fries$/i.test(variant.name || '')
            )
          : FALLBACK_VARIANTS;
        return normaliseLoadedVariants(firestoreVariants);
      }

      window.openLoadedFriesModal = function() {
        if (typeof window.openSidesModal !== 'function') {
          console.error('Shared sides modal not loaded.');
          return;
        }

        const variants = buildLoadedVariants();
        if (!variants.length) {
          alert('Loaded fries are currently unavailable. Please check back soon.');
          return;
        }

        window.openSidesModal({
          sideKey: 'loaded-fries',
          modalTitle: 'Loaded Fries',
          stepOrder: ['variants', 'customization', 'dips', 'summary'],
          stepLabels: {
            variants: 'Options',
            customization: 'Customize',
            dips: 'Dips',
            summary: 'Summary'
          },
          stepTitles: {
            variants: 'Choose Your Loaded Fries',
            customization: 'How should we serve the toppings?',
            dips: 'Extra Dipping Sauces',
            summary: 'Loaded Fries Summary'
          },
          summaryHeading: 'Loaded Fries Summary',
          customization: {
            enabled: true,
            stateKey: 'toppingsPlacement',
            defaultOption: 'on_top',
            options: CUSTOMIZATION_OPTIONS,
            required: true
          },
          variants
        });
      };
    })();
  

    
    (function(){
      const FALLBACK_VARIANTS = [{"id":"mozzarella_4","name":"4 Mozzarella Sticks","count":4,"basePrice":6.99,"platformPricing":{"doordash":9.44,"ubereats":9.44,"grubhub":8.49},"description":"4 golden mozzarella sticks with marinara sauce"},{"id":"mozzarella_8","name":"8 Mozzarella Sticks","count":8,"basePrice":11.99,"platformPricing":{"doordash":16.19,"ubereats":16.19,"grubhub":14.57},"description":"8 golden mozzarella sticks with marinara sauce"},{"id":"mozzarella_12","name":"12 Mozzarella Sticks","count":12,"basePrice":16.99,"platformPricing":{"doordash":22.94,"ubereats":22.94,"grubhub":20.64},"description":"12 golden mozzarella sticks with marinara sauce"},{"id":"mozzarella_16","name":"16 Mozzarella Sticks","count":16,"basePrice":21.99,"platformPricing":{"doordash":29.69,"ubereats":29.69,"grubhub":26.72},"description":"16 golden mozzarella sticks with marinara sauce"}];
      const DOORDASH_MULTIPLIER = 1.35;

      function derivePlatformPrice(variant) {
        if (typeof variant.platformPrice === 'number') return variant.platformPrice;
        if (typeof variant.platformPrice === 'string') {
          const parsed = parseFloat(variant.platformPrice);
          if (!Number.isNaN(parsed)) return parsed;
        }
        if (typeof variant.basePrice === 'number') return Number((variant.basePrice * DOORDASH_MULTIPLIER).toFixed(2));
        if (typeof variant.price === 'number') return Number((variant.price * DOORDASH_MULTIPLIER).toFixed(2));
        const parsed = parseFloat(variant.basePrice || variant.price || 0);
        if (Number.isNaN(parsed)) return 0;
        return Number((parsed * DOORDASH_MULTIPLIER).toFixed(2));
      }

      function normaliseMozzarellaVariants(rawVariants) {
        if (!Array.isArray(rawVariants)) return [];
        return rawVariants.map((variant, index) => {
          const platformPrice = derivePlatformPrice(variant);
          const countLabel = variant.count ? variant.count + ' Sticks' : '';
          const variantId = variant.id || ('mozzarella-' + (index + 1));
          return {
            id: variantId,
            name: variant.name || (countLabel || 'Mozzarella Sticks'),
            subtitle: variant.description || countLabel,
            platformPrice,
            description: variant.description || ''
          };
        });
      }

      function buildMozzarellaVariants() {
        const firestoreVariants = (strategicMenu.mozzarella && Array.isArray(strategicMenu.mozzarella.variants))
          ? strategicMenu.mozzarella.variants
          : FALLBACK_VARIANTS;
        return normaliseMozzarellaVariants(firestoreVariants);
      }

      window.openMozzarellaModal = function() {
        if (typeof window.openSidesModal !== 'function') {
          console.error('Shared sides modal not loaded.');
          return;
        }

        const variants = buildMozzarellaVariants();
        if (!variants.length) {
          alert('Mozzarella sticks are currently unavailable. Please check back soon.');
          return;
        }

        window.openSidesModal({
          sideKey: 'mozzarella',
          modalTitle: 'Mozzarella Sticks',
          stepOrder: ['variants', 'dips', 'summary'],
          stepLabels: {
            variants: 'Quantity',
            dips: 'Dips',
            summary: 'Summary'
          },
          stepTitles: {
            variants: 'Choose Your Quantity',
            dips: 'Add Extra Dipping Sauces',
            summary: 'Mozzarella Summary'
          },
          summaryHeading: 'Mozzarella Summary',
          variants
        });
      };
    })();
  

    // ==============================================
    // BEVERAGE MODAL MODULE
    // ==============================================
    
    const BEVERAGE_PLATFORM_KEY = 'doordash';
    let beverageModalStep = 1;
    let currentBeverageVariant = null;
    let availableBeverageSizes = [];
    let availableBeverageFlavors = [];
    let selectedBeverageSize = null;
    let selectedBeverageFlavor = null;

    function resolvePrice(entry) {
      if (!entry) return 0;
      const pricing = entry.platformPricing || {};
      const platformValue = pricing[BEVERAGE_PLATFORM_KEY];
      const numericPlatform = typeof platformValue === 'number' ? platformValue : parseFloat(platformValue);
      if (!Number.isNaN(numericPlatform) && numericPlatform > 0) {
        return parseFloat(numericPlatform.toFixed(2));
      }
      if (typeof entry.platformPrice === 'number') {
        return parseFloat(entry.platformPrice.toFixed(2));
      }
      const parsedPlatform = parseFloat(entry.platformPrice);
      if (!Number.isNaN(parsedPlatform) && parsedPlatform > 0) {
        return parseFloat(parsedPlatform.toFixed(2));
      }
      if (typeof entry.basePrice === 'number') {
        return parseFloat(entry.basePrice.toFixed(2));
      }
      const parsedBase = parseFloat(entry.basePrice);
      if (!Number.isNaN(parsedBase) && parsedBase > 0) {
        return parseFloat(parsedBase.toFixed(2));
      }
      return 0;
    }

    function formatBeveragePrice(value) {
      const numeric = typeof value === 'number' ? value : parseFloat(value);
      if (Number.isNaN(numeric) || !Number.isFinite(numeric)) {
        return '0.00';
      }
      return numeric.toFixed(2);
    }

    function deriveBeverageSizes(variant) {
      if (!variant) return [];
      if (Array.isArray(variant.sizes) && variant.sizes.length > 0) {
        return variant.sizes.map((size, index) => ({
          ...size,
          id: size.id || ((variant.id || 'beverage') + '_size_' + index),
          label: size.name || size.label || size.size || ('Size ' + (index + 1)),
          description: size.description || variant.description || '',
          platformPrice: resolvePrice(size),
          basePrice: typeof size.basePrice === 'number' ? size.basePrice : parseFloat(size.basePrice || variant.basePrice || 0)
        }));
      }

      const fallbackBase = typeof variant.basePrice === 'number' ? variant.basePrice : parseFloat(variant.basePrice || variant.price || 0) || 0;

      return [{
        id: variant.id || 'beverage_default_size',
        label: variant.size || variant.name || 'Standard',
        description: variant.description || '',
        platformPrice: resolvePrice(variant),
        basePrice: fallbackBase
      }];
    }

    function deriveBeverageFlavors(variant) {
      if (!variant || !Array.isArray(variant.flavors)) return [];
      return variant.flavors.map((flavor, index) => {
        if (typeof flavor === 'string') {
          return {
            id: (variant.id || 'beverage') + '_flavor_' + index,
            name: flavor,
            description: ''
          };
        }
        return {
          id: flavor.id || flavor.value || (variant.id || 'beverage') + '_flavor_' + index,
          name: flavor.name || flavor.label || ('Flavor ' + (index + 1)),
          description: flavor.description || flavor.subtext || ''
        };
      }).filter(flavor => flavor.name);
    }

    function hasFlavorStep() {
      return availableBeverageFlavors.length > 0;
    }

    window.openBeverageModal = function(beverageVariant) {
      console.log('Opening beverage modal with data:', beverageVariant);

      currentBeverageVariant = beverageVariant || null;
      availableBeverageSizes = deriveBeverageSizes(currentBeverageVariant);
      availableBeverageFlavors = deriveBeverageFlavors(currentBeverageVariant);
      selectedBeverageSize = null;
      selectedBeverageFlavor = null;
      beverageModalStep = 1;

      const modal = document.getElementById('beverageModal');
      const modalTitle = document.getElementById('beverageModalTitle');
      const flavorStep = document.getElementById('beverageModalStep2');

      if (flavorStep) {
        flavorStep.style.display = hasFlavorStep() ? 'block' : 'none';
      }

      if (modalTitle) {
        modalTitle.textContent = beverageVariant?.name || 'Choose Your Beverage';
      }

      populateBeverageSizes();
      populateBeverageFlavors();
      updateBeverageModalDisplay();

      if (modal) {
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
      }
    };

    window.closeBeverageModal = function() {
      const modal = document.getElementById('beverageModal');
      if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
      }

      currentBeverageVariant = null;
      availableBeverageSizes = [];
      availableBeverageFlavors = [];
      selectedBeverageSize = null;
      selectedBeverageFlavor = null;
      beverageModalStep = 1;

      const sizeContainer = document.getElementById('beverageSizeOptions');
      const flavorContainer = document.getElementById('beverageFlavorOptions');
      const summaryContainer = document.getElementById('beverageOrderSummary');
      if (sizeContainer) sizeContainer.innerHTML = '';
      if (flavorContainer) flavorContainer.innerHTML = '';
      if (summaryContainer) summaryContainer.innerHTML = '';
    };

    window.navigateBeverageModalStep = function(direction) {
      if (direction === 1) {
        if (!selectedBeverageSize) {
          alert('Please select a size to continue.');
          return;
        }

        if (beverageModalStep === 1) {
          if (hasFlavorStep()) {
            beverageModalStep = 2;
            populateBeverageFlavors();
          } else {
            beverageModalStep = 3;
            populateBeverageOrderSummary();
          }
        } else if (beverageModalStep === 2) {
          if (!selectedBeverageFlavor) {
            alert('Please pick a flavor to continue.');
            return;
          }
          beverageModalStep = 3;
          populateBeverageOrderSummary();
        }
      } else if (direction === -1) {
        if (beverageModalStep === 3) {
          beverageModalStep = hasFlavorStep() ? 2 : 1;
          if (beverageModalStep === 2) {
            populateBeverageFlavors();
          }
        } else if (beverageModalStep === 2) {
          beverageModalStep = 1;
        }
      }

      if (beverageModalStep === 1) {
        populateBeverageSizes();
      }

      if (beverageModalStep === 3) {
        populateBeverageOrderSummary();
      }

      updateBeverageModalDisplay();
    };

    window.selectBeverageSize = function(index) {
      const option = availableBeverageSizes[index];
      if (!option) return;

      selectedBeverageSize = option;
      populateBeverageSizes();
      updateBeverageModalDisplay();
    };

    window.selectBeverageFlavor = function(index) {
      const flavor = availableBeverageFlavors[index];
      if (!flavor) return;

      selectedBeverageFlavor = flavor;
      populateBeverageFlavors();
      updateBeverageModalDisplay();
    };

    function populateBeverageSizes() {
      const container = document.getElementById('beverageSizeOptions');
      if (!container) return;

      if (!availableBeverageSizes.length) {
        container.innerHTML = '<p class="beverage-empty-state">No size options available right now.</p>';
        return;
      }

      container.innerHTML = availableBeverageSizes.map((option, index) => {
        const isSelected = selectedBeverageSize && selectedBeverageSize.id === option.id;
        const description = option.description || currentBeverageVariant?.description || '';
        return '<div class="beverage-size-card' + (isSelected ? ' selected' : '') + '" onclick="selectBeverageSize(' + index + ')">' +
                 '<div class="beverage-size-info">' +
                   '<h4>' + option.label + '</h4>' +
                   (description ? '<p>' + description + '</p>' : '') +
                   '<div class="beverage-size-price">$' + formatBeveragePrice(option.platformPrice ?? option.basePrice) + '</div>' +
                 '</div>' +
               '</div>';
      }).join('');
    }

    function populateBeverageFlavors() {
      const container = document.getElementById('beverageFlavorOptions');
      if (!container) return;

      if (!hasFlavorStep()) {
        container.innerHTML = '';
        return;
      }

      container.innerHTML = availableBeverageFlavors.map((flavor, index) => {
        const isSelected = selectedBeverageFlavor && selectedBeverageFlavor.id === flavor.id;
        return '<div class="beverage-flavor-card' + (isSelected ? ' selected' : '') + '" onclick="selectBeverageFlavor(' + index + ')">' +
                 '<div class="beverage-flavor-info">' +
                   '<h4>' + flavor.name + '</h4>' +
                   (flavor.description ? '<p>' + flavor.description + '</p>' : '') +
                 '</div>' +
               '</div>';
      }).join('');
    }

    function populateBeverageOrderSummary() {
      const container = document.getElementById('beverageOrderSummary');
      if (!container) return;

      if (!selectedBeverageSize) {
        container.innerHTML = '<p>Please pick a size to view the summary.</p>';
        return;
      }

      const price = resolvePrice(selectedBeverageSize) || resolvePrice(currentBeverageVariant);

      container.innerHTML = '<div class="beverage-summary">' +
        '<h3>' + (currentBeverageVariant?.name || 'Selected Beverage') + '</h3>' +
        '<p>Size: ' + (selectedBeverageSize.label || selectedBeverageSize.name || 'Standard') + '</p>' +
        (selectedBeverageFlavor ? '<p>Flavor: ' + selectedBeverageFlavor.name + '</p>' : '') +
        '<div class="beverage-summary-price">$' + formatBeveragePrice(price) + '</div>' +
      '</div>';
    }

    function updateBeverageModalDisplay() {
      const progressSteps = document.querySelectorAll('#beverageModal .progress-step');
      progressSteps.forEach((step, index) => {
        const stepNumber = index + 1;
        if (stepNumber === 2 && !hasFlavorStep()) {
          step.style.display = 'none';
          return;
        }

        step.style.display = 'flex';
        step.classList.remove('active', 'completed');
        if (stepNumber < beverageModalStep) {
          step.classList.add('completed');
        }
        if (stepNumber === beverageModalStep) {
          step.classList.add('active');
        }
      });

      for (let i = 1; i <= 3; i++) {
        const step = document.getElementById('beverageModalStep' + i);
        if (!step) continue;

        if (i === 2 && !hasFlavorStep()) {
          step.classList.remove('active');
          step.style.display = 'none';
        } else {
          step.style.display = 'block';
          step.classList.toggle('active', i === beverageModalStep);
        }
      }

      const backBtn = document.getElementById('beverageModalBackBtn');
      const nextBtn = document.getElementById('beverageModalNextBtn');
      const addBtn = document.getElementById('beverageModalAddToCartBtn');

      if (backBtn) {
        backBtn.style.display = beverageModalStep > 1 ? 'inline-block' : 'none';
      }

      if (nextBtn) {
        if (beverageModalStep < 3) {
          nextBtn.style.display = 'inline-block';
          if (beverageModalStep === 1) {
            nextBtn.disabled = !selectedBeverageSize;
          } else if (beverageModalStep === 2) {
            nextBtn.disabled = !selectedBeverageFlavor;
          } else {
            nextBtn.disabled = false;
          }
        } else {
          nextBtn.style.display = 'none';
          nextBtn.disabled = false;
        }
      }

      if (addBtn) {
        addBtn.style.display = beverageModalStep === 3 ? 'inline-block' : 'none';
        addBtn.disabled = !selectedBeverageSize;
      }
    }

    window.addBeverageOrderToCart = function() {
      if (!selectedBeverageSize) {
        alert('Please select a size before adding to cart.');
        return;
      }

      const payload = {
        beverageId: currentBeverageVariant?.id,
        beverageName: currentBeverageVariant?.name,
        sizeId: selectedBeverageSize.id,
        sizeName: selectedBeverageSize.label || selectedBeverageSize.name,
        flavorId: selectedBeverageFlavor?.id || null,
        flavorName: selectedBeverageFlavor?.name || null,
        price: formatBeveragePrice(resolvePrice(selectedBeverageSize) || resolvePrice(currentBeverageVariant))
      };

      console.log('Adding beverage to cart:', payload);

      alert('Added to cart: ' + payload.beverageName + (payload.sizeName ? ' (' + payload.sizeName + ')' : '') + (payload.flavorName ? ' - ' + payload.flavorName : '') + ' — $' + payload.price);

      window.closeBeverageModal();
    };
  

    // ==============================================
    // WINGS MODAL MODULE (Existing)
    // ==============================================
    
    // ==============================================
    // WINGS MODAL FUNCTIONS - COMPLETE IMPLEMENTATION
    // ==============================================

    // Wings Modal State Variables
    let currentWingType = '';
    let selectedWingVariant = null;
    let selectedSauces = [];
    let selectedWingStyle = 'regular';
    let selectedIncludedDips = {};
    let selectedExtraDips = {};
    let saucePreferences = {};
    let noSauceSelected = false;
    let modalWingsData = [];
    let currentModalStep = 1;
    let wingAllocation = {}; // { sauceId: wingCount }

    // Main Wings Modal Functions
    window.openWingModal = function(wingType, wingsData) {
      currentWingType = wingType;
      console.log('openWingModal called with type:', wingType);

      // Generate wing data if not provided
      if (!wingsData) {
        modalWingsData = generateWingVariants(wingType);
      } else {
        modalWingsData = wingsData;
      }

      // Get or create modal
      let modal = document.getElementById('wingModal');
      if (!modal) {
        console.error('Wing modal not found in DOM');
        return;
      }

      // Reset selections
      selectedWingVariant = null;
      selectedSauces = [];
      selectedWingStyle = 'regular';
      selectedIncludedDips = {};
      selectedExtraDips = {};
      saucePreferences = {};
      noSauceSelected = false;
      wingAllocation = {};

      // Show modal
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';

      // Reset to step 1
      currentModalStep = 1;
      // Ensure layout matches current wing type BEFORE first display (hides step 6 for boneless)
      try { updateModalStepLayout(); } catch (e) { /* no-op */ }
      updateModalDisplay();
      populateWingVariants();
    };

    window.closeWingModal = function() {
      const modal = document.getElementById('wingModal');
      if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
      }
    };

    window.navigateModalStep = function(direction) {
      // Validation logic for moving forward
      if (direction === 1) {
        if (currentModalStep === 1 && !selectedWingVariant) {
          alert('Please select a wing size first');
          return;
        }
        if (currentModalStep === 2 && selectedSauces.length === 0) {
          alert('Please select at least one sauce');
          return;
        }
      }

      // Update step with smart navigation for "No Dip" selection
      currentModalStep += direction;

      // Do not skip extra dips based on "No Dip"; "No Dip" applies only to included dips

      // Bounds checking
      if (currentModalStep < 1) currentModalStep = 1;
      const maxSteps = currentWingType === 'bone-in' ? 6 : 5;
      if (currentModalStep > maxSteps) currentModalStep = maxSteps;

      updateModalDisplay();
      loadStepContent();
    };

    function updateModalDisplay() {
      // Update progress indicators
      document.querySelectorAll('.progress-step').forEach((step, index) => {
        step.classList.remove('active', 'completed');
        if (index < currentModalStep - 1) {
          step.classList.add('completed');
        } else if (index === currentModalStep - 1) {
          step.classList.add('active');
        }
      });

      // Show current step
      document.querySelectorAll('.modal-step').forEach((step, index) => {
        step.classList.remove('active');
        if (index === currentModalStep - 1) {
          step.classList.add('active');
        }
      });

      // CRITICAL: Clear order summary from non-final steps to prevent early appearance
      const isFinalStep = (currentWingType === 'boneless' && currentModalStep === 5) ||
                         (currentWingType === 'bone-in' && currentModalStep === 6);

      if (!isFinalStep) {
        // Clear any order summary content that might exist in other steps
        document.querySelectorAll('#orderSummary').forEach(container => {
          if (container && !container.closest('.modal-step.active')) {
            container.innerHTML = '';
          }
        });
      }

      updateModalButtons();
    }

    function loadStepContent() {
      // Update step layout based on wing type
      updateModalStepLayout();

      // Only populate content for the current step
      switch(currentModalStep) {
        case 1:
          populateWingVariants();
          break;
        case 2:
          populateSauceSelection();
          break;
        case 3:
          populateIncludedDipSelection();
          break;
        case 4:
          if (currentWingType === 'bone-in') {
            populateWingStyleSelection();
          } else {
            populateExtraDipSelection();
          }
          break;
        case 5:
          if (currentWingType === 'bone-in') {
            populateExtraDipSelection();
          } else {
            populateOrderSummary();
          }
          break;
        case 6:
          populateOrderSummary();
          break;
      }
    }

    function updateModalStepLayout() {
      // Update step titles and visibility based on wing type and current step
      if (currentWingType === 'boneless') {
        // Boneless wings: 5 steps total (no wing style)
        document.getElementById('step3Title').textContent = 'Choose Included Dips';
        document.getElementById('step4Title').textContent = 'Extra Dips (Optional)';
        document.getElementById('step5Title').textContent = 'Order Summary';

        // Hide step 6 and its progress indicator for boneless
        const step6Progress = document.querySelector('[data-step="6"]');
        const step6Modal = document.getElementById('modalStep6');
        if (step6Progress) step6Progress.style.display = 'none';
        if (step6Modal) step6Modal.style.display = 'none';
      } else {
        // Bone-in wings: 6 steps total (includes wing style)
        document.getElementById('step3Title').textContent = 'Choose Included Dips';
        document.getElementById('step4Title').textContent = 'Wing Style Preference';
        document.getElementById('step5Title').textContent = 'Extra Dips (Optional)';
        document.getElementById('step6Title').textContent = 'Order Summary';

        // Show step 6 and its progress indicator for bone-in
        const step6Progress = document.querySelector('[data-step="6"]');
        const step6Modal = document.getElementById('modalStep6');
        if (step6Progress) step6Progress.style.display = 'flex';
        if (step6Modal) step6Modal.style.display = 'block';
      }
    }

    // Step Content Population Functions
    function populateWingVariants() {
      const container = document.getElementById('wingVariants');
      if (!container) return;

      container.innerHTML = modalWingsData.map(variant =>
        '<div class="wing-variant-card ' + (selectedWingVariant && selectedWingVariant.id === variant.id ? 'selected' : '') + '" onclick="selectWingVariant(\'' + variant.id + '\');">' +
          '<div class="wing-variant-info">' +
            '<h4>' + variant.count + ' Wings</h4>' +
            '<p>' + variant.description + '</p>' +
            '<div class="wing-variant-price">$' + variant.platformPrice + '</div>' +
          '</div>' +
        '</div>'
      ).join('');

      updateModalButtons();
    }

    window.selectWingVariant = function(variantId) {
      selectedWingVariant = modalWingsData.find(variant => variant.id === variantId);

      // Re-render to show selection
      populateWingVariants();
      updateModalButtons();
    };

    function populateOrderSummary() {
      console.log('🔍 populateOrderSummary called - currentModalStep:', currentModalStep, 'currentWingType:', currentWingType);
      if (!selectedWingVariant) return;

      // CRITICAL: Only populate order summary if we're on the correct final step
      const isFinalStep = (currentWingType === 'boneless' && currentModalStep === 5) ||
                         (currentWingType === 'bone-in' && currentModalStep === 6);

      if (!isFinalStep) {
        console.log('⚠️ populateOrderSummary called on wrong step - ignoring');
        return;
      }

      const wingStyleUpcharge = (currentWingType === 'bone-in' && selectedWingStyle !== 'regular') ? 1.50 : 0;
      const extraDipsTotal = Object.values(selectedExtraDips).reduce((sum, qty) => sum + (qty * 0.75), 0);
      const totalPrice = selectedWingVariant.platformPrice + wingStyleUpcharge + extraDipsTotal;

      // Build summary helpers for dips and labels
      const allSauces = strategicMenu.sauces || firestoreSauces || [];
      const dipCatalog = allSauces.filter(s => s.category === 'dipping-sauce');
      function dipNameById(id) {
        const d = dipCatalog.find(x => x.id === id);
        if (d && d.name) return d.name;
        return (id || '').replace(/[-_]/g, ' ').replace(/w/g, c => c.toUpperCase());
      }
      const maxIncludedDips = Math.max(1, Math.floor(selectedWingVariant.count / 6));
      const noDipChosen = selectedIncludedDips['no-dip'] > 0;
      const includedDipEntries = Object.entries(selectedIncludedDips).filter(([id, qty]) => id !== 'no-dip' && qty > 0);
      const includedDipsHtml = noDipChosen ? '<div style="padding-left: 16px; font-size: 14px; color: #666;">• No dips selected</div>' : (includedDipEntries.length ? includedDipEntries.map(([id, qty]) => '<div style="padding-left: 16px; font-size: 14px; color: #666;">• ' + qty + 'x ' + dipNameById(id) + '</div>').join('') : '');
      const extraDipEntries = Object.entries(selectedExtraDips || {});
      const extraDipsHtml = extraDipEntries.length ? extraDipEntries.map(([id, qty]) => '<div style="padding-left: 16px; font-size: 14px; color: #666;">• ' + qty + 'x ' + dipNameById(id) + ' ($0.75 each)</div>').join('') : '';
      let wingStyleLabel = 'Regular Mix';
      if (currentWingType === 'bone-in') { if (selectedWingStyle === 'all-drums') wingStyleLabel = 'All Drums'; else if (selectedWingStyle === 'all-flats') wingStyleLabel = 'All Flats'; }

      // Find or create a summary container in the active step, and hide any stray extra-dips container
      const activeStep = document.querySelector('.modal-step.active');
      let container = null;
      if (activeStep) {
        const strayExtra = activeStep.querySelector('#extraDipOptions');
        if (strayExtra) { strayExtra.innerHTML = ''; strayExtra.style.display = 'none'; }
        container = activeStep.querySelector('#orderSummary');
        if (!container) {
          container = document.createElement('div');
          container.id = 'orderSummary';
          container.className = 'order-summary';
          activeStep.appendChild(container);
        }
      }
      if (!container) return;

      container.innerHTML =
        '<div style="text-align: left; font-size: 16px; line-height: 1.6;">' +
          '<h4 style="margin-bottom: 16px; color: #1a1a1a; font-size: 20px;">' + selectedWingVariant.count + ' ' + (currentWingType === 'boneless' ? 'Boneless' : 'Bone-In') + ' Wings</h4>' +
          '<div style="background: #f8f9fa; padding: 16px; border-radius: 8px; margin-bottom: 16px;">' +
            '<p style="margin-bottom: 8px; color: #666; display: flex; justify-content: space-between;"><span>Base Price:</span><span>$' + selectedWingVariant.platformPrice.toFixed(2) + '</span></p>' +
            // Generate detailed sauce list with wing allocation
            (selectedSauces.length > 0 ?
              '<div style="margin-bottom: 8px; color: #666;">' +
                '<div style="font-weight: bold; margin-bottom: 4px;">Sauces (' + selectedSauces.length + ' included):</div>' +
                selectedSauces.map(sauceId => {
                  const sauce = (strategicMenu.sauces || firestoreSauces || []).find(s => s.id === sauceId);
                  const isOnSide = saucePreferences[sauceId] && saucePreferences[sauceId].onSide;
                  const sauceName = sauce ? sauce.name : sauceId;

                  let allocation;
                  if (selectedSauces.length === 1) {
                    allocation = selectedWingVariant.count;
                  } else {
                    allocation = wingAllocation[sauceId] || Math.floor(selectedWingVariant.count / selectedSauces.length);
                  }

                  return '<div style="padding-left: 16px; font-size: 14px; color: #666;">' +
                    '• ' + allocation + ' wings with ' + sauceName +
                    (isOnSide ? ' (on the side)' : '') +
                  '</div>';
                }).join('') +
                '<div style="padding-left: 16px; font-size: 14px; color: #333; font-weight: bold; margin-top: 8px; border-top: 1px solid #ddd; padding-top: 8px;">Total Wings: ' + selectedWingVariant.count + '</div>' +
              '</div>'
            : '') +
            // Wing style label (informational)
            (currentWingType === 'bone-in' ?
              '<p style="margin-bottom: 8px; color: #666; display: flex; justify-content: space-between;"><span>Wing Style: ' + wingStyleLabel + '</span>' + (wingStyleUpcharge > 0 ? '<span>+$' + wingStyleUpcharge.toFixed(2) + '</span>' : '<span>Included</span>') + '</p>'
            : '') +
            // Included dips confirmation
            '<div style="margin-bottom: 8px; color: #666;">' +
              '<div style="font-weight: bold; margin-bottom: 4px;">Included Dips (' + (noDipChosen ? 0 : includedDipEntries.reduce((s, [,q]) => s+q, 0)) + ' of ' + maxIncludedDips + '):</div>' +
              (includedDipsHtml || '<div style="padding-left: 16px; font-size: 14px; color: #666;">• None selected</div>') +
            '</div>' +
            // Extra dips pretty names confirmation
            (extraDipEntries.length > 0 ?
              '<div style="margin-bottom: 8px; color: #666;">' +
                '<div style="font-weight: bold; margin-bottom: 4px;">Extra Dips:</div>' +
                extraDipsHtml +
              '</div>' : '') +
          '</div>' +
          '<div style="font-size: 18px; font-weight: bold; color: #ff6b35; text-align: center; padding: 16px; background: white; border: 2px solid #ff6b35; border-radius: 8px;">Total: $' + totalPrice.toFixed(2) + '</div>' +
        '</div>';
    }

    function updateModalButtons() {
      const backBtn = document.getElementById('modalBackBtn');
      const nextBtn = document.getElementById('modalNextBtn');
      const addBtn = document.getElementById('modalAddToCartBtn');

      // Back button visibility
      if (backBtn) backBtn.style.display = currentModalStep > 1 ? 'block' : 'none';

      // Next/Add button logic
      const maxSteps = currentWingType === 'boneless' ? 5 : 6;
      const isLastStep = currentModalStep === maxSteps;

      if (nextBtn) {
        nextBtn.style.display = isLastStep ? 'none' : 'block';

        // Enhanced validation logic for each step
        if (currentModalStep === 1) {
          nextBtn.disabled = !selectedWingVariant;
        } else if (currentModalStep === 2) {
          // Step 2: Sauce selection with wing allocation validation
          const isValid = validateSauceAllocation();
          nextBtn.disabled = !isValid;

          // Update visual feedback for wing allocation
          updateWingAllocationFeedback();
        } else {
          nextBtn.disabled = false;
        }
      }

      if (addBtn) addBtn.style.display = isLastStep ? 'block' : 'none';
    }

    // Step 4: Enhanced validation for wing allocation
    function validateSauceAllocation() {
      if (noSauceSelected) return true;
      // Must have at least one sauce selected
      if (selectedSauces.length === 0) return false;

      // For single sauce or orders < 12 wings, no allocation needed
      if (selectedSauces.length === 1 || !selectedWingVariant || selectedWingVariant.count < 12) {
        return true;
      }

      // For multiple sauces with 12+ wings, validate allocation in 6-wing units
      const total = selectedWingVariant.count;
      const step = 6;
      // All allocations must be multiples of 6 and >= 6
      for (const sid of selectedSauces) {
        const val = wingAllocation[sid] || 0;
        if (val % step !== 0) return false;
        if (val < step) return false;
      }
      const allocated = selectedSauces.reduce((s, sid) => s + (wingAllocation[sid] || 0), 0);
      return allocated === total;
    }

    // Complete sauce selection implementation
    function populateSauceSelection() {
      // Use real Firestore sauce data (loaded in global variables)
      const sauces = strategicMenu.sauces || firestoreSauces || [];

      const maxSauces = selectedWingVariant ? selectedWingVariant.includedSauces : 1;
      const container = document.getElementById('sauceOptions');
      if (!container) return;

      // Separate sauces by category (exclude dipping sauces)
      const wetSauces = sauces.filter(s => s.category === 'signature-sauce')
        .sort((a, b) => (a.heatLevel || 1) - (b.heatLevel || 1));
      const dryRubs = sauces.filter(s => s.category === 'dry-rub')
        .sort((a, b) => (a.heatLevel || 1) - (b.heatLevel || 1));

      // Build allocation helper header (for 12+ wings, multiple sauces)
      const needsAllocation = !noSauceSelected && selectedWingVariant && selectedWingVariant.count >= 12 && selectedSauces.length > 1;
      const total = selectedWingVariant ? selectedWingVariant.count : 0;
      const allocated = selectedSauces.reduce((s, sid) => s + (wingAllocation[sid] || 0), 0);
      const remaining = Math.max(0, total - allocated);

      // No Sauce quick toggle UI
      const noSauceBtn = '<button onclick="toggleNoSauce()" style="margin:0 0 8px 0; padding:8px 12px; border:1px solid ' + (noSauceSelected ? '#ff6b35' : '#ddd') + '; background:' + (noSauceSelected ? '#ff6b35' : 'white') + '; color:' + (noSauceSelected ? 'white' : '#444') + '; border-radius:6px; font-size:12px;">' + (noSauceSelected ? '✓ No Sauce Selected' : 'No Sauce') + '</button>';

      container.innerHTML =
        '<div style="margin-bottom: 12px; text-align: center; color: #666; font-size: 14px;">Select up to ' + maxSauces + ' sauce' + (maxSauces > 1 ? 's' : '') + ' (included in price)</div>' +
        '<div style="display:flex; justify-content:center;">' + noSauceBtn + '</div>' +
        (needsAllocation ? (
          '<div data-allocation-helper style="display:flex; align-items:center; justify-content:space-between; gap:12px; background:#fff7f3; border:1px solid #ffd5c6; color:#8a4500; padding:8px 12px; border-radius:8px; margin-bottom:12px;">' +
            '<div style="font-size:13px;">Remaining to allocate: <strong>' + remaining + '</strong> of ' + total + ' wings</div>' +
            '<div style="display:flex; gap:8px;">' +
              '<button onclick="equalSplitWings()" style="padding:6px 10px; border:1px solid #ff6b35; background:#ff6b35; color:white; border-radius:6px; font-size:12px; cursor:pointer;">Equal Split</button>' +
              '<button onclick="clearWingAllocations()" style="padding:6px 10px; border:1px solid #ddd; background:white; color:#444; border-radius:6px; font-size:12px; cursor:pointer;">Clear</button>' +
            '</div>' +
          '</div>'
        ) : '') +

        // Two-column layout for sauces
        '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px;">' +

          // Left Column: Dry Rubs
          '<div>' +
            '<h4 style="margin: 0 0 12px 0; color: #1a1a1a; font-size: 16px; font-weight: bold; border-bottom: 2px solid #ff6b35; padding-bottom: 6px;">🧄 Dry Rubs</h4>' +
            dryRubs.map(sauce => {
              const isSelected = selectedSauces.includes(sauce.id);
              const isOnSide = saucePreferences[sauce.id] && saucePreferences[sauce.id].onSide;
              const isDryRub = sauce.isDryRub || sauce.category === 'dry-rub';
              const heatLevel = sauce.heatLevel || 1;
              const heatDisplay = heatLevel <= 1 ? 'Mild' : heatLevel <= 2 ? 'Medium' : heatLevel <= 3 ? 'Hot' : 'Extra Hot';
              const heatColor = heatLevel <= 1 ? '#00b887' : heatLevel <= 2 ? '#ff9500' : heatLevel <= 3 ? '#ff6b35' : '#ff3333';
              const heatEmoji = heatLevel <= 1 ? '🚫🌶️' : '🌶️'.repeat(heatLevel);

              return '<div class="sauce-option" onclick="toggleSauceSelection(\'' + sauce.id + '\')" style="display: flex; flex-direction: column; padding: 12px; border: 2px solid ' + (isSelected ? '#ff6b35' : '#e0e0e0') + '; border-radius: 10px; margin-bottom: 10px; cursor: pointer; background: ' + (isSelected ? '#fff5f2' : 'white') + '; transition: all 0.3s ease;">' +
                '<div style="display: flex; align-items: center; justify-content: space-between;">' +
                  '<div style="flex: 1;">' +
                    '<h5 style="margin: 0 0 3px 0; color: #1a1a1a; font-size: 14px; font-weight: bold;">' + sauce.name + '</h5>' +
                    '<p style="margin: 0 0 3px 0; color: #666; font-size: 12px; line-height: 1.2;">' + sauce.description + '</p>' +
                    '<div style="display: flex; align-items: center; gap: 6px;">' +
                      '<span style="font-size: 10px; color: ' + heatColor + '; font-weight: bold;">' + heatEmoji + ' ' + heatDisplay + '</span>' +
                    '</div>' +
                  '</div>' +
                  '<div style="width: 20px; height: 20px; border: 2px solid ' + (isSelected ? '#ff6b35' : '#ddd') + '; border-radius: 50%; background: ' + (isSelected ? '#ff6b35' : 'white') + '; display: flex; align-items: center; justify-content: center;">' +
                    (isSelected ? '<span style="color: white; font-size: 12px; font-weight: bold;">✓</span>' : '') +
                  '</div>' +
                '</div>' +
                // Wing allocation controls for 12+ wing orders with multiple sauces
                (isSelected && selectedWingVariant && selectedWingVariant.count >= 12 && selectedSauces.length > 1 ?
                  '<div style="margin-top: 6px; padding-top: 6px; border-top: 1px solid #eee;">' +
                    '<div style="display: flex; align-items: center; justify-content: space-between; font-size: 11px; color: #888;">' +
                      '<span>Wing count:</span>' +
                      '<div style="display: flex; align-items: center; gap: 8px;">' +
                        '<button onclick="event.stopPropagation(); adjustWingAllocation(\'' + sauce.id + '\', -1);" style="width: 20px; height: 20px; border: 1px solid #ddd; background: white; border-radius: 3px; font-size: 12px; color: #666; cursor: pointer;">-</button>' +
                        '<span style="min-width: 20px; text-align: center; font-weight: bold;">' + ((wingAllocation[sauce.id] != null ? wingAllocation[sauce.id] : (Math.floor((selectedWingVariant.count/6) / selectedSauces.length) * 6))) + '</span>' +
                        '<button onclick="event.stopPropagation(); adjustWingAllocation(\'' + sauce.id + '\', 1);" style="width: 20px; height: 20px; border: 1px solid #ddd; background: white; border-radius: 3px; font-size: 12px; color: #666; cursor: pointer;">+</button>' +
                      '</div>' +
                    '</div>' +
                  '</div>'
                  : '') +
              '</div>';
            }).join('') +
          '</div>' +

          // Right Column: Signature Sauces
          '<div>' +
            '<h4 style="margin: 0 0 12px 0; color: #1a1a1a; font-size: 16px; font-weight: bold; border-bottom: 2px solid #ff6b35; padding-bottom: 6px;">🌶️ Signature Sauces</h4>' +
            wetSauces.map(sauce => {
              const isSelected = selectedSauces.includes(sauce.id);
              const isOnSide = saucePreferences[sauce.id] && saucePreferences[sauce.id].onSide;
              const isDryRub = sauce.isDryRub || sauce.category === 'dry-rub';
              const heatLevel = sauce.heatLevel || 1;
              const heatDisplay = heatLevel <= 1 ? 'Mild' : heatLevel <= 2 ? 'Medium' : heatLevel <= 3 ? 'Hot' : 'Extra Hot';
              const heatColor = heatLevel <= 1 ? '#00b887' : heatLevel <= 2 ? '#ff9500' : heatLevel <= 3 ? '#ff6b35' : '#ff3333';
              const heatEmoji = heatLevel <= 1 ? '🚫🌶️' : '🌶️'.repeat(heatLevel);

              return '<div class="sauce-option" onclick="toggleSauceSelection(\'' + sauce.id + '\')" style="display: flex; flex-direction: column; padding: 12px; border: 2px solid ' + (isSelected ? '#ff6b35' : '#e0e0e0') + '; border-radius: 10px; margin-bottom: 10px; cursor: pointer; background: ' + (isSelected ? '#fff5f2' : 'white') + '; transition: all 0.3s ease;">' +
                '<div style="display: flex; align-items: center; justify-content: space-between;">' +
                  '<div style="flex: 1;">' +
                    '<h5 style="margin: 0 0 3px 0; color: #1a1a1a; font-size: 14px; font-weight: bold;">' + sauce.name + '</h5>' +
                    '<p style="margin: 0 0 3px 0; color: #666; font-size: 12px; line-height: 1.2;">' + sauce.description + '</p>' +
                    '<div style="display: flex; align-items: center; gap: 6px;">' +
                      '<span style="font-size: 10px; color: ' + heatColor + '; font-weight: bold;">' + heatEmoji + ' ' + heatDisplay + '</span>' +
                    '</div>' +
                  '</div>' +
                  '<div style="width: 20px; height: 20px; border: 2px solid ' + (isSelected ? '#ff6b35' : '#ddd') + '; border-radius: 50%; background: ' + (isSelected ? '#ff6b35' : 'white') + '; display: flex; align-items: center; justify-content: center;">' +
                    (isSelected ? '<span style="color: white; font-size: 12px; font-weight: bold;">✓</span>' : '') +
                  '</div>' +
                '</div>' +
                // Add "on the side" toggle for signature sauces only (not dry rubs) - ALWAYS VISIBLE
                (!isDryRub ?
                  '<div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #eee; opacity: ' + (isSelected ? '1' : '0.6') + ';">' +
                    '<label class="on-side-toggle-container" style="display: flex; align-items: center; justify-content: space-between; font-size: 12px; color: #666; cursor: ' + (isSelected ? 'pointer' : 'not-allowed') + ';" onclick="' + (isSelected ? 'event.stopPropagation();' : 'event.stopPropagation(); alert(\'Please select this sauce first to enable \"On the Side\" option\');') + '">' +
                      '<span class="toggle-label" style="font-size: 11px; color: ' + (isSelected ? '#888' : '#bbb') + '; font-weight: ' + (isSelected ? 'normal' : 'bold') + ';">🥄 On the Side (1.5oz)</span>' +
                      '<div style="display: flex; align-items: center; gap: 8px;">' +
                        '<input type="checkbox" class="on-side-toggle" ' + (isOnSide && isSelected ? 'checked' : '') + ' ' + (isSelected ? '' : 'disabled') + ' onchange="' + (isSelected ? 'toggleOnSide(\'' + sauce.id + '\', this.checked)' : '') + '" style="display: none;">' +
                        '<span class="toggle-slider" style="position: relative; display: inline-block; width: 30px; height: 16px; background-color: ' + (isOnSide && isSelected ? '#ff6b35' : isSelected ? '#ccc' : '#eee') + '; border-radius: 16px; transition: 0.3s; cursor: ' + (isSelected ? 'pointer' : 'not-allowed') + '; border: ' + (isSelected ? 'none' : '1px solid #ddd') + ';" onclick="' + (isSelected ? 'this.previousElementSibling.click();' : 'alert(\'Please select this sauce first to enable \"On the Side\" option\');') + '">' +
                          '<span style="position: absolute; content: \'\'; height: 12px; width: 12px; left: ' + (isOnSide && isSelected ? '16px' : '2px') + '; bottom: 2px; background-color: ' + (isSelected ? 'white' : '#f5f5f5') + '; transition: 0.3s; border-radius: 50%; border: ' + (isSelected ? 'none' : '1px solid #ddd') + ';"></span>' +
                        '</span>' +
                      '</div>' +
                    '</label>' +
                  '</div>'
                  : '') +
                // Wing allocation controls for 12+ wing orders with multiple sauces
                (isSelected && selectedWingVariant && selectedWingVariant.count >= 12 && selectedSauces.length > 1 ?
                  '<div style="margin-top: 6px; padding-top: 6px; border-top: 1px solid #eee;">' +
                    '<div style="display: flex; align-items: center; justify-content: space-between; font-size: 11px; color: #888;">' +
                      '<span>Wing count:</span>' +
                      '<div style="display: flex; align-items: center; gap: 8px;">' +
                        '<button onclick="event.stopPropagation(); adjustWingAllocation(\'' + sauce.id + '\', -1);" style="width: 20px; height: 20px; border: 1px solid #ddd; background: white; border-radius: 3px; font-size: 12px; color: #666; cursor: pointer;">-</button>' +
                        '<span style="min-width: 20px; text-align: center; font-weight: bold;">' + ((wingAllocation[sauce.id] != null ? wingAllocation[sauce.id] : (Math.floor((selectedWingVariant.count/6) / selectedSauces.length) * 6))) + '</span>' +
                        '<button onclick="event.stopPropagation(); adjustWingAllocation(\'' + sauce.id + '\', 1);" style="width: 20px; height: 20px; border: 1px solid #ddd; background: white; border-radius: 3px; font-size: 12px; color: #666; cursor: pointer;">+</button>' +
                      '</div>' +
                    '</div>' +
                  '</div>'
                  : '') +
              '</div>';
            }).join('') +
          '</div>' +
        '</div>';
    }

    // Sauce selection handler
    window.toggleSauceSelection = function(sauceId) {
      const maxSauces = selectedWingVariant ? selectedWingVariant.includedSauces : 1;

      if (selectedSauces.includes(sauceId)) {
        // Remove sauce
        selectedSauces = selectedSauces.filter(id => id !== sauceId);
        delete saucePreferences[sauceId];
        delete wingAllocation[sauceId];
      } else if (selectedSauces.length < maxSauces) {
        // Add sauce
        selectedSauces.push(sauceId);
        noSauceSelected = false;

        // Initialize sauce preferences
        if (!saucePreferences[sauceId]) {
          saucePreferences[sauceId] = { selected: true, onSide: false };
        } else {
          saucePreferences[sauceId].selected = true;
        }

        // For 12+ wings with multiple sauces, initialize allocation
        if (selectedWingVariant && selectedWingVariant.count >= 12 && selectedSauces.length > 1) {
          // Redistribute wings evenly in 6-wing units
          equalSplitWings();
        }
      } else {
        alert('Maximum ' + maxSauces + ' sauce' + (maxSauces > 1 ? 's' : '') + ' allowed');
        return;
      }

      // Re-render sauce selection with delay to ensure state updates
      setTimeout(() => {
        populateSauceSelection();
        updateWingAllocationFeedback();
        updateModalButtons();
      }, 100);
    };

    // Handle "on the side" toggle for sauces (Step 2 enhancement)
    window.toggleOnSide = function(sauceId, isOnSide) {
      // Ensure sauce preferences object exists
      if (!saucePreferences[sauceId]) {
        saucePreferences[sauceId] = { selected: false, onSide: false };
      }

      // Update the preference
      saucePreferences[sauceId].onSide = isOnSide;

      // Log for debugging
      console.log('Toggled sauce preference:', {
        sauceId: sauceId,
        onSide: isOnSide,
        allPreferences: saucePreferences
      });

      // Re-render the sauce selection to update the toggle slider display
      populateSauceSelection();
    };

    // No Sauce toggle: clear sauces and jump to Dips
    window.toggleNoSauce = function() {
      noSauceSelected = !noSauceSelected;
      if (noSauceSelected) {
        selectedSauces = [];
        saucePreferences = {};
        wingAllocation = {};

        // Jump to Dips (Step 3)
        currentModalStep = 3;
        updateModalDisplay();
        loadStepContent();
        updateModalButtons();
      } else {
        // Return to sauces selection state
        currentModalStep = 2;
        updateModalDisplay();
        loadStepContent();
        updateModalButtons();
      }
    };

    // Handle wing allocation adjustments for 12+ wing orders
    window.adjustWingAllocation = function(sauceId, change) {
      if (!selectedWingVariant || selectedWingVariant.count < 12 || selectedSauces.length <= 1) return;

      const step = 6;
      const totalWings = selectedWingVariant.count;
      const currentAllocation = wingAllocation[sauceId] || step;
      const newAllocation = Math.max(step, currentAllocation + (change > 0 ? step : -step));

      // Calculate total allocated wings excluding this sauce
      const otherAllocations = selectedSauces
        .filter(sid => sid !== sauceId)
        .reduce((sum, sid) => sum + (wingAllocation[sid] || 0), 0);

      // Don't allow allocation that exceeds total wings
      if (otherAllocations + newAllocation > totalWings) {
        alert('Cannot allocate more than ' + totalWings + ' total wings');
        return;
      }

      wingAllocation[sauceId] = newAllocation;

      // Re-render sauce selection to show updated allocation
      populateSauceSelection();
      updateWingAllocationFeedback();
    };

    function populateIncludedDipSelection() {
      // Use real Firestore dipping sauce data
      const allSauces = strategicMenu.sauces || firestoreSauces || [];
      const includedDips = [
        // Add "No Dip" option first
        { id: 'no-dip', name: 'No Dip', description: 'Skip dips entirely' },
        // Add real Firestore dipping sauces
        ...allSauces.filter(s => s.category === 'dipping-sauce')
      ];

      const maxDips = selectedWingVariant ? Math.floor(selectedWingVariant.count / 6) : 1;
      const container = document.getElementById('includedDipOptions');
      if (!container) return;

      // Check if "No Dip" is selected to adjust UI
      const noDipSelected = selectedIncludedDips['no-dip'] > 0;
      const totalDipsSelected = Object.values(selectedIncludedDips).reduce((sum, q) => sum + q, 0);

      container.innerHTML =
        '<div style="margin-bottom: 20px; text-align: center; color: #666; font-size: 14px;">' +
          (noDipSelected ? 'No dips selected' : 'Select up to ' + maxDips + ' dip' + (maxDips > 1 ? 's' : '') + ' (included in price)') +
        '</div>' +
        '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">' +
          includedDips.map(dip => {
            const isSelected = selectedIncludedDips[dip.id] > 0;
            const quantity = selectedIncludedDips[dip.id] || 0;
            const isNoDip = dip.id === 'no-dip';

            return '<div class="dip-option ' + (isSelected ? 'selected' : '') + '" style="border: 2px solid ' + (isSelected ? '#ff6b35' : '#e0e0e0') + '; border-radius: 12px; padding: 16px; text-align: center; cursor: pointer; background: ' + (isSelected ? '#fff5f2' : 'white') + '; transition: all 0.3s ease; opacity: ' + (isNoDip || !noDipSelected ? '1' : '0.5') + ';">' +
              '<h4 style="margin: 0 0 8px 0; color: #1a1a1a; font-size: 16px;">' + dip.name + '</h4>' +
              '<p style="margin: 0 0 12px 0; color: #666; font-size: 13px; line-height: 1.3;">' + dip.description + '</p>' +
              (isNoDip ?
                '<button onclick="toggleNoDip()" style="width: 100%; padding: 8px; border: 1px solid ' + (isSelected ? '#ff6b35' : '#ddd') + '; background: ' + (isSelected ? '#ff6b35' : 'white') + '; color: ' + (isSelected ? 'white' : '#666') + '; border-radius: 6px; font-size: 14px; cursor: pointer;">' +
                  (isSelected ? '✓ Selected' : 'Select') +
                '</button>'
                :
                '<div style="display: flex; align-items: center; justify-content: center; gap: 12px; ' + (noDipSelected ? 'opacity: 0.3; pointer-events: none;' : '') + '">' +
                  '<button onclick="adjustIncludedDipQuantity(\'' + dip.id + '\', -1)" style="width: 30px; height: 30px; border: 1px solid #ddd; background: white; border-radius: 6px; font-size: 16px; color: #666; cursor: pointer;">-</button>' +
                  '<span style="min-width: 30px; text-align: center; font-weight: bold; font-size: 16px;">' + quantity + '</span>' +
                  '<button onclick="adjustIncludedDipQuantity(\'' + dip.id + '\', 1)" style="width: 30px; height: 30px; border: 1px solid #ddd; background: white; border-radius: 6px; font-size: 16px; color: #666; cursor: pointer;">+</button>' +
                '</div>'
              ) +
            '</div>';
          }).join('') +
        '</div>';
    }

    function populateWingStyleSelection() {
      if (currentWingType === 'boneless') return; // Skip for boneless wings

      const container = document.getElementById('wingStyleOptions');
      if (!container) return;

      container.innerHTML =
        '<div style="margin-bottom: 20px; text-align: center; color: #666; font-size: 14px;">Choose your wing style preference</div>' +
        '<div class="wing-style-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">' +
          '<div class="wing-variant-option ' + (selectedWingStyle === 'regular' ? 'selected' : '') + '" onclick="selectWingStyle(\'regular\')" style="border: 2px solid ' + (selectedWingStyle === 'regular' ? '#ff6b35' : '#e0e0e0') + '; border-radius: 12px; padding: 20px; text-align: center; cursor: pointer; background: ' + (selectedWingStyle === 'regular' ? '#fff5f2' : 'white') + '; transition: all 0.3s ease;">' +
            '<div class="wing-variant-info">' +
              '<h4 style="margin: 0 0 8px 0; color: #1a1a1a; font-size: 18px;">Regular Mix</h4>' +
              '<p style="margin: 0 0 8px 0; color: #666; font-size: 14px;">Mixed flats and drumsticks</p>' +
              '<div class="wing-variant-price" style="color: #00b887; font-weight: bold;">Included</div>' +
            '</div>' +
          '</div>' +
          '<div class="wing-variant-option ' + (selectedWingStyle === 'all-drums' ? 'selected' : '') + '" onclick="selectWingStyle(\'all-drums\')" style="border: 2px solid ' + (selectedWingStyle === 'all-drums' ? '#ff6b35' : '#e0e0e0') + '; border-radius: 12px; padding: 20px; text-align: center; cursor: pointer; background: ' + (selectedWingStyle === 'all-drums' ? '#fff5f2' : 'white') + '; transition: all 0.3s ease;">' +
            '<div class="wing-variant-info">' +
              '<h4 style="margin: 0 0 8px 0; color: #1a1a1a; font-size: 18px;">All Drums</h4>' +
              '<p style="margin: 0 0 8px 0; color: #666; font-size: 14px;">All drumstick pieces</p>' +
              '<div class="wing-variant-price" style="color: #ff6b35; font-weight: bold;">+$1.50</div>' +
            '</div>' +
          '</div>' +
          '<div class="wing-variant-option ' + (selectedWingStyle === 'all-flats' ? 'selected' : '') + '" onclick="selectWingStyle(\'all-flats\')" style="border: 2px solid ' + (selectedWingStyle === 'all-flats' ? '#ff6b35' : '#e0e0e0') + '; border-radius: 12px; padding: 20px; text-align: center; cursor: pointer; background: ' + (selectedWingStyle === 'all-flats' ? '#fff5f2' : 'white') + '; transition: all 0.3s ease;">' +
            '<div class="wing-variant-info">' +
              '<h4 style="margin: 0 0 8px 0; color: #1a1a1a; font-size: 18px;">All Flats</h4>' +
              '<p style="margin: 0 0 8px 0; color: #666; font-size: 14px;">All flat wing pieces</p>' +
              '<div class="wing-variant-price" style="color: #ff6b35; font-weight: bold;">+$1.50</div>' +
            '</div>' +
          '</div>' +
        '</div>';
    }

    window.selectWingStyle = function(style) {
      selectedWingStyle = style;
      populateWingStyleSelection();
    };

    function populateExtraDipSelection() {
      // Prefer container within the active step to avoid writing into hidden steps
      const activeStep = document.querySelector('.modal-step.active');
      let container = null;
      if (activeStep) {
        container = activeStep.querySelector('#extraDipOptions') || activeStep.querySelector('#wingStyleOptions');
      }
      // Fallback for safety (should rarely be needed)
      if (!container) {
        container = document.getElementById('extraDipOptions') || document.getElementById('wingStyleOptions');
      }
      if (!container) return;
      container.style.display = 'block';

      // Build extra dips from Firestore dipping sauces if available; otherwise fallback list
      const allSauces = (typeof strategicMenu !== 'undefined' && strategicMenu.sauces) ? strategicMenu.sauces : (typeof firestoreSauces !== 'undefined' ? firestoreSauces : []);
      const dipsFromFirestore = (allSauces || []).filter(function(s){ return s.category === 'dipping-sauce'; }).map(function(s){
        return { id: s.id, name: s.name || s.id, price: 0.75 };
      });
      const extraDips = dipsFromFirestore.length ? dipsFromFirestore : [
        { id: 'extra_ranch', name: 'Extra Ranch', price: 0.75 },
        { id: 'extra_blue_cheese', name: 'Extra Blue Cheese', price: 0.75 },
        { id: 'extra_honey_mustard', name: 'Extra Honey Mustard', price: 0.75 },
        { id: 'extra_cheese_sauce', name: 'Extra Cheese Sauce', price: 0.75 }
      ];

      const noExtraBtn = '<button onclick="skipExtraDips()" style="margin:0 0 12px 0; padding:8px 12px; border:1px solid #ddd; background:white; color:#444; border-radius:6px; font-size:12px;">No Extra Dips</button>';

      container.innerHTML =
        '<div style="margin-bottom: 12px; text-align: center; color: #666; font-size: 14px;">Add extra dips ($0.75 each)</div>' +
        '<div style="display:flex; justify-content:center;">' + noExtraBtn + '</div>' +
        '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">' +
          extraDips.map(function(dip){
            const quantity = selectedExtraDips[dip.id] || 0;
            const isSelected = quantity > 0;
            return (
              '<div class="extra-dip-option ' + (isSelected ? 'selected' : '') + '" style="border: 2px solid ' + (isSelected ? '#ff6b35' : '#e0e0e0') + '; border-radius: 12px; padding: 16px; text-align: center; cursor: pointer; background: ' + (isSelected ? '#fff5f2' : 'white') + '; transition: all 0.3s ease;">' +
                '<h4 style="margin: 0 0 8px 0; color: #1a1a1a; font-size: 16px;">' + dip.name + '</h4>' +
                '<p style="margin: 0 0 12px 0; color: #666; font-size: 13px;">$' + dip.price.toFixed(2) + ' each</p>' +
                '<div style="display: flex; align-items: center; justify-content: center; gap: 12px;">' +
                  '<button onclick="adjustExtraDipQuantity(\'' + dip.id + '\', -1)" style="width: 30px; height: 30px; border: 1px solid #ddd; background: white; border-radius: 6px; font-size: 16px; color: #666; cursor: pointer;">-</button>' +
                  '<span style="min-width: 30px; text-align: center; font-weight: bold; font-size: 16px;">' + quantity + '</span>' +
                  '<button onclick="adjustExtraDipQuantity(\'' + dip.id + '\', 1)" style="width: 30px; height: 30px; border: 1px solid #ddd; background: white; border-radius: 6px; font-size: 16px; color: #666; cursor: pointer;">+</button>' +
                '</div>' +
              '</div>'
            );
          }).join('') +
        '</div>';
    }

    window.adjustExtraDipQuantity = function(dipId, change) {
      const currentQuantity = selectedExtraDips[dipId] || 0;
      const newQuantity = Math.max(0, currentQuantity + change);

      if (newQuantity === 0) {
        delete selectedExtraDips[dipId];
      } else {
        selectedExtraDips[dipId] = newQuantity;
      }

      populateExtraDipSelection();
    };

    // Skip extra dips: clear and advance to next appropriate step
    window.skipExtraDips = function() {
      selectedExtraDips = {};
      const finalStep = (currentWingType === 'bone-in') ? 6 : 5;
      currentModalStep = finalStep;
      updateModalDisplay();
      loadStepContent();
      updateModalButtons();
    };

    function updateWingAllocationFeedback() {
      const container = document.getElementById('sauceOptions');
      if (!container || !selectedWingVariant) return;
      if (!(selectedWingVariant.count >= 12 && selectedSauces.length > 1)) return;

      const total = selectedWingVariant.count;
      const allocated = selectedSauces.reduce((s, sid) => s + (wingAllocation[sid] || 0), 0);
      const remaining = Math.max(0, total - allocated);

      // Find the helper bar we injected just before the sauce grids
      const helper = container.querySelector('[data-allocation-helper]');
      // No-op if not present (rendered above inline already)
    }

    // Equal split helper – divides wings into 6-wing units across selected sauces
    window.equalSplitWings = function() {
      if (!selectedWingVariant || selectedWingVariant.count < 12 || selectedSauces.length <= 1) return;
      const step = 6;
      const total = selectedWingVariant.count;
      const units = Math.floor(total / step);
      const baseUnits = Math.floor(units / selectedSauces.length);
      let remainder = units - (baseUnits * selectedSauces.length);
      selectedSauces.forEach(sid => {
        const allocUnits = baseUnits + (remainder > 0 ? 1 : 0);
        if (remainder > 0) remainder--;
        wingAllocation[sid] = Math.max(step, allocUnits * step);
      });
      populateSauceSelection();
      updateWingAllocationFeedback();
      updateModalButtons();
    };

    // Clear allocations helper
    window.clearWingAllocations = function() {
      wingAllocation = {};
      populateSauceSelection();
      updateWingAllocationFeedback();
      updateModalButtons();
    };

    // buildWingOrderPayload and addWingOrderToCart are provided by shared orchestrators

    // Handle included dip quantity adjustments
    window.adjustIncludedDipQuantity = function(dipId, change) {
      const maxDips = selectedWingVariant ? Math.floor(selectedWingVariant.count / 6) : 1;
      const totalDipsSelected = Object.values(selectedIncludedDips).reduce((sum, q) => sum + q, 0);

      // Skip if "No Dip" is selected
      if (selectedIncludedDips['no-dip'] > 0) return;

      if (change > 0) {
        // Adding a dip
        if (totalDipsSelected >= maxDips) {
          alert('Maximum ' + maxDips + ' dip' + (maxDips > 1 ? 's' : '') + ' allowed');
          return;
        }
        selectedIncludedDips[dipId] = (selectedIncludedDips[dipId] || 0) + 1;
      } else {
        // Removing a dip
        const currentQuantity = selectedIncludedDips[dipId] || 0;
        const newQuantity = Math.max(0, currentQuantity + change);

        if (newQuantity === 0) {
          delete selectedIncludedDips[dipId];
        } else {
          selectedIncludedDips[dipId] = newQuantity;
        }
      }

      populateIncludedDipSelection();
    };

    // New toggle function for "No Dip" option
    window.toggleNoDip = function() {
      const currentlySelected = selectedIncludedDips['no-dip'] > 0;

      if (currentlySelected) {
        // Unselect "No Dip"
        delete selectedIncludedDips['no-dip'];
      } else {
        // Select "No Dip" and clear all other dips
        selectedIncludedDips = { 'no-dip': 1 };
      }

      // Refresh the display
      populateIncludedDipSelection();
    };

    // Utility function to generate wing variants from menu data
    function generateWingVariants(wingType) {
      // Use real Firestore wings data with proper platform pricing
      if (strategicMenu && strategicMenu.wings && strategicMenu.wings.variants && strategicMenu.wings.variants.length > 0) {
        return strategicMenu.wings.variants
          .filter(variant => {
            const isBoneless = variant.type === 'boneless' || variant.id?.includes('boneless');
            return wingType === 'boneless' ? isBoneless : !isBoneless;
          })
          .map(variant => ({
            id: variant.id,
            name: variant.name || (variant.count + ' Wings (' + (wingType === 'boneless' ? 'Boneless' : 'Bone-In') + ')'),
            count: variant.count,
            platformPrice: variant.platformPrice || variant.basePrice,
            basePrice: variant.basePrice,
            includedSauces: Math.max(1, Math.floor(variant.count / 6)), // 1 sauce per 6 wings
            description: variant.description || (variant.count + ' fresh ' + (wingType === 'boneless' ? 'boneless' : 'bone-in') + ' wings')
          }))
          .sort((a, b) => a.count - b.count); // Sort by wing count
      }

      // Fallback to correct default variants with proper DoorDash pricing
      console.warn('No Firestore wings data available, using corrected fallback variants for', wingType);
      if (wingType === 'boneless') {
        return [
          { id: 'wings_6_boneless', name: '6 Wings (Boneless)', count: 6, platformPrice: 9.44, includedSauces: 1, description: '6 fresh boneless wings' },
          { id: 'wings_12_boneless', name: '12 Wings (Boneless)', count: 12, platformPrice: 16.19, includedSauces: 2, description: '12 fresh boneless wings' },
          { id: 'wings_24_boneless', name: '24 Wings (Boneless)', count: 24, platformPrice: 28.34, includedSauces: 4, description: '24 fresh boneless wings' },
          { id: 'wings_30_boneless', name: '30 Wings (Boneless)', count: 30, platformPrice: 35.09, includedSauces: 5, description: '30 fresh boneless wings' },
          { id: 'wings_50_boneless', name: '50 Wings (Boneless)', count: 50, platformPrice: 53.99, includedSauces: 8, description: '50 fresh boneless wings' }
        ];
      } else {
        return [
          { id: 'wings_6_bonein', name: '6 Wings (Bone-In)', count: 6, platformPrice: 12.14, includedSauces: 1, description: '6 fresh bone-in wings' },
          { id: 'wings_12_bonein', name: '12 Wings (Bone-In)', count: 12, platformPrice: 20.24, includedSauces: 2, description: '12 fresh bone-in wings' },
          { id: 'wings_24_bonein', name: '24 Wings (Bone-In)', count: 24, platformPrice: 35.09, includedSauces: 4, description: '24 fresh bone-in wings' },
          { id: 'wings_30_bonein', name: '30 Wings (Bone-In)', count: 30, platformPrice: 44.54, includedSauces: 5, description: '30 fresh bone-in wings' },
          { id: 'wings_50_bonein', name: '50 Wings (Bone-In)', count: 50, platformPrice: 67.49, includedSauces: 8, description: '50 fresh bone-in wings' }
        ];
      }
      if (addBtn) {
        addBtn.style.display = isLastStep ? 'block' : 'none';
        addBtn.disabled = !isLastStep;
      }
    }

    console.log('🚀 Wings Modal module loaded successfully');
  

    // ==============================================
    // WINGS FLOW ORCHESTRATORS (Boneless / Bone-In)
    // ==============================================
    
    // ==============================================
    // WINGS ORCHESTRATOR — BONELESS (SCAFFOLD)
    // ==============================================
    (function(){
      function setActiveStep(n){
        try{
          document.querySelectorAll('.modal-step').forEach((el,i)=>{
            el.classList.toggle('active', (i+1)===n);
          });
          document.querySelectorAll('.progress-step').forEach(el=>{
            const idx = Number(el.getAttribute('data-step'));
            el.classList.toggle('active', idx===n);
          });
        }catch(e){ console.warn('setActiveStep failed', e); }
      }

      window.launchBonelessOrchestrator = function(){
        try {
          window.currentWingType = 'boneless';
          if (typeof window.ensureWingGlobals === 'function') window.ensureWingGlobals();
          if (typeof window.openWingModal === 'function') window.openWingModal('boneless');

          // TODO (Claude): Implement 5-step flow using shared renderers
          // Step 1: Size — renderSizeOptions('#wingVariants', { onSelect: next })
          // Step 2: Sauces — renderSauceOptions('#sauceOptions', { onSelect, onToggleOnSide })
          // Step 3: Allocation (if multiple sauces and count>=12) — equalSplitBy6(), validateAllocationBy6()
          // Step 4: Extra Dips — renderExtraDips('#extraDipOptions')
          // Step 5: Summary — renderSummary('#orderSummary', { enableAddToCart: true })
          // Use setActiveStep(n) to control visible step, ensure summary only on final step.

          // Temporary UX: land on step 1 and let legacy Next buttons continue to work
          setActiveStep(1);
        } catch (e) {
          console.error('launchBonelessOrchestrator failed', e);
        }
      };
    })();
  

    
    // ==============================================
    // WINGS ORCHESTRATOR — BONE-IN (SCAFFOLD)
    // ==============================================
    (function(){
      function setActiveStep(n){
        try{
          document.querySelectorAll('.modal-step').forEach((el,i)=>{
            el.classList.toggle('active', (i+1)===n);
          });
          document.querySelectorAll('.progress-step').forEach(el=>{
            const idx = Number(el.getAttribute('data-step'));
            el.classList.toggle('active', idx===n);
          });
        }catch(e){ console.warn('setActiveStep failed', e); }
      }

      window.launchBoneInOrchestrator = function(){
        try {
          window.currentWingType = 'bone-in';
          if (typeof window.ensureWingGlobals === 'function') window.ensureWingGlobals();
          if (typeof window.openWingModal === 'function') window.openWingModal('bone-in');

          // TODO (Claude): Implement 6-step flow using shared renderers
          // Step 1: Size — renderSizeOptions('#wingVariants')
          // Step 2: Wing Style — populate '#wingStyleOptions' and set selectedWingStyle; calcTotals handles $1.50 upcharge when style!=regular
          // Step 3: Sauces — renderSauceOptions('#sauceOptions') with on-the-side toggle
          // Step 4: Allocation (if multiple sauces and count>=12) — equalSplitBy6(), validateAllocationBy6()
          // Step 5: Extra Dips — renderExtraDips('#extraDipOptions')
          // Step 6: Summary — renderSummary('#orderSummary', { enableAddToCart: true })
          // Use setActiveStep(n) to control visible step, ensure summary only on final step.

          // Temporary UX: land on step 1
          setActiveStep(1);
        } catch (e) {
          console.error('launchBoneInOrchestrator failed', e);
        }
      };
    })();
  

    
    // ==============================================
    // FLOW ENTRY POINTS - PHASE 2 ORCHESTRATORS
    // ==============================================
    window.openBonelessWingModal = function(wingsData) {
      // Use new boneless orchestrator if available, fallback to legacy
      if (typeof window.openBonelessWingModal_v2 === 'function') {
        window.openBonelessWingModal_v2(wingsData);
      } else if (typeof window.openWingModal === 'function') {
        window.openWingModal('boneless', wingsData);
      } else {
        console.warn('No boneless wing modal implementation available');
      }
    };

    window.openBoneInWingModal = function(wingsData) {
      // Use new bone-in orchestrator if available, fallback to legacy
      if (typeof window.openBoneInWingModal_v2 === 'function') {
        window.openBoneInWingModal_v2(wingsData);
      } else if (typeof window.openWingModal === 'function') {
        window.openWingModal('bone-in', wingsData);
      } else {
        console.warn('No bone-in wing modal implementation available');
      }
    };

    // ==============================================
    // SHARED STATE UTILS
    // ==============================================
    window.ensureWingGlobals = function() {
      window.selectedSauces = window.selectedSauces || [];
      window.wingAllocation = window.wingAllocation || {}; // { sauceId: qty }
      window.saucePreferences = window.saucePreferences || {}; // { sauceId: { onSide: boolean } }
      window.selectedIncludedDips = window.selectedIncludedDips || {}; // { dipId: qty }
      window.selectedExtraDips = window.selectedExtraDips || {}; // { dipId: qty }
    };

    // Get DOM container by id or element
    window.getContainerEl = function(container) {
      if (!container) return null;
      if (typeof container === 'string') return document.getElementById(container) || document.querySelector(container);
      return container;
    }

    // ==============================================
    // SHARED HELPERS (Phase 2)
    // ==============================================
    window.formatDipName = function(id) {
      const allSauces = (window.strategicMenu && strategicMenu.sauces) || window.firestoreSauces || [];
      const dip = (allSauces || []).find(s => s.id === id);
      if (dip && dip.name) return dip.name;
      return String(id || '').replace(/[-_]/g, ' ').replace(/w/g, c => c.toUpperCase());
    };

    // Calculate totals from current state (or overrides)
    window.calcTotals = function(opts = {}) {
      const variant = opts.variant || window.selectedWingVariant || null;
      const base = variant ? (variant.platformPrice || variant.basePrice || 0) : 0;
      const type = (opts.type || window.currentWingType || 'boneless');
      const style = (type === 'bone-in') ? (opts.wingStyle || window.selectedWingStyle || 'regular') : 'n/a';
      const styleUpcharge = (type === 'bone-in' && style !== 'regular') ? 1.50 : 0;
      const extraDipsTotal = Object.values(opts.extraDips || window.selectedExtraDips || {}).reduce((s, q) => s + (q * 0.75), 0);
      return {
        base,
        wingStyleUpcharge: styleUpcharge,
        extraDips: extraDipsTotal,
        total: base + styleUpcharge + extraDipsTotal
      };
    };

    // Allocation helpers for 6-wing units
    window.equalSplitBy6 = function(sauceIds) {
      window.ensureWingGlobals();
      const ids = Array.isArray(sauceIds) ? sauceIds : (window.selectedSauces || []);
      if (!window.selectedWingVariant || !window.selectedWingVariant.count || !ids.length) return;
      const total = window.selectedWingVariant.count;
      const units = Math.floor(total / 6);
      if (units <= 0) return;
      const per = Math.floor(units / ids.length);
      const remainder = units - (per * ids.length);
      const allocation = {};
      ids.forEach((id, idx) => {
        const extra = idx < remainder ? 1 : 0;
        allocation[id] = (per + extra) * 6;
      });
      window.wingAllocation = allocation;
    };

    window.validateAllocationBy6 = function() {
      window.ensureWingGlobals();
      const errs = [];
      const variant = window.selectedWingVariant;
      if (!variant || !variant.count) return { valid: true, errors: [] };
      const total = variant.count;
      const sum = Object.values(window.wingAllocation || {}).reduce((s, n) => s + (Number(n) || 0), 0);
      if (sum !== total) errs.push('Allocation total does not match wing count');
      for (const [id, qty] of Object.entries(window.wingAllocation || {})) {
        if ((Number(qty) || 0) % 6 !== 0) errs.push('Allocation for ' + id + ' must be in multiples of 6');
      }
      return { valid: errs.length === 0, errors: errs };
    };

    // Sauce on-the-side preference toggle
    window.toggleSauceOnSide = function(sauceId, value) {
      window.ensureWingGlobals();
      if (!sauceId) return;
      window.saucePreferences[sauceId] = window.saucePreferences[sauceId] || {};
      window.saucePreferences[sauceId].onSide = (typeof value === 'boolean') ? value : !window.saucePreferences[sauceId].onSide;
    };

    // Summary gating utility (orchestrators can decide when to render)
    window.shouldShowSummary = function(stepIndex, totalSteps) {
      return Number(stepIndex) === Number(totalSteps);
    };

    // Build payload from current modal state (relies on shared global vars declared by wings modal)
    window.buildWingOrderPayload = function() {
      try {
        const saucesList = (window.selectedSauces || []).map(id => {
          const sauce = ((window.strategicMenu && strategicMenu.sauces) || window.firestoreSauces || []).find(s => s.id === id) || { id };
          const allocation = (window.selectedWingVariant && selectedSauces.length > 1)
            ? (window.wingAllocation ? (wingAllocation[id] || 0) : 0)
            : (window.selectedWingVariant ? selectedWingVariant.count : 0);
          return { id, name: sauce.name || id, onSide: !!(window.saucePreferences && saucePreferences[id] && saucePreferences[id].onSide), allocation };
        });

        const included = Object.entries(window.selectedIncludedDips || {})
          .filter(([id, qty]) => id !== 'no-dip' && qty > 0)
          .map(([id, qty]) => ({ id, name: window.formatDipName(id), qty }));

        const extras = Object.entries(window.selectedExtraDips || {})
          .map(([id, qty]) => ({ id, name: window.formatDipName(id), qty, unitPrice: 0.75 }));

        const base = window.selectedWingVariant ? (selectedWingVariant.platformPrice || selectedWingVariant.basePrice || 0) : 0;
        const styleUpcharge = (window.currentWingType === 'bone-in' && window.selectedWingStyle !== 'regular') ? 1.50 : 0;
        const extraDipsTotal = Object.values(window.selectedExtraDips || {}).reduce((s, q) => s + q * 0.75, 0);

        return {
          type: window.currentWingType || 'boneless',
          variant: window.selectedWingVariant ? {
            id: selectedWingVariant.id,
            name: selectedWingVariant.name,
            count: selectedWingVariant.count,
            basePrice: selectedWingVariant.basePrice,
            platformPrice: selectedWingVariant.platformPrice
          } : null,
          wingStyle: window.currentWingType === 'bone-in' ? (window.selectedWingStyle || 'regular') : 'n/a',
          sauces: saucesList,
          includedDips: included,
          extraDips: extras,
          totals: { base, wingStyleUpcharge: styleUpcharge, extraDips: extraDipsTotal, total: base + styleUpcharge + extraDipsTotal },
          timestamp: new Date().toISOString()
        };
      } catch (e) {
        console.error('buildWingOrderPayload failed', e);
        return null;
      }
    };

    window.addWingOrderToCart = function() {
      const payload = window.buildWingOrderPayload();
      if (payload) {
        console.log('🧾 Wing order payload:', payload);
        // TODO: Replace with real cart integration
      }
      if (typeof window.closeWingModal === 'function') window.closeWingModal();
    };

    // ==============================================
    // SHARED RENDERERS (Phase 2)
    // Note: These renderers are not auto-wired into the legacy modal.
    // Orchestrators should call them and manage step transitions.
    // ==============================================

    // Render size/variant options
    window.renderSizeOptions = function(container, opts = {}) {
      window.ensureWingGlobals();
      const el = window.getContainerEl(container);
      if (!el) return;
      const variants = (opts.variants) || ((window.strategicMenu && strategicMenu.wings && strategicMenu.wings.variants) ? strategicMenu.wings.variants : []);
      if (!Array.isArray(variants)) { el.innerHTML = '<p>No wing sizes available.</p>'; return; }
      el.innerHTML = variants.map(v => {
        const price = (v.platformPrice != null ? v.platformPrice : v.basePrice) || 0;
        return '<button class="wing-size" data-id="' + v.id + '">' +
          '<div class="wing-size-name">' + (v.name || (v.count + ' Wings')) + '</div>' +
          '<div class="wing-size-meta">' + (v.count || '') + ' — $' + price.toFixed(2) + '</div>' +
          '</button>';
      }).join('');
      el.querySelectorAll('button.wing-size').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = btn.getAttribute('data-id');
          const v = variants.find(x => String(x.id) === String(id));
          if (v) {
            window.selectedWingVariant = v;
            // Reset allocations when size changes
            window.wingAllocation = {};
          }
          if (typeof opts.onSelect === 'function') opts.onSelect(v);
        });
      });
    };

    // Categorize sauces into two columns (dry rubs vs signature) with fallbacks
    window.renderSauceOptions = function(container, opts = {}) {
      window.ensureWingGlobals();
      const el = window.getContainerEl(container);
      if (!el) return;
      const sauces = (opts.sauces) || ((window.strategicMenu && strategicMenu.sauces) || window.firestoreSauces || []);
      const isDry = s => (s.category === 'dry-rub') || (s.type === 'dry') || /rub/i.test(s.name || '');
      const dry = sauces.filter(isDry);
      const wet = sauces.filter(s => !isDry(s));
      const card = function(s) {
        const heatIcons = (s.heat || 0) > 0 ? '🌶️'.repeat(Math.min(3, s.heat)) : '🚫🌶️';
        return (
          '<div class="sauce-card" data-id="' + s.id + '">' +
            '<div class="sauce-name">' + (s.name || s.id) + '</div>' +
            '<div class="sauce-heat">' + heatIcons + '</div>' +
            '<div class="sauce-actions">' +
              '<button class="sauce-pick">Select</button>' +
              '<label class="on-side"><input type="checkbox" class="sauce-on-side"> On the side</label>' +
            '</div>' +
          '</div>'
        );
      };
      el.innerHTML = (
        '<div class="sauce-columns">' +
          '<div class="col dry">' +
            '<h4>Dry Rubs</h4>' +
            dry.map(card).join('') +
          '</div>' +
          '<div class="col wet">' +
            '<h4>Signature Sauces</h4>' +
            wet.map(card).join('') +
          '</div>' +
        '</div>'
      );
      el.querySelectorAll('.sauce-card').forEach(node => {
        const id = node.getAttribute('data-id');
        node.querySelector('.sauce-pick')?.addEventListener('click', () => {
          if (!window.selectedSauces.includes(id)) window.selectedSauces.push(id);
          if (typeof opts.onSelect === 'function') opts.onSelect(id);
        });
        node.querySelector('.sauce-on-side')?.addEventListener('change', (e) => {
          window.toggleSauceOnSide(id, !!e.target.checked);
          if (typeof opts.onToggleOnSide === 'function') opts.onToggleOnSide(id, !!e.target.checked);
        });
      });
    };

    // Included dips selector (with "No Dip")
    window.renderIncludedDips = function(container, opts = {}) {
      window.ensureWingGlobals();
      const el = window.getContainerEl(container);
      if (!el) return;
      const dips = (opts.dips) || ((window.strategicMenu && strategicMenu.sauces) || window.firestoreSauces || []);
      const maxIncluded = Number(opts.maxIncluded || 1);
      const item = function(d) {
        return (
          '<div class="dip-row" data-id="' + d.id + '">' +
            '<span class="dip-name">' + (d.name || d.id) + '</span>' +
            '<div class="dip-qty">' +
              '<button class="dec">-</button>' +
              '<span class="qty">' + (window.selectedIncludedDips[d.id] || 0) + '</span>' +
              '<button class="inc">+</button>' +
            '</div>' +
          '</div>'
        );
      };
      el.innerHTML = (
        '<div class="dip-list">' +
          '<label class="no-dip"><input type="checkbox" id="no-dip-checkbox"> No Dip</label>' +
          dips.map(item).join('') +
        '</div>'
      );
      const total = () => Object.values(window.selectedIncludedDips).reduce((s, n) => s + (Number(n) || 0), 0);
      el.querySelector('#no-dip-checkbox')?.addEventListener('change', (e) => {
        if (e.target.checked) {
          window.selectedIncludedDips = { 'no-dip': 1 };
          el.querySelectorAll('.qty').forEach(q => q.textContent = '0');
        } else {
          delete window.selectedIncludedDips['no-dip'];
        }
        if (typeof opts.onChange === 'function') opts.onChange(window.selectedIncludedDips);
      });
      el.querySelectorAll('.dip-row').forEach(row => {
        const id = row.getAttribute('data-id');
        row.querySelector('.dec')?.addEventListener('click', () => {
          if (window.selectedIncludedDips['no-dip']) return; // locked
          const cur = Number(window.selectedIncludedDips[id] || 0);
          window.selectedIncludedDips[id] = Math.max(0, cur - 1);
          row.querySelector('.qty').textContent = String(window.selectedIncludedDips[id]);
          if (typeof opts.onChange === 'function') opts.onChange(window.selectedIncludedDips);
        });
        row.querySelector('.inc')?.addEventListener('click', () => {
          if (window.selectedIncludedDips['no-dip']) return; // locked
          if (total() >= maxIncluded) return;
          const cur = Number(window.selectedIncludedDips[id] || 0);
          window.selectedIncludedDips[id] = cur + 1;
          row.querySelector('.qty').textContent = String(window.selectedIncludedDips[id]);
          if (typeof opts.onChange === 'function') opts.onChange(window.selectedIncludedDips);
        });
      });
    };

    // Extra dips (priced, unlimited)
    window.renderExtraDips = function(container, opts = {}) {
      window.ensureWingGlobals();
      const el = window.getContainerEl(container);
      if (!el) return;
      const dips = (opts.dips) || ((window.strategicMenu && strategicMenu.sauces) || window.firestoreSauces || []);
      const price = Number(opts.unitPrice || 0.75);
      const item = function(d) {
        return (
          '<div class="dip-row" data-id="' + d.id + '">' +
            '<span class="dip-name">' + (d.name || d.id) + '</span>' +
            '<span class="dip-price">$' + price.toFixed(2) + '</span>' +
            '<div class="dip-qty">' +
              '<button class="dec">-</button>' +
              '<span class="qty">' + (window.selectedExtraDips[d.id] || 0) + '</span>' +
              '<button class="inc">+</button>' +
            '</div>' +
          '</div>'
        );
      };
      el.innerHTML = '<div class="dip-list">' + dips.map(item).join('') + '</div>';
      el.querySelectorAll('.dip-row').forEach(row => {
        const id = row.getAttribute('data-id');
        row.querySelector('.dec')?.addEventListener('click', () => {
          const cur = Number(window.selectedExtraDips[id] || 0);
          window.selectedExtraDips[id] = Math.max(0, cur - 1);
          row.querySelector('.qty').textContent = String(window.selectedExtraDips[id]);
          if (typeof opts.onChange === 'function') opts.onChange(window.selectedExtraDips);
        });
        row.querySelector('.inc')?.addEventListener('click', () => {
          const cur = Number(window.selectedExtraDips[id] || 0);
          window.selectedExtraDips[id] = cur + 1;
          row.querySelector('.qty').textContent = String(window.selectedExtraDips[id]);
          if (typeof opts.onChange === 'function') opts.onChange(window.selectedExtraDips);
        });
      });
    };

    // Order summary (read-only; orchestrators control when to enable Add-to-Cart)
    window.renderSummary = function(container, opts = {}) {
      window.ensureWingGlobals();
      const el = window.getContainerEl(container);
      if (!el) return;
      const payload = window.buildWingOrderPayload();
      if (!payload) { el.innerHTML = '<p>Nothing selected yet.</p>'; return; }
      const saucesHtml = (payload.sauces || []).map(function(s){
        const side = s.onSide ? ' (on the side)' : '';
        const alloc = s.allocation ? (' — ' + s.allocation) : '';
        return '<li>' + s.name + side + alloc + '</li>';
      }).join('');
      const includedHtml = (payload.includedDips || []).map(function(d){ return '<li>' + d.name + ' × ' + d.qty + '</li>'; }).join('');
      const extrasHtml = (payload.extraDips || []).map(function(d){ return '<li>' + d.name + ' × ' + d.qty + '</li>'; }).join('');
      const t = payload.totals || window.calcTotals();
      el.innerHTML = (
        '<div class="order-summary">' +
          '<div class="summary-line"><strong>Type:</strong> ' + payload.type + '</div>' +
          '<div class="summary-line"><strong>Variant:</strong> ' + (payload.variant ? payload.variant.name : 'n/a') + '</div>' +
          '<div class="summary-line"><strong>Wing Style:</strong> ' + payload.wingStyle + '</div>' +
          '<div class="summary-block"><strong>Sauces:</strong><ul>' + (saucesHtml || '<li>None</li>') + '</ul></div>' +
          '<div class="summary-block"><strong>Included Dips:</strong><ul>' + (includedHtml || '<li>None</li>') + '</ul></div>' +
          '<div class="summary-block"><strong>Extra Dips:</strong><ul>' + (extrasHtml || '<li>None</li>') + '</ul></div>' +
          '<div class="totals">' +
            '<div>Base: $' + ((t.base || 0).toFixed(2)) + '</div>' +
            (t.wingStyleUpcharge ? ('<div>Style Upcharge: $' + t.wingStyleUpcharge.toFixed(2) + '</div>') : '') +
            (t.extraDips ? ('<div>Extra Dips: $' + t.extraDips.toFixed(2) + '</div>') : '') +
            '<div class="total"><strong>Total: $' + ((t.total || 0).toFixed(2)) + '</strong></div>' +
          '</div>' +
          '<div class="actions">' +
            '<button id="add-to-cart" ' + (opts.enableAddToCart ? '' : 'disabled') + '>Add to Cart</button>' +
          '</div>' +
        '</div>'
      );
      const btn = el.querySelector('#add-to-cart');
      if (btn) btn.addEventListener('click', () => window.addWingOrderToCart());
    };
  

    // ==============================================
    // ENTRY POINT WRAPPERS (Override legacy to orchestrators)
    // ==============================================
    window.openBonelessWingModal = function() {
      if (typeof window.launchBonelessOrchestrator === 'function') {
        return window.launchBonelessOrchestrator();
      }
      if (typeof window.openWingModal === 'function') {
        return window.openWingModal('boneless');
      }
      console.warn('No boneless wing modal implementation available');
    };

    window.openBoneInWingModal = function() {
      if (typeof window.launchBoneInOrchestrator === 'function') {
        return window.launchBoneInOrchestrator();
      }
      if (typeof window.openWingModal === 'function') {
        return window.openWingModal('bone-in');
      }
      console.warn('No bone-in wing modal implementation available');
    };

    

    // ==============================================
    // INITIALIZATION
    // ==============================================
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DoorDash modular menu system initialized');
      console.log('Menu data loaded:', Object.keys(strategicMenu));
      console.log('Firestore sauces:', firestoreSauces.length);

      // Defensive: Bind click handlers for wing category buttons
      // Event wiring is now handled by explicit onclicks in HTML (openBonelessWingModal / openBoneInWingModal)
    });

    console.log('🚀 DoorDash modular JavaScript loaded successfully');
  </script>
</body>
</html>